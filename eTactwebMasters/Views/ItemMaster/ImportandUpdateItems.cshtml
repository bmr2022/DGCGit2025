@model eTactWeb.DOM.Models.ItemMasterModel

@{
    ViewData["Title"] = Model.Item_Code == 0 ? "Item Master" : "Update/Edit Item Master";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<style>
    #selecteditemtable tbody tr:hover td {
        background-color: #2E7D32;
        color: #fff; /* optional: makes text readable on cyan */
    }
</style>
<div class="rounded shadow-lg">
    <form enctype="multipart/form-data" autocomplete="off" class="form-horizontal">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="Act">
        <input type="hidden" asp-for="ImageURL">
        <input type="hidden" asp-for="Mode">
        <div class="card border-light bg-gradient rounded shadow-lg">
            <div class="card-header card-headerBG text-light justify-content-center bg-gradient">
                <h4>
                    @ViewData["Title"] - @Model.YearCode
                    <span class="d-flex float-end" style="margin-top:-2px;">
                        @*<a asp-action="Dashboard" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">
                        <i class="fa-solid fa-grip fa-fw fa-lg fa-beat" aria-hidden="true"></i>
                        Dashboard
                        </a>*@
                      
                        
                        <div class="row justify-content-between g-2">
                            <div class="col-auto">
                                @*<a href="#" class="btn offer-listbtn hvr-sweep-to-right btn-sm btn-secondary" onclick="back();">*@
                                <a href="#" class=" btn btn-primary btn-sm" onclick="back();">
                                    <i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>

                                    BACK
                                </a>
                            </div>
                            @if (Model.Mode != "V" && Model.Mode != "SOC" && Model.Mode != "POC")
                            {
                                <div class="col-auto">
                                    @*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
                                    <a class="btn btn-secondary btn-sm" onclick="window.location.reload()">
                                        @* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
                                        <i class="fa fa-refresh fa-fw fa-lg" aria-hidden="true"></i>
                                        REFRESH
                                    </a>
                                </div>

                                <div class="col-auto">
                                    @*   <button type="submit" class="btn btn-sm btn-outline-primary">*@
                                    <button class="btn btn-primary btn-sm BtnSubmit" id="BtnSubmit">
                                        <i class="fa-solid fa-chevron-circle-right fa-fw fa-lg"></i>
                                        SUBMIT
                                    </button>
                                </div>
                            }
                        </div>
                    </span>
                </h4>
            </div>
        </div>
        @*<div asp-validation-summary="All" class="text-danger"></div>*@
        <div class="card rounded shadow-lg">
            <div class="card-body bg-light">
                <div class="accordion shadow-lg" id="SelectedParameter">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="H1_BasicParameter">
                            <button class="accordion-button text-light pnl4BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B1_BasicParameter" aria-expanded="true" aria-controls="B1_BasicParameter">
                                <strong style="text-transform:uppercase">
                                    <i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Update Selected Parameter
                                </strong>

                               
                            </button>
                            <div class="d-flex gap-2 align-items-center ms-3">
                                <select id="columnSelector" class="form-select form-select-sm w-auto" onchange="toggleColumn()">
                                    <option value="">-- Select Column --</option>
                                    <option value="">-- Show All --</option>
                                    <option value="price">Price</option>
                                    <option value="hsncode">HSNCODE</option>
                                    <option value="store">Store</option>
                                    <option value="minmaxlevel">Min & Max Level</option>
                                    <option value="workcenter">Workcenter</option>
                                    <option value="productiondetail">ProductionDetail</option>
                                </select>
                                </div>
                           
                        </h2>
                        <div id="B1_BasicParameter" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H1_BasicParameter">
                            <div class="accordion-body">
                                <div class="card">
                                    <div class="card-body overflow-auto pb-0">
                                        <div class="table-responsive" style="max-height:350px;">
                                            <table class="table table-hover table-bordered table-striped" style=""id="selecteditemtable" border="1">
                                                <thead class="bg-gradient card-headerBG text-light small" style="background-color:#2E7D32" id="ItemHead1" style="white-space:nowrap;position: sticky;top: 0;z-index: 10;">
                                                    <tr id="headerRow">
                                                        <th>Sr</th>
                                                        <th>Item_Code</th>
                                                        <th>PartCode</th>
                                                        <th>Item_Name</th>
                                                        <th class="col-hsncode">HSNCODE</th>
                                                        <th class="col-workcenter">WorkCenter</th>
                                                        <th class="" style="display: none;">WorkCenterId</th>
                                                        <th class="col-store">StoreName</th>
                                                        <th class="" style="display: none;">StoreId</th>
                                                        <th class="col-price">SalePrice</th>
                                                        <th class="col-price">PurchasePrice</th>
                                                        <th class="col-price">CostPrice</th>
                                                        <th class="col-minmaxlevel">MaximumLevel</th>
                                                        <th class="col-minmaxlevel">MinimumLevel</th>
                                                        <th class="col-productiondetail">NoOfCavity</th>
                                                        <th class="col-productiondetail">NoOfshotsHours</th>
                                                        <th class="" style="display: none;">ProdInMachineGroupId</th>
                                                        <th class="col-productiondetail">ProdInMachineGroup</th>
                                                        <th class="" style="display: none;">ProdInMachine1Id</th>
                                                        <th class="col-productiondetail">ProdInMachine1</th>
                                                        <th class="" style="display: none;">ProdInMachine2Id</th>
                                                        <th class="col-productiondetail">ProdInMachine2</th>
                                                        <th class="" style="display: none;">ProdInMachine3Id</th>
                                                        <th class="col-productiondetail">ProdInMachine3</th>
                                                        <th class="" style="display: none;">ProdInMachine4Id</th>
                                                        <th class="col-productiondetail">ProdInMachine4</th>
                                                       
                                                    </tr>
                                                </thead>
                                                <tbody id="divItemList1">
                                                    <partial name="_DisplayExcelselectedItemData" />
                                                </tbody>
                                             
                                            </table>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center gap-3 mb-3">
                                        <div>
                                            <button type="button" class="btn btn-secondary btn-sm" onclick="exportTableToExcel()">
                                                <i class="fa-solid fa-upload me-1"></i> Export Excel
                                            </button>
                                        </div>
                                        <!-- File input -->
                                        <div>
                                            <input type="file" class="form-control form-control-sm" id="ExcelFile1" />
                                        </div>
                                        <div class="col-auto">
                                            @*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
                                            <a class="btn btn-secondary btn-sm" onclick="UploadButton();">
                                                @* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
                                                <i class="fa-solid fa-file-import" style="--fa-secondary-color: crimson; --fa-secondary-opacity: 1.0;"></i>
                                                IMPORT FORMAT
                                            </a>
                                        </div>
                                        <!-- Upload button -->
                                     
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body bg-light">
                <div class="accordion shadow-lg" id="accordionAccountMaster">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="H_BasicParameter">
                            <button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_BasicParameter" aria-expanded="true" aria-controls="B_BasicParameter">
                                <strong style="text-transform:uppercase"><i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Update All Parameter</strong>
                            </button>
                        </h2>
                        <div id="B_BasicParameter" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H_BasicParameter">
                            <div class="accordion-body">
                                <div class="card">
                                    <div class="card-body overflow-auto pb-0">
                                        <div class="table-responsive" style="max-height:350px;">
                                            <table class="table table-hover table-bordered table-striped" id="itemtable">
                                                <thead class="bg-gradient card-headerBG text-light small" id="ItemHead" style="white-space:nowrap;position: sticky;top: 0;z-index: 10;">
                                                  
                                                    <tr id="headerRow">
                                                        <th>Sr</th>
                                                        <th>Item_Code</th>
                                                        <th>PartCode</th>
                                                        <th>Item_Name</th>
                                                        <th>ItemGroup</th>
                                                        <th style="display:none">ItemGroupCode</th>
                                                        <th>ItemCategory</th>
                                                        <th style="display:none">ItemCategoryCode</th>
                                                        <th>Unit</th>
                                                        <th>AlternateUnit</th>
                                                        <th>HSNNO</th>
                                                        <th>MinimumLevel</th>
                                                        <th>MaximumLevel</th>
                                                        <th>StdPacking</th>
                                                        <th>ProdWorkCenterDescription</th>
                                                        <th style="display:none">ProdWorkCenterId</th>
                                                        <th>ProdInhouseJW</th>
                                                        <th>BatchNO</th>
                                                        <th>OldPartCode</th>
                                                        <th>VoltageValue</th>
                                                        <th>SerialNo</th>
                                                        <th>Package</th>
                                                        <th>LeadTime</th>
                                                        <th>SalePrice</th>
                                                        <th>PurchasePrice</th>
                                                        <th>CostPrice</th>
                                                        <th>WastagePercent</th>
                                                        <th>WtSingleItem</th>
                                                        <th>NoOfPcs</th>
                                                        <th>QcReq</th>
                                                        <th>ImageURL</th>
                                                        <th>DrawingNo</th>
                                                        <th>ReorderLevel</th>
                                                        <th>YearCode</th>
                                                        <th>RackID</th>
                                                        <th>BinNo</th>
                                                        <th>ItemSize</th>
                                                        <th>Colour</th>
                                                        <th>NeedPO</th>
                                                        <th>PackingType</th>
                                                        <th>ModelNo</th>
                                                        <th>YearlyConsumedQty</th>
                                                        <th>DispItemName</th>
                                                        <th style="display:none">PurchaseAccountcode</th>
                                                        <th style="display:none">SaleAccountcode</th>
                                                        <th >PurchaseAccountName</th>
                                                        <th>SaleAccountName</th>
                                                        <th>MinLevelDays</th>
                                                        <th>MaxLevelDays</th>
                                                        <th>DailyRequirment</th>
                                                        <th>Stockable</th>
                                                        <th>WipStockable</th>
                                                        <th>StoreName</th>
                                                        <th  style="display:none">StoreId</th>
                                                        <th>ProductLifeInus</th>
                                                        <th>ItemDesc</th>
                                                        <th>MaxWipStock</th>
                                                        <th>NeedSo</th>
                                                        <th>BomRequired</th>
                                                        <th>UniversalPartCode</th>
                                                        <th>UniversalDescription</th>
                                                        <th>IsCustJWAdjMandatory</th>
                                                        <th>Active</th>
                                                        <th>JobWorkItem</th>
                                                        <th>ItemServAssets</th>
                                                        <th>NoOfCavity</th>
                                                        <th>NoOfshotsHours</th>
                                                        <th>ChildBom</th>
                                                        <th>ProdInMachineGroup</th>
                                                        <th>ProdInMachine1</th>
                                                        <th>ProdInMachine2</th>
                                                        <th>ProdInMachine3</th>
                                                        <th>ProdInMachine4</th>
                                                        <th>Branch</th>
                                                    </tr>
                                                </thead>

                                                <tbody id="divItemList">
                                                    <partial name="_DisplayExcelItemData" />
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center gap-3 mb-3">
                                        <input class="form-control" type="file" id="ExcelFile" />
                                        <div class="col-auto">
                                            @*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
                                            <a class="btn btn-secondary btn-sm" onclick="UploadButton();">
                                                @* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
                                                <i class="fa-solid fa-file-import" style="--fa-secondary-color: crimson; --fa-secondary-opacity: 1.0;"></i>
                                                IMPORT
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="H_BasicParameter">
                        <button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_BasicParameter" aria-expanded="true" aria-controls="B_UpdateMultiItem">
                            <strong style="text-transform:uppercase"><i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Insert/Update From Excel Parameter</strong>
                        </button>
                        <select id="Insert_Update">
                            <option value="InsertDataFromExcel">Insert</option>
                            <option value="UpdateDataFromExcel">Update</option>
                        </select>
                        
                    </h2>
                    <div id="B_BasicParameter" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H_BasicParameter">
                        <div class="accordion-body">
                            <div class="card">
                                <div class="card-body overflow-auto pb-0">
                                    <input type="file" id="MultiexcelFile" class="form-control w-auto mb-3" />
                                    <div class="table-responsive" style="max-height:350px;">
                                        <div id="MultiexcelTable"></div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="card-footer p-3">
                <div class="row justify-content-between g-2">
                    @*<div class="col-auto">
                    <a class="btn btn-sm btn-secondary" href="#" onclick="back();">
                    <i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>
                    BACK
                    </a>
                    </div>*@
                    <div class="card border-light bg-gradient rounded shadow-lg">
                        <div class="card-header card-headerBG text-light justify-content-center bg-gradient">
                            <h4>
                                @ViewData["Title"] - @Model.YearCode
                                <span class="d-flex float-end" style="margin-top:-2px;">
                                    @*<a asp-action="Dashboard" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">
                                    <i class="fa-solid fa-grip fa-fw fa-lg fa-beat" aria-hidden="true"></i>
                                    Dashboard
                                    </a>*@
                                 
                                  
                                    <div class="row justify-content-between g-2">
                                        <div class="col-auto">
                                            @*<a href="#" class="btn offer-listbtn hvr-sweep-to-right btn-sm btn-secondary" onclick="back();">*@
                                            <a href="#" class=" btn btn-primary btn-sm" onclick="back();">
                                                <i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>
                                                BACK
                                            </a>
                                        </div>
                                        @if (Model.Mode != "V" && Model.Mode != "SOC" && Model.Mode != "POC")
                                        {
                                            <div class="col-auto">
                                                @*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
                                                <a class="btn btn-secondary btn-sm" onclick="window.location.reload()">
                                                    @* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
                                                    <i class="fa fa-refresh fa-fw fa-lg" aria-hidden="true"></i>
                                                    REFRESH
                                                </a>
                                            </div>

                                            <div class="col-auto">
                                                @*   <button type="submit" class="btn btn-sm btn-outline-primary">*@
                                                <button class="btn btn-primary btn-sm BtnSubmit" id="BtnSubmit" >
                                                    <i class="fa-solid fa-chevron-circle-right fa-fw fa-lg"></i>
                                                    SUBMIT
                                                </button>
                                            </div>
                                        }
                                    </div>
                                </span>
                            </h4>
                        </div>
                    </div>
                </div>
            </div>






          
        </div>
    </form>
</div>
<div id="ajaxLoader" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(255,255,255,0.7); z-index:9999; text-align:center;">
    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%);">
        <span class="spinner-border text-primary" role="status"></span>
        <br />
        <span>Processing...</span>
    </div>
</div>




<div class="modal fade" style="display:none" id="ColumnNameModel" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Column Selection Model</h5>
               
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <div class="row g-2 gx-3">

                            <div class="card-body text-center overflow-auto pb-0   ">
                               
                                <div class="table-responsive" style="max-height:350px;">
                                    <div style="width:500px">
                                        <table class="table table-bordered table-striped text-center" id="MappingTable">
                                        <thead class="bg-gradient card-headerBG text-light small" style="white-space:nowrap">
                                            <tr>
                                               
                                                <th>Table Column</th>
                                                <th>Excel Mapping</th>
                                            </tr>
                                        </thead>
                                        <tbody id="ColumnNameBody">
                                          
                                            <tr><td>PartCode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Item_Name</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Unit</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>HsnNo</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ItemGroup</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ItemCategory</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ItemServAssets</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>EntryDate</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>LastUpdatedDate</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>LeadTime</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>CC</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>SalePrice</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>PurchasePrice</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>CostPrice</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>WastagePercent</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>WtSingleItem</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>NoOfPcs</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>QcReq</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UploadItemImage</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UploadImage</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UID</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>DrawingNo</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>MinimumLevel</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>MaximumLevel</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ReorderLevel</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>YearCode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>AlternateUnit</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>RackID</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>BinNo</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ItemSize</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Colour</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>NeedPO</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>StdPacking</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>PackingType</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ModelNo</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>YearlyConsumedQty</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>DispItemName</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>PurchaseAccountcode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>SaleAccountcode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>MinLevelDays</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>MaxLevelDays</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>EmpName</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>DailyRequirment</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Stockable</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>WipStockable</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Store</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProductLifeInus</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ItemDesc</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>MaxWipStock</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>NeedSo</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>BomRequired</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>JobWorkItem</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>CreatedBy</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>CreatedOn</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UpdatedBy</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UpdatedOn</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Active</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>VendorBatchcodeMand</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>EntryByMachineName</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UniversalPartCode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>UniversalDescription</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInWorkcenter</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInhouseJW</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>BatchNO</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>itemCode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>VoltageValue</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>SerialNo</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>OldPartCode</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>package</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>IsCustJWAdjMandatory</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Branch</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>NoOfCavity</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInMachineGroup</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInMachine1</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInMachine2</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInMachine3</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>NoOfshotsHours</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ProdInMachine4</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>ChildBom</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>usedinMachorVehicle</td><td><select class="multicolumns"></select></td></tr>
                                            <tr><td>Barcode</td><td><select class="multicolumns"></select></td></tr>
                                        </tbody>
                                    </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="progress my-2" style="height: 4px;">
                        <div class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <div class="row g-2 gx-3">
                        <div class="col-12 text-center">
                            <strong>Total No Of Items : <span id="lblTotalNoOfItems1"></span></strong>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class=" btn btn-sm btn-outline-success me-2" id="BtnUpdate">
                        <i class="fa-solid fa-angles-down fa-fw fa-lg"></i> UPDATE
                    </button>

                    <button type="button" class="btn btn-sm btn-danger" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- In HTML -->
<div class="spinner"></div>

@section Scripts
{
    <script>
         $(document).ready(function () {
            GetFormRights();
         });
        let excelHeaders = [];
        document.getElementById('MultiexcelFile').addEventListener('change', function (e) {
            let file = e.target.files[0];
            if (!file) return;

            let reader = new FileReader();
            reader.onload = function (event) {
                let data = new Uint8Array(event.target.result);
                let workbook = XLSX.read(data, { type: 'array' });

                // Read first sheet
                let sheetName = workbook.SheetNames[0];
                let worksheet = workbook.Sheets[sheetName];

                // Convert to JSON (header row automatically used)
                let jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: "" });

                let table = "<table class='table table-bordered table-striped'>";
                table += "<thead><tr>";
                jsonData[0].forEach(cell => {
                    table += `<th style="background-color:#4CAF50; color:white;">${cell}</th>`;
                });
                table += "</tr></thead>";

                table += "<tbody>";
                // Start from index 1 to skip header row
                for (let i = 1; i < jsonData.length; i++) {
                    let row = jsonData[i];
                    table += "<tr>";
                    row.forEach(cell => {
                        table += `<td>${cell}</td>`; // now empty cells stay aligned
                    });
                    table += "</tr>";
                }
                table += "</tbody></table>";

                document.getElementById('MultiexcelTable').innerHTML = table;
            };
            reader.readAsArrayBuffer(file);
        });


        document.getElementById("MultiexcelFile").addEventListener("change", function (e) {
            let file = e.target.files[0];
            let reader = new FileReader();

            reader.onload = function (event) {
                let data = new Uint8Array(event.target.result);
                let workbook = XLSX.read(data, { type: "array" });

                // Get first sheet
                let sheetName = workbook.SheetNames[0];
                let worksheet = workbook.Sheets[sheetName];

                // Convert to JSON with header
                let jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                // First row = headers
                excelHeaders = jsonData[0];

                console.log("Excel Headers:", excelHeaders);

                // Now fill all dropdowns
                populateDropdowns();
            };

            reader.readAsArrayBuffer(file);
        });



        $('#BtnUpdate').click(function () {
            var flag = $('#Insert_Update').val();
            // 1. Build mapping object (DB column -> Excel column name)
            let mapping = {};
            $('#MappingTable tr').each(function () {
                let dbColumn = $(this).find('td:first').text().trim();
                let selectedExcelColumn = $(this).find('select.multicolumns').val();
                if (selectedExcelColumn) {
                    mapping[dbColumn] = selectedExcelColumn;
                }
            });
        //          if (!mapping["PartCode"] || mapping["PartCode"].trim() === "") {
        //     $.notify(" PartCode mapping is mandatory!", "error");
        //     return; // stop execution
        // }
            let mandatoryFields = ["PartCode", "Unit", "HsnNo", "ItemGroup", "ItemCategory", "ItemServAssets"];
        let missingFields = [];
        mandatoryFields.forEach(function (field) {
            if (!mapping[field] || mapping[field].trim() === "") {
                missingFields.push(field);
            }
        });
        if (missingFields.length > 0) {
            $.notify("Please map the following mandatory fields: " + missingFields.join(", "), "error");
            return;
        }
            // 2. Extract Excel Table Headers
            let excelHeaders = [];
            $('#MultiexcelTable table thead th').each(function () {
                excelHeaders.push($(this).text().trim());
            });

            // 3. Extract Excel Table Data
            let excelData = [];
            $('#MultiexcelTable table tbody tr').each(function () {
                let row = {};
                $(this).find('td').each(function (i) {
                    row[excelHeaders[i]] = $(this).text().trim();
                });
                excelData.push(row);
            });

            // 🟢 Debug: check mapping and extracted data
            console.log("Mapping object:", mapping);
            console.log("Excel data array:", excelData);

            // 4. Send AJAX to Controller
            $.ajax({
                url: '/ItemMaster/UpdateFromExcel',
                type: 'POST',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify({ Mapping: mapping, ExcelData: excelData, Flag: flag }),
                beforeSend: function () {
                    $('#ajaxLoader').show(); // ✅ Show loader
                },
                  success: function (data, status, xhr) {
            $('#ajaxLoader').hide();
            $('#ColumnNameModel').modal('hide');

            let code = data.StatusCode || data.statusCode;
            let msg = data.StatusText || data.statusText;
            if (code === 240 ){
                $.notify(msg, "error");
                return;
            }

            // ✅ If update succeeded
            if (data && (data.statusCode === 200 || data.statusCode === 202)) {
                   window.location.href = data.RedirectUrl;
               }
            // ✅ If partial success or custom warning
            else if (code === 200 && msg && msg !== "Data imported successfully") {
                $.notify(msg, "warn");
            }
            // ✅ Any other error
            else {
                $.notify(msg || "Unknown error", "error");
            }
        },

                error: function (err) {
                    alert("Error updating data");
                }
            });
        });



        // Function to populate all dropdowns
        function populateDropdowns() {
            // Get all selects with class multicolumns
            document.querySelectorAll("select.multicolumns").forEach(function (select) {
                // Clear existing options
                select.innerHTML = "";

                // Add default option
                var defaultOpt = document.createElement("option");
                defaultOpt.value = "";
                defaultOpt.text = "-- Select Column --";
                select.appendChild(defaultOpt);

                // Append Excel headers as options
                excelHeaders.forEach(function (header) {
                    var opt = document.createElement("option");
                    opt.value = header;
                    opt.text = header;
                    select.appendChild(opt);
                });
            });
        }


        $('.BtnSubmit').click(function (e) {
            e.preventDefault();
            // check if excel table has rows (excluding header)
            if ($('#MultiexcelTable table tr').length > 1) {
                // Bootstrap 5 way to open modal
                let myModal = new bootstrap.Modal(document.getElementById('ColumnNameModel'));
                myModal.show();
            } else {
                SubmitData(e);
            }
        });

        function SubmitData(e) {
            e.preventDefault();
            var flag = $('#columnSelector').val(); // Get selected flag
            var RowCount = $('#divItemList tr').length;
            var RowCount2 = $('#divItemList1 tr').length;

            var ItemData = [];
            var divSelector = '';
            var url = '';
            var i = 0;
            var fileInput1 = $('#ExcelFile1');
            var fileInput2 = $('#ExcelFile');

            var file1 = fileInput1.length ? fileInput1.prop("files")[0] : null;
            var file2 = fileInput2.length ? fileInput2.prop("files")[0] : null;

            if (RowCount > 1) {
                RowCount = RowCount;
                divSelector = '#divItemList';
                url = "/ItemMaster/UpdateItemListdata";

                for (i = 1; i <= RowCount; i++) {
                    ItemData.push({
                        Item_Code: parseInt($(divSelector).find('#Item_Code-' + i).text()) || 0,
                        PartCode: $(divSelector).find('#PartCode-' + i).text(),
                        Item_Name: $(divSelector).find('#Item_Name-' + i).text(),
                        ItemGroup: $(divSelector).find('#ItemGroup-' + i).text(),
                        ItemGroupCode: parseInt($(divSelector).find('#ItemGroupCode-' + i).text()) || 0,
                        ItemType: $(divSelector).find('#TypeName-' + i).val(),
                        ItemCategoryCode: parseInt($(divSelector).find('#ItemCategoryCode-' + i).text()) || 0,
                        Unit: $(divSelector).find('#Unit-' + i).text(),
                        AlternateUnit: $(divSelector).find('#AlternateUnit-' + i).text(),
                        HSNNO: parseInt($(divSelector).find('#HSNNO-' + i).text()) || 0,
                        MinimumLevel: parseFloat($(divSelector).find('#MinimumLevel-' + i).text()) || 0,
                        MaximumLevel: parseFloat($(divSelector).find('#MaximumLevel-' + i).text()) || 0,
                        StdPacking: parseInt($(divSelector).find('#StdPacking-' + i).text()) || 0,
                        WorkCenter: $(divSelector).find('#WorkCenter-' + i).text(),
                        ProdInWorkcenter: $(divSelector).find('#ProdInWorkcenter-' + i).text(),
                        ProdInhouseJW: $(divSelector).find('#ProdInhouseJW-' + i).text(),
                        BatchNO: $(divSelector).find('#BatchNO-' + i).text(),
                        OldPartCode: $(divSelector).find('#OldPartCode-' + i).text(),
                        VoltageVlue: $(divSelector).find('#VoltageVlue-' + i).text(),
                        SerialNo: $(divSelector).find('#SerialNo-' + i).text(),
                        Package: $(divSelector).find('#Package-' + i).text(),
                        ParentCode: $(divSelector).find('#ParentCode-' + i).text(),
                        EntryDate: $(divSelector).find('#EntryDate-' + i).text(),
                        LastUpdatedDate: $(divSelector).find('#LastUpdatedDate-' + i).text(),
                        LeadTime: $(divSelector).find('#LeadTime-' + i).text(),
                        CC: $(divSelector).find('#CC-' + i).text(),
                        SalePrice: parseFloat($(divSelector).find('#SalePrice-' + i).text()) || 0,
                        PurchasePrice: parseFloat($(divSelector).find('#PurchasePrice-' + i).text()) || 0,
                        CostPrice: parseFloat($(divSelector).find('#CostPrice-' + i).text()) || 0,
                        WastagePercent: parseFloat($(divSelector).find('#WastagePercent-' + i).text()) || 0,
                        WtSingleItem: parseFloat($(divSelector).find('#WtSingleItem-' + i).text()) || 0,
                        NoOfPcs: parseInt($(divSelector).find('#NoOfPcs-' + i).text()) || 0,
                        QcReq: $(divSelector).find('#QcReq-' + i).text(),
                        ImageURL: $(divSelector).find('#ImageURL-' + i).text(),
                        UID: $(divSelector).find('#UID-' + i).text(),
                        DrawingNo: $(divSelector).find('#DrawingNo-' + i).text(),
                        ReorderLevel: parseFloat($(divSelector).find('#ReorderLevel-' + i).text()) || 0,
                        YearCode: $(divSelector).find('#YearCode-' + i).text(),
                        RackID: $(divSelector).find('#RackID-' + i).text(),
                        BinNo: $(divSelector).find('#BinNo-' + i).text(),
                        ItemSize: $(divSelector).find('#ItemSize-' + i).text(),
                        Colour: $(divSelector).find('#Colour-' + i).text(),
                        NeedPO: $(divSelector).find('#NeedPO-' + i).text(),
                        PackingType: $(divSelector).find('#PackingType-' + i).text(),
                        ModelNo: $(divSelector).find('#ModelNo-' + i).text(),
                        YearlyConsumedQty: parseInt($(divSelector).find('#YearlyConsumedQty-' + i).text()) || 0,
                        DispItemName: $(divSelector).find('#DispItemName-' + i).text(),
                        PurchaseAccountcode: $(divSelector).find('#PurchaseAccountcode-' + i).text(),
                        SaleAccountcode: $(divSelector).find('#SaleAccountcode-' + i).text(),
                        MinLevelDays: parseInt($(divSelector).find('#MinLevelDays-' + i).text()) || 0,
                        MaxLevelDays: parseInt($(divSelector).find('#MaxLevelDays-' + i).text()) || 0,
                        EmpName: $(divSelector).find('#EmpName-' + i).text(),
                        DailyRequirment: parseInt($(divSelector).find('#DailyRequirment-' + i).text()) || 0,
                        Stockable: $(divSelector).find('#Stockable-' + i).text(),
                        WipStockable: $(divSelector).find('#WipStockable-' + i).text(),
                        Store: $(divSelector).find('#StoreId-' + i).text(),
                        ProductLifeInus: $(divSelector).find('#ProductLifeInus-' + i).text(),
                        ItemDesc: $(divSelector).find('#ItemDesc-' + i).text(),
                        MaxWipStock: parseInt($(divSelector).find('#MaxWipStock-' + i).text()) || 0,
                        NeedSo: $(divSelector).find('#NeedSo-' + i).text(),
                        BomRequired: $(divSelector).find('#BomRequired-' + i).text(),
                        UniversalPartCode: $(divSelector).find('#UniversalPartCode-' + i).text(),
                        UniversalDescription: $(divSelector).find('#UniversalDescription-' + i).text(),
                        IsCustJWAdjMandatory: $(divSelector).find('#IsCustJWAdjMandatory-' + i).text(),
                        Active: $(divSelector).find('#Active-' + i).text(),
                        JobWorkItem: $(divSelector).find('#JobWorkItem-' + i).text(),
                        ItemServAssets: $(divSelector).find('#ItemServAssets-' + i).text(),
                        NoOfCavity: $(divSelector).find('#NoOfCavity-' + i).text(),
                        NoOfshotsHours: $(divSelector).find('#NoOfshotsHours-' + i).text(),
                        ChildBom: $(divSelector).find('#ChildBom-' + i).text(),
                        ProdInMachineGroupId: $(divSelector).find('#ProdInMachineGroupId-' + i).text(),
                        ProdInMachine1: $(divSelector).find('#ProdInMachine1-' + i).text(),
                        ProdInMachine2: $(divSelector).find('#ProdInMachine2-' + i).text(),
                        ProdInMachine3: $(divSelector).find('#ProdInMachine3-' + i).text(),
                        ProdInMachine4: $(divSelector).find('#ProdInMachine4-' + i).text(),
                        Branch: $(divSelector).find('#Branch-' + i).text(),
                    });
                }
            } else {
                RowCount = RowCount2;
                divSelector = '#divItemList1';
                url = "/ItemMaster/UpdateSelectedItemListdata";

                for (i = 1; i <= RowCount; i++) {
                    ItemData.push({
                        Item_Code: parseInt($(divSelector).find('#Item_Code-' + i).text()) || 0,
                        PartCode: $(divSelector).find('#PartCode-' + i).text(),
                        Item_Name: $(divSelector).find('#Item_Name-' + i).text(),
                        HSNNO: parseInt($(divSelector).find('#HSNNO-' + i).text()) || 0,
                        MinimumLevel: parseFloat($(divSelector).find('#MinimumLevel-' + i).text()) || 0,
                        MaximumLevel: parseFloat($(divSelector).find('#MaximumLevel-' + i).text()) || 0,
                        ProdInWorkcenter: $(divSelector).find('#ProdInWorkcenter-' + i).text(),
                        SalePrice: parseFloat($(divSelector).find('#SalePrice-' + i).text()) || 0,
                        PurchasePrice: parseFloat($(divSelector).find('#PurchasePrice-' + i).text()) || 0,
                        CostPrice: parseFloat($(divSelector).find('#CostPrice-' + i).text()) || 0,
                        Store: $(divSelector).find('#StoreId-' + i).text(),
                        NoOfCavity: $(divSelector).find('#NoOfCavity-' + i).text(),
                        NoOfshotsHours: $(divSelector).find('#NoOfshotsHours-' + i).text(),
                        ProdInMachineGroupId: $(divSelector).find('#ProdInMachineGroupId-' + i).text(),
                        ProdInMachine1: $(divSelector).find('#ProdInMachine1-' + i).text(),
                        ProdInMachine2: $(divSelector).find('#ProdInMachine2-' + i).text(),
                        ProdInMachine3: $(divSelector).find('#ProdInMachine3-' + i).text(),
                        ProdInMachine4: $(divSelector).find('#ProdInMachine4-' + i).text(),
                    });
                }
            }


            // Set data payload conditionally
            var dataToSend = { model: ItemData };
            if (url === "/ItemMaster/UpdateSelectedItemListdata") {
                dataToSend.flag = flag;
            }

            $.ajax({
                url: url,
                type: "POST",
                data: dataToSend,
                beforeSend: function () {
                    $('#ajaxLoader').show(); // ✅ Show loader
                },
                success: function (data, status, xhr) {
                    $('#ajaxLoader').hide();
                    $.notify("Data Update Successfully!!", "info");
                    if (data && (data.statusCode === 200 || data.statusCode === 202)) {
                        window.location.href = data.RedirectUrl;
                    } else {
                        //    console.log(data);
                        //  alert(data.statusText);
                        // Show notify message if error-like StatusText is returned
                        $.notify(data.statusText, "error");
                    }
                    //    console.log("success");
                },
                error: function (result, status, xhr) {
                    $('#ajaxLoader').hide();
                    $.notify(result.responseText, "error");
                }
            });
        }



        function DeleteItemRow(seqNo) {
            $('.' + seqNo).remove();
        }

            function toggleColumn() {
            var selected = document.getElementById("columnSelector").value;
            if (!selected) {
                document.querySelectorAll('#selecteditemtable [class^="col-"]').forEach(el => el.style.display = '');
            } else {
                document.querySelectorAll('#selecteditemtable [class^="col-"]').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.col-' + selected).forEach(el => el.style.display = '');
            }
        }
               let isFirstLoad = true; // track first time

        $("#columnSelector").on("change", function () {
            let selected = $(this).val();

            if (selected) {
                if (!isFirstLoad) {
                    toggleColumn();
                } else {
                    $("#ajaxLoader").show();
                    $.ajax({
                        url: '@Url.Action("GetUpdateandImportDashBoardData", "ItemMaster")',
                        type: "GET",
                        data: { Flag: selected },
                        success: function (data) {
                            $("#divItemList1").html(data);
                            toggleColumn();
                            isFirstLoad = false;
                        },
                        complete: function () {
                            $("#ajaxLoader").hide();
                        }
                    });
                }
            }
        });
            function exportTableToExcel() {
            var selectedColumn = document.getElementById("columnSelector").value;
            window.location.href = '/ItemMaster/ExportSelectedItemToExcel?flag=' + selectedColumn;
        }
                function UploadButton() {
            var fileInput1 = $('#ExcelFile1');
            var fileInput2 = $('#ExcelFile');

            var file1 = fileInput1.length ? fileInput1.prop("files")[0] : null;
            var file2 = fileInput2.length ? fileInput2.prop("files")[0] : null;

            var flag = $('#columnSelector').val();
            var formData = new FormData();
            var url = "";

            if (file1) {
                if (!flag) {
                    $.notify("Please select a column type.", "error");
                    return;
                }

                formData.append("excelFile", file1);
                formData.append("flag", flag);
                url = "/ItemMaster/PreviewExcelData";

                $('#selecteditemtable').show();
                $('#itemtable').hide();
            } else if (file2) {
                formData.append("excelFile", file2);
                url = "/ItemMaster/UpdateUploadExcel";

                $('#itemtable').show();
                $('#selecteditemtable').hide();
            } else {
                $.notify("Please choose an Excel file to upload.", "error");
                return;
            }

            // Clear grids before rendering new content
            $('#divItemList1').html("");
            $('#divItemList').html("");

            $.ajax({
                url: url,
                type: "POST",
                data: formData,
                processData: false,
                contentType: false,
                     beforeSend: function () {
            $('#ajaxLoader').show(); // ✅ Show loader
        },
                success: function (result) {
                    $('#ajaxLoader').hide();
                    // Render the appropriate grid
                    if (url.includes("PreviewExcelData")) {
                        $('#divItemList1').html(result); // Grid 1
                    } else {
                        $('#divItemList').html(result);  // Grid 2
                    }

                },
                error: function (xhr) {
                      $('#ajaxLoader').hide();
                    try {
                        var response = JSON.parse(xhr.responseText);

                        if (response.errors && Array.isArray(response.errors)) {
                            response.errors.forEach(function (err) {
                                $.notify(err, "error");
                            });
                        } else {
                            $.notify(xhr.responseText, "error");
                        }
                    } catch (e) {
                        $.notify("Unexpected error: " + xhr.responseText, "error");
                    }
                }
            });
        }

        // function UploadButton() {
        //     var fileInput = $('#ExcelFile');
        //     var file = fileInput.prop("files")[0];

        //     var formData = new FormData();
        //     formData.append("excelFile", file);

        //     $.ajax({
        //         url: "/ItemMaster/UpdateUploadExcel",
        //         type: "POST",
        //         data: formData,
        //         processData: false,
        //         contentType: false,
        //         success: function (result) {
        //             if (result.startsWith("Invalid Unit")) {
        //                 $.notify(result, "error");
        //             }
        //             $('#divItemList').html(result);
        //             //CheckBeforeSubmit();
        //         }
        //     });
        // }
        function GetFormRights() {
            $.ajax({
                url: "@Url.Action("GetFormRights")",
                type: "POST",
                success: function (data) {
                    if (data != null) {
                        var obj = $.parseJSON(data);
                        if (obj.Result.Table.length == 0) {
                            $("#BtnSubmit").prop("disabled", true);
                        } else {
                           // console.log(obj);
                            var optAll = obj.Result.Table[0].OptAll;
                            var optSave = obj.Result.Table[0].OptSave;
                            var optUpdate = obj.Result.Table[0].OptUpdate;
                            var optDelete = obj.Result.Table[0].OptDelete;
                            var optView = obj.Result.Table[0].OptView;
                            if (!optAll) {
                                if (!optSave) {
                                    $("#BtnSubmit").prop("disabled", true);

                                }
                            }
                        }
                    }
                },
                error: function (errMsg) {
                    $.notify(errMsg, { position: "top center", className: "error" });
                }
            });
        }
        function CheckBeforeSubmit() {
            //$.ajax({
            //    url: "/ItemMaster/UploadExcel",
            //    type: "POST",
            //    data: formData,
            //    processData: false,
            //    contentType: false,
            //    success: function (result) {
            //
            //        $('#divItemList').html(result);
            //        CheckBeforeSubmit();
            //    }
            //});
        }

       

        //  function SubmitData(e) {

        //     var RowCount = $('#divItemList tr').length;
        //     var errorCount = parseInt($('#ErrorCntr-' + RowCount).val());



        //     // if (errorCount != 0) {
        //     //     e.preventDefault();
        //     //     $.notify("Error in data can't submit", "error");
        //     //     return false;
        //     // }
        //     // else {
        //         var ItemData = [];
        //           for (let i = 1; i <= RowCount; i++) {
        //          ItemData.push({
        //         Item_Code: parseInt($('#Item_Code-' + i).text()) || 0,
        //         PartCode: $('#PartCode-' + i).text(),
        //         Item_Name: $('#Item_Name-' + i).text(),
        //         ItemGroup: $('#ItemGroup-' + i).text(),
        //         ItemGroupCode: parseInt($('#ItemGroupCode-' + i).text()) || 0,
        //         ItemType: $('#TypeName-' + i).val(),
        //         ItemCategoryCode: parseInt($('#ItemCategoryCode-' + i).text()) || 0,
        //         Unit: $('#Unit-' + i).text(),
        //         AlternateUnit: $('#AlternateUnit-' + i).text(),
        //         HSNNO: parseInt($('#HSNNO-' + i).text()) || 0,
        //         MinimumLevel: parseFloat($('#MinimumLevel-' + i).text()) || 0,
        //         MaximumLevel: parseFloat($('#MaximumLevel-' + i).text()) || 0,
        //         StdPacking: parseInt($('#StdPacking-' + i).text()) || 0,
        //         WorkCenter: $('#WorkCenter-' + i).text(),
        //         ProdInWorkcenter: $('#ProdInWorkcenter-' + i).text(),
        //         ProdInhouseJW: $('#ProdInhouseJW-' + i).text(),
        //         BatchNO: $('#BatchNO-' + i).text(),
        //         OldPartCode: $('#OldPartCode-' + i).text(),
        //         VoltageVlue: $('#VoltageVlue-' + i).text(),
        //         SerialNo: $('#SerialNo-' + i).text(),
        //         Package: $('#Package-' + i).text(),
        //         ParentCode: $('#ParentCode-' + i).text(),
        //         EntryDate: $('#EntryDate-' + i).text(),
        //         LastUpdatedDate: $('#LastUpdatedDate-' + i).text(),
        //         LeadTime: $('#LeadTime-' + i).text(),
        //         CC: $('#CC-' + i).text(),
        //         SalePrice: parseFloat($('#SalePrice-' + i).text()) || 0,
        //         PurchasePrice: parseFloat($('#PurchasePrice-' + i).text()) || 0,
        //         CostPrice: parseFloat($('#CostPrice-' + i).text()) || 0,
        //         WastagePercent: parseFloat($('#WastagePercent-' + i).text()) || 0,
        //         WtSingleItem: parseFloat($('#WtSingleItem-' + i).text()) || 0,
        //         NoOfPcs: parseInt($('#NoOfPcs-' + i).text()) || 0,
        //         QcReq: $('#QcReq-' + i).text(),
        //         ImageURL: $('#ImageURL-' + i).text(),
        //         UID: $('#UID-' + i).text(),
        //         DrawingNo: $('#DrawingNo-' + i).text(),
        //         ReorderLevel: parseFloat($('#ReorderLevel-' + i).text()) || 0,
        //         YearCode: $('#YearCode-' + i).text(),
        //         RackID: $('#RackID-' + i).text(),
        //         BinNo: $('#BinNo-' + i).text(),
        //         ItemSize: $('#ItemSize-' + i).text(),
        //         Colour: $('#Colour-' + i).text(),
        //         NeedPO: $('#NeedPO-' + i).text(),
        //         PackingType: $('#PackingType-' + i).text(),
        //         ModelNo: $('#ModelNo-' + i).text(),
        //         YearlyConsumedQty: parseInt($('#YearlyConsumedQty-' + i).text()) || 0,
        //         DispItemName: $('#DispItemName-' + i).text(),
        //         PurchaseAccountcode: $('#PurchaseAccountcode-' + i).text(),
        //         SaleAccountcode: $('#SaleAccountcode-' + i).text(),
        //         MinLevelDays: parseInt($('#MinLevelDays-' + i).text()) || 0,
        //         MaxLevelDays: parseInt($('#MaxLevelDays-' + i).text()) || 0,
        //         EmpName: $('#EmpName-' + i).text(),
        //         DailyRequirment: parseInt($('#DailyRequirment-' + i).text()) || 0,
        //         Stockable: $('#Stockable-' + i).text(),
        //         WipStockable: $('#WipStockable-' + i).text(),
        //         Store: $('#Store-' + i).text(),
        //         ProductLifeInus: $('#ProductLifeInus-' + i).text(),
        //         ItemDesc: $('#ItemDesc-' + i).text(),
        //         MaxWipStock: parseInt($('#MaxWipStock-' + i).text()) || 0,
        //         NeedSo: $('#NeedSo-' + i).text(),
        //         BomRequired: $('#BomRequired-' + i).text(),
        //         UniversalPartCode: $('#UniversalPartCode-' + i).text(),
        //         UniversalDescription: $('#UniversalDescription-' + i).text(),
        //         IsCustJWAdjMandatory: $('#IsCustJWAdjMandatory-' + i).text(),
        //         Active: $('#Active-' + i).text(),
        //         JobWorkItem: $('#JobWorkItem-' + i).text(),
        //         ItemServAssets: $('#ItemServAssets-' + i).text()
        //     });
        //       }
        //   //  }
        //       // alert('Model'+ItemData);
        //     $.ajax({
        //         url: "@Url.Action("UpdateItemListdata")",
        //         type: "POST",
        //         data: { model: ItemData },
        //         beforeSend: function (xhr) {

        //         },

        //         success: function (data, status, xhr) {
        //             console.log("success");

        //         },
        //         error: function (result, status, xhr) {
        //             $.notify(result.responseText, "error");
        //         }
        //     });
        // }

                //$('.uploadButton').click(function(){
                //    var fileInput = $('#ExcelFile');
                //    var file = fileInput.files[0];

                //    var formData = new FormData();
                //    formData.append("excelFile",file);

                //    $.ajax({
                //        url: "/ItemMaster/UploadExcel",
                //        type:"POST",
                //        data: {excelFile : formData},
                //        processData:false,
                //        contentType:false,
                //        success:function(result){
                //
                //            $('#divItemList').html(result);
                //        }
                //    });
                //})

        function ExportItems() {
            $('#divItemList').empty();
            var firstTh = $("#headerRow th:first");
            //var groupTh = $("#headerRow th:eq(5)");
            //var catTH = $("#headerRow th:eq(6)");
            firstTh.remove();
            $("#headerRow th:eq(5)").remove();
            $("#headerRow th:eq(6)").remove();
            var newTh = $("<th>Action</th>");

            let table = $("#itemtable");
            //console.log(table);
          //   ;
            TableToExcel.convert(table[0], {
                name: `ImportItemsFile.xlsx`,
                sheet: {
                    name: 'ImportItemsFile'
                }
            });

            var groupTh=$("<th>Group Code</th>");
            var catTh=$("<th>Category Code</th>");
            $("#headerRow").prepend(newTh);
            $("#headerRow th:eq(6)").before(groupTh);
            $("#headerRow th:eq(7)").before(catTh);
        }
    </script>
    <script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
}