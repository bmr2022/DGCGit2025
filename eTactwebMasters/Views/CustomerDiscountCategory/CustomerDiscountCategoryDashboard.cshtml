@model List<eTactWeb.DOM.Models.CustomerDiscountCategoryModel>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<div class="shadow-lg">
    <form id="SParam" method="post" asp-controller="CustomerDiscountCategory" asp-action="CustomerDiscountCategoryDashboard" autocomplete="off">
        <div class="card rounded border-light bg-gradient">
            <div class="card-header card-headerBG text-light bg-gradient">
                <h5>
                    Discount Category - <strong>Dashboard</strong>
                    <span class="d-flex float-end" style="margin-top:-2px;">
                        <a asp-action="CustomerDiscountCategory" asp-controller="CustomerDiscountCategory" asp-route-ID="0"
                           class="btn btn-sm btn-outline-light bg-gradient" id="savebtn">
                            <i class="fa fa-plus-circle fafw fa-lg" aria-hidden="true"></i>
                            Add New
                        </a>
                    </span>
                </h5>
            </div>
            <div class="card-body">
                <div class="card overflow-auto">
                    <div class="card-body">
                        <div class="row">
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            <div class="col-sm-3 col-md-6 col-lg-4 col-xl-2">
                                <label class="form-label">Global search</label>
                                <input type="text" class="form-control"  id="search-box"
                                       style="background-color:#FFFACD" placeholder="Search...">
                            </div>
                            <div class=" d-flex justify-content-center mt-3 col-sm-5 col-md-8 col-lg-6 col-xl-4">
                                <button class="btn btn-sm btn-outline-info" type="button" style="padding:0px;height:30px;width:100px;" onclick="GetSearchData();">
                                    <i class="fa-solid fa-magnifying-glass fa-fw fa-lg"></i>SEARCH
                                </button>
                                <button class="btn btn-sm btn-outline-success" style="padding:3px;height:30px;width:100px;margin-left:20px;" type="button" id="sendToExcel">
                                    <i class="fa-solid fa-upload fa-fw fa-lg "></i>EXCEL
                                </button>
                                <a class="btn btn-sm btn-outline-danger" style="padding:3px;height:30px;width:100px;margin-left:20px;"
                                   asp-controller="DiscountCustomerCategory" asp-action="DiscountCustomerCategoryDashboard">
                                    <i class="fa-solid fa-rotate fa-fw fa-lg"></i>RESET
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body pb-0 pt-0">
                <div class="progress" style="height: 4px;">
                    <div class="progress-bar progress-bar-striped bg-info" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
            <div class="card-body">
                <div class="card overflow-auto">
                    <div class="card-body" id="divDashboardGrid">
                        <partial name="_CustomerDiscountCategoryDashboardGrid" model="@Model"/>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <script>

        $(document).ready(function () {
            GetFormRights();
        });

        function GetFormRights() {
            $.ajax({
                url: "@Url.Action("GetFormRights")",
                type: "POST",
                async: false,
                success: function (data) {
                    // Same logic as StoreMaster
                    // you can keep identical code, just ensure grid IDs and partials are aligned
                }
            });
        }

        function confirmDelete(el) {
            if (!confirm("Are you sure you want to delete this category?")) return;

            var id = $(el).data("id");

            $.ajax({
                url: '/CustomerDiscountCategory/Delete/' + id,
                type: 'POST',
                data: { id: id },
                success: function (response) {
                    if (response.success) {
                        alert(response.message);
                        location.reload();
                    } else {
                        alert(response.message);
                    }
                },
                error: function () {
                    alert("Error while deleting record.");
                }
            });
        }

       


    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script><script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.19.1/jquery.validate.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/mvc/5.2.3/jquery.validate.unobtrusive.min.js"></script>
   
}
