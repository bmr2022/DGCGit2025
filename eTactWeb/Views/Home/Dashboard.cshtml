@model eTactWeb.DOM.Models.DashboardModel

@{
	ViewData["Title"] = "Dashboard";
	Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Combined Dashboard</title>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<style>
		body {
			font-family: 'Segoe UI', sans-serif;
			background-color: #f7f9fa;
			margin: 20px;
		}

		h2 {
			text-align: center;
			font-size: 28px;
			margin-bottom: 20px;
		}

		.dashboard {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
			gap: 20px;
			margin: 10px;
		}

		.card {
			background: white;
			padding: 1px;
			border-radius: 12px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.05);
		}

			.card h3 {
				margin: 0;
				font-size: 1rem;
				color: #555;
			}

			.card .value {
				font-size: 2rem;
				font-weight: bold;
				margin-top: 10px;
			}

		.wide-card {
			grid-column: span 2;
		}

		canvas {
			margin-top: 10px;
		}

		table {
			width: 100%;
			border-collapse: collapse;
			font-size: 0.9rem;
		}

			table th, table td {
				padding: 8px;
				border-bottom: 1px solid #eee;
				text-align: left;
			}

		ul {
			padding-left: 20px;
		}

		.highlight-red {
			color: red;
			font-weight: bold;
		}

		.card-container {
			display: flex;
			gap: 20px;
			justify-content: center;
			flex-wrap: wrap;
			margin-bottom: 30px;
		}

		.dashboard-card {
			display: flex;
			flex: 1 1 250px; /* grows and shrinks, minimum width 250px */
			background-color: white;
			border-radius: 10px;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
			max-width: 320px;
			overflow: hidden;
			min-height: 80px;
		}

		.progress-bar-container {
			width: 150%;
			background-color: #e0e0e0;
			border-radius: 10px;
			overflow: hidden;
			height: 10px;
		}

		.progress-bar {
			height: 100%;
			background-color: #28a745;
			width: 0%; /* Will be filled dynamically */
			transition: width 0.5s ease-in-out;
		}

		.dashboard-card .icon-box {
			width: 80px;
			background-color: #7ba5e7;
			color: white;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 40px;
			cursor: pointer;
		}

		.dashboard-card.red .icon-box {
			background-color: #d06359;
		}

		.dashboard-card .card-content {
			padding: 12px 15px;
			display: flex;
			flex-direction: column;
			justify-content: center;
		}

			.dashboard-card .card-content h3 {
				font-size: 15px;
				margin: 0;
				color: #333;
			}

			.dashboard-card .card-content .value {
				font-size: 20px;
				font-weight: bold;
				color: #111;
			}

		/* Chart section */
		.chart-section {
			max-width: 800px;
			margin: 0 auto;
			background-color: #fff;
			border-radius: 10px;
			padding: 20px;
			box-shadow: 0 2px 6px rgba(0,0,0,0.1);
		}

		canvas {
			width: 100% !important;
			height: 300px !important;
		}

		.table-container {
			width: 100%;
			max-width: 1000px;
			background: white;
			border-radius: 6px;
			box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
			overflow: hidden;
		}

		.custom-table {
			font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
			font-size: 14px;
			width: 100%;
			border-collapse: collapse;
		}

			.custom-table tbody tr:nth-child(even) {
				background-color: #c9d6eb;
			}

		.custom-table-scroll {
			max-height: 400px;
			overflow-y: auto;
			border-radius: 8px;
		}

		.custom-table thead th {
			position: sticky;
			top: 0;
			background-color: #4a6fa5;
			color: white;
			padding: 5px 10px; /* tighter */
			text-align: left;
			z-index: 2;
			font-weight: 600;
		}

		.custom-table tbody td {
			padding: 5px 10px; /* less padding */
			color: #333;
			border-bottom: 1px solid #ddd;
			font-weight: 650;
			font-size: 10px;
		}

		.tab-nav {
			display: flex;
			border-bottom: 2px solid #ccc;
		}

			.tab-nav .tab-link {
				display: flex;
				align-items: center;
				padding: 0px 8px;
				cursor: pointer;
				background: #f2f2f2;
				border: none;
				outline: none;
				font-weight: 600;
				border-radius: 12px;
				color: #333;
				border-radius: 8px 8px 0 0;
				transition: background 0.3s;
				gap: 12px;
			}

				.tab-nav .tab-link.active {
					background: #c7d9ed;
					color: #fff;
				}

		/* Tab Content Area */
		.tab-content {
			display: none;
			padding: 20px;
			background: #fff;
			border: 2px solid #ccc;
			border-top: none;
			border-radius: 0 0 8px 8px;
		}

			.tab-content.active {
				display: block;
			}

		.tab-icon-container {
			width: 35px;
			height: 35px;
			border-radius: 6px;
			display: flex;
			justify-content: center;
			align-items: center;
			color: white;
			font-size: 18px;
			flex-shrink: 0;
		}

		.bg-icon {
			background-color: #325db0;
		}

		.tab-text {
			font-size: 16px;
			font-weight: 500;
			color: #333;
		}

	</style>
</head>
<body>
	<div class="tab-nav">
		<button class="tab-link active" data-target="#inventoryTab">
			<div class="tab-icon-container bg-icon" onclick="RefreshAllInventory()">
				<i class="fas fa-boxes"></i>
			</div>
			<div class="tab-text">
				Inventory Dashboard
			</div>
		</button>
		<button class="tab-link" data-target="#supplyChainTab">
			<div class="tab-icon-container bg-icon">
				<i class="fas fa-truck"></i>
			</div>
			<div class="tab-text">
				Supply Chain Dashboard
			</div>
		</button>
		<button class="tab-link" data-target="#purchaseTab">
			<div class="tab-icon-container bg-icon">
				<i class="fas fa-file-invoice"></i>
			</div>
			<div class="tab-text">
				Purchase Dashboard
			</div>
		</button>
	</div>
	<div id="inventoryTab" class="tab-content active">
		<!-- Inventory Dashboard -->
		<div class="card-container">
			<input type="hidden" id="TotalRMValue" />
			<input type="hidden" id="TotalFGValue" />
			<input type="hidden" id="TotalStockValue" />
			<input type="hidden" id="TotalConsValue" />
			<input type="hidden" id="TotalToolsValue" />
			<input type="hidden" id="TotalOthersValue" />
			<div class="dashboard-card">
				<div class="icon-box" onclick="FillNoOfItemInStock()">
					<i class="fas fa-coins"></i>
				</div>
				<div class="card-content">
					<h3>Total Stock Value (₹)</h3>
					<div class="value TotalStockValue" id="TotalStockValue"></div>
					@* <div class="progress-bar-container">
						<div class="progress-bar" id="StockProgressBar"></div>
					</div> *@
				</div>
			</div>
			<div class="dashboard-card">
				<div class="icon-box" onclick="StockValuation()">
					<i class="fas fa-box"></i>
				</div>
				<div class="card-content">
					<h3>Total Items in Stock</h3>
					<div class="value" id="TotalNoofItemInStock"></div>
					@* 					<div class="progress-bar-container">
						<div class="progress-bar" id="StockProgressBar"></div>
					</div> *@
				</div>
			</div>
			<div class="dashboard-card red">
				<div class="icon-box">
					<i class="fas fa-triangle-exclamation"></i>
				</div>
				<div class="card-content">
					<h3>Dead Stock Items</h3>
					<div class="value" id="TotalNoOfDeadStockItems"></div>
					@* <div class="progress-bar-container">
						<div class="progress-bar" id="StockProgressBar"></div>
					</div> *@
				</div>
			</div>
			<div class="dashboard-card red">
				<div class="icon-box">
					<i class="fas fa-circle-exclamation"></i>
				</div>
				<div class="card-content">
					<h3>Dead Stock Value (₹)</h3>
					<div class="value" id="TotalValueOfDeadStock"></div>
					@* <div class="progress-bar-container">
						<div class="progress-bar" id="StockProgressBar"></div>
					</div> *@
				</div>
			</div>
		</div>
		<div class="dashboard">
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3 style="margin: 0;">Valuation By Category</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fas fa-list-alt " style="font-size: 24px;cursor:pointer;" onclick="StockValuation()"></i>
					</div>
				</div>
				<div class="card-body">
					<h3>Total Stock Value (₹): <span class="TotalStockValue">0</span></h3>
					<canvas id="valuationByCategoryChart"></canvas>
				</div>
			</div>
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3 style="margin: 0;">Inventory by Category</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fa fa-boxes" style="font-size: 24px;cursor:pointer;" onclick="StockValuation()"></i>
					</div>
				</div>
				<div class="card-body">
					<canvas id="inventoryByCategoryChart"></canvas>
				</div>
			</div>
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3 style="margin: 0;">Fast vs Slow Moving Items</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fas fa-clock" style="font-size: 24px;cursor:pointer;" onclick="StockValuation()"></i>
					</div>
				</div>
				<div class="card-body">
					<canvas id="fastSlowChart"></canvas>
				</div>
			</div>
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3>Pending</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fas fa-hourglass-half" style="font-size: 24px;cursor:pointer;" onclick="PendingInventoryTask()"></i>
					</div>
				</div>
				<table>
					<thead><tr><th>Form</th><th>Qty</th></tr></thead>
					<tbody>
						<tr>
							<td><a class="table-link link-primary" asp-action="PendingRequisitionToIssue" asp-controller="PendingRequisitionToIssue" id="MaterialtoIssueWOBOM">Req Without BOM</a></td>
							<td><span id="PendRequisitionWithoutBOM">0</span></td>
						</tr>
						<tr>
							<td><a class="table-link link-primary" asp-action="PendingMaterialToIssueThrBOM" asp-controller="PendingMaterialToIssueThrBOM" id="MaterialtoIssueThrBOM">Req Against BOM</a></td>
							<td><span id="PendingReqAgainstBOM">0</span></td>
						</tr>
						<tr>
							<td><a class="table-link link-primary" asp-action="PendingProductionSchedule" asp-controller="PendingProductionSchedule" id="IssueAgainstProdSchedule">Against Plan</a></td>
							<td><span id="PendingAgainstPlan">0</span></td>
						</tr>
						<tr>
							<td><a class="table-link link-primary" asp-action="MaterialReceipt" asp-controller="MaterialReceipt" id="MaterialReceiptNote">Gate Entry For MRN</a></td>
							<td><span id="PendingGateEntryForMRN">0</span></td>
						</tr>
						<tr>
							<td><a class="table-link link-primary" asp-action="PendingMRNtoQc" asp-controller="PendingMRNtoQc" id="MRIR">MRN For Qc</a></td>
							<td><span id="PendingMRNForQc">0</span></td>
						</tr>
						<tr>
							<td><a class="table-link link-primary" asp-action="JobWorkReceive" asp-controller="JobWorkReceive" id="JobWorkReceive">Gate Entry For JW MRN</a></td>
							<td><span id="PendingGateEntryForJWMrn">0</span></td>
						</tr>
						<tr>
							<td><a class="table-link link-primary" asp-action="PendingToReceiveItem" asp-controller="PendingToReceiveItem" id="ReceiveItemInStore">ReceiveItem In Store</a></td>
							<td><span id="PendingToReceiveItemInStore">0</span></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="dashboard">
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3>Top Items by Stock Value</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fas fa-sort-amount-up-alt" style="font-size: 24px;cursor:pointer" onclick="StockValuation()"></i>
					</div>
				</div>
				<div class="table-container" style="max-height:350px;">
					<table class="custom-table custom-table-scroll" style="width: 100%;">
						<thead style="background-color:#7493c3">
							<tr>
								<th>PartCode</th>
								<th>ItemName</th>
								<th>Stock</th>
								<th>Value</th>
							</tr>
						</thead>
						<tbody id="TopItemByStockValue">
						</tbody>
					</table>
				</div>
			</div>
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3>Top Items Below Min Level</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fas fa-arrow-down" style="font-size: 24px;cursor:pointer" onclick="StockValuation()"></i>
					</div>
				</div>
				<div class="table-container" style="max-height:350px;">
					<table class="custom-table" style="width: 100%;">
						<thead style="background-color:#7493c3">
							<tr>
								<th>PartCode</th>
								<th>ItemName</th>
								<th>Stock</th>
							</tr>
						</thead>
						<tbody id="TopItemBelowMinLevel">
						</tbody>
					</table>
				</div>
			</div>
			<div class="card">
				<div style="width: 100%; background-color: #f0f0f0; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px;">
					<h3>Top Fast Moving Item</h3>
					<div class="tab-icon-container bg-icon">
						<i class="fas fa-chart-line" style="font-size: 24px;"></i>
					</div>
				</div>
				<div class="table-container" style="max-height:350px;">
					<table class="custom-table" style="width: 100%;">
						<thead style="background-color:#7493c3">
							<tr>
								<th>PartCode</th>
								<th>ItemName</th>
								<th>IssQty</th>
								<th>Transaction</th>
							</tr>
						</thead>
						<tbody id="TopFastMovingItem">
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div id="supplyChainTab" class="tab-content">
		<!-- Supply Chain Dashboard -->
		<div class="dashboard">
			<div class="card">
				<h3>Perfect Orders</h3>
				<canvas id="perfectOrdersChart"></canvas>
				<p>In Time, Meet Quality/Quantity, Correct Invoice</p>
			</div>
			<div class="card">
				<h3>Total Shipping Cost</h3>
				<div class="value">770.7K</div>
			</div>
			<div class="card">
				<h3>Total Quantity Shipped</h3>
				<div class="value">1.52M</div>
			</div>
			<div class="card">
				<h3>Total International Shipment</h3>
				<div class="value">1.07M</div>
			</div>
			<div class="card">
				<h3>Perfect Orders by Warehouse</h3>
				<canvas id="warehouseBarChart"></canvas>
			</div>
			<div class="card">
				<h3>Return by Product Type</h3>
				<canvas id="returnByProdChart"></canvas>
			</div>
			<div class="card">
				<h3>Total Return & Trend</h3>
				<canvas id="returnTrendChart"></canvas>
			</div>
		</div>
	</div>
	<div id="purchaseTab" class="tab-content">
		<div class="card-container">
			<div class="dashboard-card">
				<div class="icon-box" onclick="FillNoOfItemInStock()">
					<i class="fas fa-coins"></i>
				</div>
				<div class="card-content">
					<h3>Total Procurement</h3>
					<div class="value TotalStockValue" id="TotalStockValue"></div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

@section Scripts {

	<!-- Chart JS Scripts -->
	<script>

		document.addEventListener("DOMContentLoaded", function () {
		  const tabLinks = document.querySelectorAll(".tab-link");
		  const tabContents = document.querySelectorAll(".tab-content");

		  tabLinks.forEach(link => {
			link.addEventListener("click", () => {
			  // Remove "active" class from all tabs and contents
			  tabLinks.forEach(l => l.classList.remove("active"));
			  tabContents.forEach(c => c.classList.remove("active"));

			  // Activate the clicked tab and corresponding content
			  link.classList.add("active");
			  const target = document.querySelector(link.dataset.target);
			  if (target) target.classList.add("active");
			});
		  });
		});

		$(document).ready(function () {
			FillInventoryDashboardData();
			FillInventoryDashboardForPendingData();
			FillInventoryByCategory();
			GetTopItemByStockValue();
			GetTopItemBelowMinLevel();
			GetTopFastMovingItem();
		});

		function FillInventoryDashboardData(){
			$.ajax({
						url: '@Url.Action("FillInventoryDashboardData", "Home")',
						type: 'POST',
						async: false,
						data: {},
						success: function (response, status, error) {

							var obj = $.parseJSON(response);
							if (obj.StatusCode == 200 && obj.StatusText === 'Success'){
								$('.TotalStockValue').text(obj.Result[0].TotalStockValue);
								$('#TotalNoofItemInStock').text(obj.Result[0].TotalNoofItemInStock);
								$('#TotalNoOfDeadStockItems').text(obj.Result[0].TotalNoOfDeadStockItems);
								$('#TotalValueOfDeadStock').text(obj.Result[0].TotalValueOfDeadStock);
								$('#TotalRMValue').val(obj.Result[0].TotalRMValue);
								$('#TotalFGValue').val(obj.Result[0].TotalFGValue);
								$('#TotalConsValue').val(obj.Result[0].TotalConsValue);
								$('#TotalToolsValue').val(obj.Result[0].TotalToolsValue);
								$('#TotalOthersValue').val(obj.Result[0].TotalOthersValue);

								var TotalStock = parseInt($('.TotalStockValue').text());

								var dataMap = {
								  RM: $('#TotalRMValue').val(),
								  FG: $('#TotalFGValue').val(),
								  Cons: $('#TotalConsValue').val(),
								  Tools: $('#TotalToolsValue').val(),
								  Others: $('#TotalOthersValue').val()
								};

								var xValues = Object.entries(dataMap).map(([key, val]) => {
								  var percent = ((val / TotalStock) * 100).toFixed(0);  // Round to whole number
								  return `${key} - ${percent}%`;
								});
								var yValues = Object.values(dataMap);
								var barColors = [
									"#f28ea3",
									"#6a92cc",
									"#f3ddd8",
									"#4da97b",
									"#ffbb4d"
								];

								new Chart("valuationByCategoryChart", {
								  type: "pie",
								  data: {
									labels: xValues,
									datasets: [{
									  backgroundColor: barColors,
									  hoverBackgroundColor: barColors,
									  data: yValues
									}]
								  },
								  options: {
									title: {
									  display: true,
									  text: "Valuation by Category"
									}
								  }
								});
							}
						},
						error: function (xhr, status, error) {
							alert('Failed to load ledger names.');
						}
					});
		}

		function FillInventoryDashboardForPendingData(){
			$.ajax({
						url: '@Url.Action("FillInventoryDashboardForPendingData", "Home")',
						type: 'POST',
						async: false,
						data: {},
						success: function (response, status, error) {

							var obj = $.parseJSON(response);
							if (obj.StatusCode == 200 && obj.StatusText === 'Success'){
								$('#PendRequisitionWithoutBOM').text(obj.Result[0].PendRequisitionWithoutBOM);
								$('#PendingReqAgainstBOM').text(obj.Result[0].PendingReqAgainstBOM);
								$('#PendingAgainstPlan').text(obj.Result[0].PendingAgainstPlan);
								$('#PendingGateEntryForMRN').text(obj.Result[0].PendingGateEntryForMRN);
								$('#PendingMRNForQc').text(obj.Result[0].PendingMRNForQc);
								$('#PendingGateEntryForJWMrn').text(obj.Result[0].PendingGateEntryForJWMrn);
								$('#PendingToReceiveItemInStore').text(obj.Result[0].PendingToReceiveItemInStore);
							}
						},
						error: function (xhr, status, error) {
							alert('Failed to load ledger names.');
						}
					});
		}

		function FillInventoryByCategory(){
			$.ajax({
						url: '@Url.Action("FillInventoryByCategory", "Home")',
						type: 'POST',
						async: false,
						data: {},
						success: function (response, status, error) {

							var obj = $.parseJSON(response);
							if (obj.StatusCode == 200 && obj.StatusText === 'Success'){
								var result = obj.Result;
								var xValues = result.map(x => x.ItemCategory);
								var yValues = result.map(x => x.CategoryStock);

								var barColors = ["#f28ea3", "#66d9d0", "#7fa6d9", "#f4dcd6", "#6fcf97", "#fbd490"];

								new Chart("inventoryByCategoryChart", {
										type: "bar",
										data: {
											labels: xValues,
											datasets: [{
												backgroundColor: barColors,
												hoverBackgroundColor: barColors,
												data: yValues,
												barThickness: 25, // Force specific bar width (px)
											}]
										},
										options: {
											maintainAspectRatio: false, // Allow custom height/width
											plugins: {
												legend: {
													display: false
												},
												title: {
													display: true,
													text: "Inventory By Category"
												}
											},
											scales: {
												x: {
													categoryPercentage: 0.5, // Reduce spacing between bars
													barPercentage: 1.0,      // Use full width inside category
													ticks: {
														autoSkip: false,
														maxRotation: 30,
														minRotation: 30
													}
												},
												y: {
													beginAtZero: true
												}
											}
										}
									});
							}
						},
						error: function (xhr, status, error) {
							alert('Failed to load ledger names.');
						}
					});
		}

		function GetTopItemByStockValue(){

			$.ajax({
						url: '@Url.Action("GetTopItemByStockValue", "Home")',
						type: 'POST',
						async: false,
						success: function (data, status, error) {
							var obj = $.parseJSON(data);
							var html = '';
							$.each(obj.Result, function (i, item) {
								html += '<tr onclick="handleRowClick(\'' + item.Itemcode + '\')" style="cursor:pointer;">';
								html += '<td><input type="hidden" value="' + item.Itemcode +'">' + item.PartCode + '</td>';
								html += '<td>' + item.ItemName + '</td>';
								html += '<td>' + item.Stock + '</td>';
								html += '<td>' + item.StockValue + '</td>';
								html += '</tr>';
							});
							$('#TopItemByStockValue').empty().append(html);
						},
						error: function (xhr, status, error) {
							alert('Failed to load ledger names.');
						}
					});
		}

		function GetTopItemBelowMinLevel(){

			$.ajax({
						url: '@Url.Action("GetTopItemBelowMinLevel", "Home")',
						type: 'POST',
						async: false,
						success: function (data, status, error) {
							var obj = $.parseJSON(data);
							var html = '';
							$.each(obj.Result, function (i, item) {
								html += '<tr onclick="handleRowClickMinValue(\'' + item.PartCode + '\')" style="cursor:pointer;">';
								html += '<td><input type="hidden" value="' + item.Itemcode +'">' + item.PartCode + '</td>';
								html += '<td>' + item.ItemName + '</td>';
								html += '<td>' + item.Stock + '</td>';
								html += '</tr>';
							});
							$('#TopItemBelowMinLevel').empty().append(html);
						},
						error: function (xhr, status, error) {
							alert('Failed to load ledger names.');
						}
					});
		}

		function GetTopFastMovingItem(){

			$.ajax({
						url: '@Url.Action("GetTopFastMovingItem", "Home")',
						type: 'POST',
						async: false,
						success: function (data, status, error) {
							var obj = $.parseJSON(data);
							var html = '';
							$.each(obj.Result, function (i, item) {
								html += '<tr onclick="handleRowClickMinValue(\'' + item.PartCode + '\')" style="cursor:pointer;">';
								html += '<td><input type="hidden" value="' + item.Itemcode +'">' + item.PartCode + '</td>';
								html += '<td>' + item.ItemName + '</td>';
								html += '<td>' + item.IssQty + '</td>';
								html += '<td>' + item.NoOfTransaction + '</td>';
								html += '</tr>';
							});
							$('#TopFastMovingItem').empty().append(html);
						},
						error: function (xhr, status, error) {
							alert('Failed to load ledger names.');
						}
					});
		}

		function handleRowClick(ItemCode){
			localStorage.setItem('SelectedItemCode', ItemCode);
			var url = '/StockValuation/Index';
			window.location.href = url;
		}

		function handleRowClickMinValue(PartCode){
			localStorage.setItem('SelectedMinItemCode', PartCode);
			var url = '/MinimumMaximaumLevel/Index';
			window.location.href = url;
		}
		// Inventory Dashboard Charts

		new Chart("fastSlowChart", {
		  type: "doughnut",
		  data: {
			labels: ["Fast Movers", "Slow Movers"],
			datasets: [{
			  backgroundColor: ["#1abc9c", "#e67e22"],
			  data: [70, 30]
			}]
		  }
		});

		// new Chart("movementChart", {
		//   type: "line",
		//   data: {
		// 	labels: ["Day 1", "Day 5", "Day 10", "Day 15", "Day 20", "Day 25", "Day 30"],
		// 	datasets: [
		// 	  { label: "Raw Materials", borderColor: "#3498db", fill: false, data: [100, 120, 140, 160, 180, 200, 220] },
		// 	  { label: "Finished Goods", borderColor: "#2ecc71", fill: false, data: [80, 100, 110, 130, 160, 180, 210] }
		// 	]
		//   },
		//   options: { legend: { display: true }, scales: { y: { beginAtZero: true } } }
		// });

		// Supply Chain Dashboard Charts
		new Chart("perfectOrdersChart", {
		  type: "doughnut",
		  data: {
			labels: ["Perfect", "Others"],
			datasets: [{
			  data: [90.1, 9.9],
			  backgroundColor: ["#2ecc71", "#ecf0f1"]
			}]
		  },
		  options: {
			cutout: '70%',
			plugins: { legend: { display: false } }
		  }
		});

		new Chart("warehouseBarChart", {
		  type: "bar",
		  data: {
			labels: ["California", "Texas", "Kansas", "New Jersey"],
			datasets: [{
			  label: "Perfect Orders",
			  data: [30, 25, 15, 10],
			  backgroundColor: "#3498db"
			}]
		  },
		  options: { scales: { y: { beginAtZero: true } } }
		});

		new Chart("returnByProdChart", {
		  type: "bar",
		  data: {
			labels: ["Type A", "Type B", "Type C", "Type D"],
			datasets: [
			  { label: "US", data: [10, 14, 8, 6], backgroundColor: "#e74c3c" },
			  { label: "Canada", data: [6, 9, 5, 4], backgroundColor: "#2ecc71" },
			  { label: "Germany", data: [4, 7, 3, 2], backgroundColor: "#f1c40f" }
			]
		  },
		  options: {
			plugins: { legend: { position: 'bottom' } },
			scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true } }
		  }
		});

		new Chart("returnTrendChart", {
		  type: "line",
		  data: {
			labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
			datasets: [
			  {
				label: "Return Volume",
				data: [20000, 25000, 30000, 28000, 31000, 34000],
				borderColor: "#e67e22",
				fill: false,
				tension: 0.3
			  }
			]
		  },
		  options: { scales: { y: { beginAtZero: true } } }
		});

		function RefreshAllInventory(){
			FillNoOfItemInStock();
			StockValuation();
			PendingInventoryTask();
		}

		function FillNoOfItemInStock(){
			$.ajax({
						url: '@Url.Action("NoOfItemInStock", "XONDashboard")',
						type: 'POST',
						async: false,
						data: {},
						success: function (response, status, error) {

							var obj = $.parseJSON(response);
							if (obj.StatusCode == 200 && obj.StatusText === 'Success'){
								$.notify('Successfully Refresh No Of item In Stock...!', { position: "top center", className: "success" });
							}
						},
						error: function (xhr, status, error) {
							alert('Failed to save data.');
						}
					});
		}

		function StockValuation(){
			$.ajax({
						url: '@Url.Action("StockValuation", "XONDashboard")',
						type: 'POST',
						async: false,
						data: {},
						success: function (response, status, error) {

							var obj = $.parseJSON(response);
							if (obj.StatusCode == 200 && obj.StatusText === 'Success'){
								$.notify('Successfully Calculate Stock Valuation...!', { position: "top center", className: "success" });
							}
						},
						error: function (xhr, status, error) {
							alert('Failed to save data.');
						}
					});
		}

		function PendingInventoryTask(){
			$.ajax({
						url: '@Url.Action("PendingInventoryTask", "XONDashboard")',
						type: 'POST',
						async: false,
						data: {},
						success: function (response, status, error) {

							var obj = $.parseJSON(response);
							if (obj.StatusCode == 200 && obj.StatusText === 'Success'){
								$.notify('Successfully Added Pending Job List...!', { position: "top center", className: "success" });
							}
						},
						error: function (xhr, status, error) {
							alert('Failed to save data.');
						}
					});
		}

	</script>
}