@model eTactWeb.DOM.Models.PendingSaleBillList

@{
    ViewData["Title"] = "SaleBillList ";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<style>

    .select2-container--default .select2-selection--single {
        background-color: #e0f2f1;
        border: 1.5px solid #0a0a0a !important;
        border-radius: 4px;
    }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            /* border-bottom: 1.5px solid #000 !important; */
            border-bottom: none !important;
        }

    .select2-container--default .select2-results > .select2-results__options {
        background-color: #e0f2f1; /* Dropdown background color */
        color: #000;
    }

    .no-cursor {
        pointer-events: none; /* Prevent clicking/typing */
        caret-color: transparent; /* Hide blinking cursor */
        background-color: white; /* Keep normal background */
        color: black; /* Keep normal text color */
        border: none; /* Remove border for clean look */
    }

    .tooltip-container {
        position: relative;
        display: inline-block;
    }

        .tooltip-container .tooltip-text {
            visibility: hidden;
            background-color: black;
            color: #fff;
            text-align: center;
            padding: 3px 8px;
            border-radius: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* above the input */
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
</style>
<div class="shadow-lg">
    <div class="card rounded border-light bg-gradient">
        <div class="card-header card-headerBG text-light bg-gradient">
            <h5>
                Pending Sall Bill
                <span class="d-flex float-end" style="margin-top:-2px;">
                    @*<a asp-action="ReqWithoutBom" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">
                    <i class="fa fa-plus-circle fafw fa-lg" aria-hidden="true"></i>
                    Add New
                    </a>*@
                    <a asp-action="SBDashboard" asp-route-ID="0" class="btn btn-secondary btn-sm" asp-controller="SaleInvoice">
                        <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>
                        Dashboard
                    </a>
                </span>
            </h5>
        </div>
        <div class="card-body">
            <div class="card overflow-auto">
                <div class="card-body">
                    <form id="SParam">
                        <div class="row">

                            <div class="col-sm-3 col-md-6 col-lg-2 col-xl-2">
                                <div class="row">
                                    <div class="col">
                                        <label class="form-label">From Date</label>
                                        <input type="hidden" value="@Model.FromDate" id="finFromDate" />
                                        <input type="hidden" value="@Model.ToDate" id="finToDate" />
                                        <input type="hidden"  id="Companytype" />
                                        <input asp-for="FromDate" maxlength="10" class="form-control" value="@Model.FromDate"  />
                                    </div>
                                    <div class="col">
                                        <label class="form-label">To Date</label>
                                        <input asp-for="ToDate" maxlength="10" class="form-control" value="@Model.ToDate" />
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-3 col-md-6 col-lg-2 col-xl-2">
                                <div class="row">
                                    <div class="col">
                                        <label class="form-label">InvoiceDate</label>
                                        
                                        <input asp-for="InvoiceDate" maxlength="10" class="form-control" value="@Model.InvoiceDate"  />
                                    </div>
                                    <div class="col">
                                        <label class="form-label">CurrentYear</label>
                                        <input asp-for="CurrentYear" maxlength="10" class="form-control" value="@Model.CurrentYear" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                <label asp-for="BillFromStoreId" class="control-label" style="color: red;"> BillFromStore </label>
                                <select class="form-select" asp-for="BillFromStoreId">
                                    <option value="">-Select-</option>
                                </select>

                            </div>
                             <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                <label asp-for="accountCode" class="control-label" style="color: red;"> CustomerName </label>
                                <select class="form-select" asp-for="accountCode" >
                                    <option value="">-Select-</option>
                                </select>

                            </div>
                            <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                <label asp-for="SONo" class="control-label" style="color: red;"> SONo </label>
                                <select class="form-select" asp-for="SONo">
                                    <option value="">-Select-</option>
                                </select>

                            </div>
                            <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                <label asp-for="PartCode" class="control-label" style="color: red;"> PartCode </label>
                                <select class="form-select" asp-for="PartCode">
                                    <option value="">-Select-</option>
                                </select>

                            </div>
                            
                            
                            
                            <div class="col-sm-2 col-md-6 col-lg-4 col-xl-2">
                                <label class="form-label">Global search</label>
                                <input type="text" class="form-control" id="search-box" style="background-color:#FFFACD" placeholder="Search...">
                            </div>
                            <div class="col-sm-3 col-md-6 col-lg-2 col-xl-4 d-flex justify-content-end mt-3">
                                <button class="btn btn-sm btn-outline-primary" type="button" onclick="showDetail();" style="padding:3px;height:30px;width:100px;margin-left:20px;">
                                    <i class="fa-solid fa-magnifying-glass fa-fw fa-lg "></i>SHOW
                                </button>
                              
                                <a class="btn btn-sm btn-outline-danger" asp-controller="SaleInvoice" asp-action="SaleBillList" style="padding:3px;height:30px;width:100px;margin-left:20px;">
                                    <i class="fa-solid fa-rotate fa-fw fa-lg"></i>RESET
                                </a>
                            </div>
                            <div class="col-sm-2 col-md-6 col-lg-4 col-xl-2">
                                <button class="btn btn-sm btn-outline-primary" style="margin-top:15px;height:30px;width:150px;margin-left:20px;" type="button" onclick="getCheckedRowData()">
                                    <i class="fa fa-check-circle" aria-hidden="true"></i> Generate Sale Bill
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="progress my-3 mb-3" style="height: 4px;">
            <div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
        </div> <div class="card">
            <div class="card-body overflow-auto pb-0">
                <div class="table-responsive" style="max-height:350px;">
                    <table class="table table-hover table-bordered table-striped" id="GateDataTable" style="table-layout: fixed;">
                        <thead class="bg-gradient card-headerBG text-light small" style="white-space:nowrap">
                            <tr>
                                <th style="width:70px;">Action <input id="checkuncheck" class="form-check-input me-1 mt-2" type="checkbox" role="switch" /></th>
                                
                                <th style="width:70px;">SO No</th>
                              

                                <th style="width:150px;">Part Code</th>
                                <th style="width:250px;">Item Name</th>

                                <th style="width:70px;">Order Qty</th>
                                <th style="width:70px;">Pending Qty</th>
                                <th style="width:70px;">Bill Qty</th>
                                <th style="width:70px;">Rate</th>
                                <th style="width:70px;">Unit</th>
                                <th style="width:70px;">Location</th>
                                <th style="width:70px;">SOYear </th>
                                <th style="width:90px;">Order No</th>
                                <th style="width:70px;">Sch No</th>
                                <th style="width:70px;">Sch Year </th>
                                <th style="width:70px;">SO Type</th>
                                <th style="width:70px;">SO For</th>
                              
                                <th style="width:70px;">HSN No</th>
                                <th style="width:80px;">TotalStock</th>
                                <th style="width:150px;">Batch No</th>
                                <th style="width:150px;">Unique Batch No</th>
                                <th style="width:70px;">Batch Stock</th>
                                <th style="width:100px;">Disc %</th>
                                <th style="width:120px;">Disc Amount</th>
                                <th style="width:120px;">Item Amount</th>
                                <th style="width:100px;">AltQty</th>
                                <th style="width:100px;">StoreId</th>
                                <th style="width:150px;">StoreName</th>
                                <th style="width:200px;">Customer Name</th>
                                <th style="width:120px;">Account Code</th>
                                <th style="width:120px;">Item Code</th>


                            </tr>
                        </thead>
                        <tbody id="divPendMRNGrid">
                            <tr class="text-center">
                                <td colspan="25" class="text-black-50"><strong>NO DATA YET</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <center><strong>TOTAL ROWS : <span id="totalRows"></span></strong></center>
        </div>
    </div>
</div>

@section Scripts
{
    <script>
        $(function () {
            var fromDate;
            var toDate;

            var today = new Date();
            var threeMonthsAgo = new Date(today.getTime() - (3 * 30 * 24 * 60 * 60 * 1000));
            var finFromDate = $('#finFromDate').val();
            var finToDate = $('#finToDate').val();
            var dateParts1 = finFromDate.split("/");
            var monthNames = {
                "Jan": "01",
                "Feb": "02",
                "Mar": "03",
                "Apr": "04",
                "May": "05",
                "Jun": "06",
                "Jul": "07",
                "Aug": "08",
                "Sep": "09",
                "Oct": "10",
                "Nov": "11",
                "Dec": "12"
            };
            var formattedDate1 = dateParts1[0] + "/" + monthNames[dateParts1[1]] + "/" + dateParts1[2];
            var dateParts2 = finToDate.split("/");
            var formattedDate2 = dateParts2[0] + "/" + monthNames[dateParts2[1]] + "/" + dateParts2[2];
            $("#FromDate").datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", formattedDate1);
            $('#ToDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", formattedDate2);

            $('#BillFromStoreId').select2();
            $('#accountCode').select2();
            $('#SONo').select2();
            $('#PartCode').select2();

            GetCompanyType();
            GetServerDate();
            FillStoreList();
            FillCustomerList();
            FILLPendingSONO();
            FillPendingPartCOde(); 
            
            
        });


        function GetCompanyType() {

           
            $.ajax({
                type: "POST",

                url: "@Url.Action("GetCompanyType")",
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.Result != null) {
                            $('#Companytype').val('');
                            $('#Companytype').val(obj.Result.Table[0].RetailerOrManufacturar);
                           

                        }
                    }
                }
            });
        }


        $(document).on('mouseover', 'input[type="text"]', function () {
            $(this).attr('title', $(this).val());
        });


        function GetServerDate() {
            $.ajax({
                type: "GET",
                url: "@Url.Action("GetServerDate", "Routing")",
                async: false,
                success: function (result, status, error) {

                    $('#InvoiceDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", (result));



                }
            });
        }

        function FillStoreList() {

            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStoreList")",
                dataType: "json",
                async: false,

                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#BillFromStoreId').empty();
                            $('#BillFromStoreId').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#BillFromStoreId').append('<option value="' + val.Storeid + '">' + val.store_Name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var BillFromStoreId = "@Model.BillFromStoreId";
                                $('#BillFromStoreId').val(BillFromStoreId).trigger("change");
                            }
                        }
                    }
                }
            });
        }
        function FillCustomerList() {

            $.ajax({
                type: "POST",
                url: "@Url.Action("FillCustomerListForPending")",
                dataType: "json",
                async: false,

                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#accountCode').empty();
                            $('#accountCode').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#accountCode').append('<option value="' + val.account_code + '">' + val.account_name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var accountCode = "@Model.accountCode";
                                $('#accountCode').val(accountCode).trigger("change");
                            }
                        }
                    }
                }
            });
        }


        function FILLPendingSONO() {
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("FILLPendingSONO")",
                dataType: "json",
               
              
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#SONo').empty();
                            $('#SONo').append('<option value=""  selected>-Select-</option>');

                            $.each(obj.Result.Table, function (index, val) {
                                $('#SONo').append('<option value="' + val.SONO + '">' + val.SONO + '</option>');
                            });
                           
                        }
                    }
                }
            });
        }

        function FillPendingPartCOde() {
           
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillPendingPartCOde")",
                dataType: "json",
               
               

                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#PartCode').empty();
                            $('#PartCode').append('<option value=""  selected>-Select-</option>');

                            $.each(obj.Result.Table, function (index, val) {
                                $('#PartCode').append('<option value="' + val.partcode + '">' + val.partcode + '</option>');
                            });

                        }
                    }
                }
            });
        }

        $('#FromDate, #ToDate,#BillFromStoreId,#accountCode,#SONo,#PartCode').change(function () {
            $('#divPendMRNGrid').empty();
        });

        function showDetail() {

            var data = {
                "Flag": "ShowPendingSaleorderforBill",
                "FromDate": $('#FromDate').val(),
                "Todate": $('#ToDate').val(),
                "InvoiceDate": $('#InvoiceDate').val(),
                "CurrentYear": $('#CurrentYear').val(),
                "BillFromStoreId": $('#BillFromStoreId').val(),
                "accountCode": $('#accountCode').val(),
                "SONo": $('#SONo').val(),
                "PartCode": $('#PartCode').val(),
                "CompanyType": $('#Companytype').val()
                
            }

            $.ajax({
                url: '@Url.Action("ShowPendingSaleorderforBill")',
                type: "POST",
                data: data,
                success: function (data) {
                    if (data != null) {

                        var obj = $.parseJSON(data);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#divPendMRNGrid').empty();
                            var i = 1;
                            $.each(obj.Result.Table, function (index, val) {

                                var html = '';
                                html += '<tr>' +
                                    '<td style="text-align:center;">' +
                                    '<input style="background-color: #b2b3f0;" id="AcceptedQtySHA' + i + '" ' +
                                    'class="form-check-input me-1 mt-2" type="checkbox" role="switch" ' +
                                    'onchange="CheckacceptedQtySHA(' + i + ');" />' +
                                    '</td>' +

                                    '<td><input id="SONo' + i + '" class="form-control no-cursor" value="' + val.SONo + '"/></td>' +
                                   
                                    '<td><input id="PartCode' + i + '" class="form-control no-cursor" value="' + val.PartCode + '"/></td>' +
                                    '<td><input id="ItemName' + i + '" class="form-control no-cursor" value="' + val.ItemName + '"/></td>' +
                                    '<td><input id="OrderQty' + i + '" class="form-control no-cursor" value="' + val.OrderQty + '"/></td>' +
                                    '<td><input id="OrderPendQty' + i + '" class="form-control no-cursor" value="' + val.OrderPendQty + '"/></td>' +
                                    '<td><input id="SaleBillQty' + i + '" class="form-control no-cursor" value="' + val.SaleBillQty + '"/></td>' +
                                    '<td><input id="SOItemRate' + i + '" class="form-control no-cursor" value="' + val.SOItemRate + '"/></td>' +
                                    '<td><input id="Unit' + i + '" class="form-control no-cursor" value="' + val.Unit + '"/></td>' +
                                    '<td><input id="RackID' + i + '" class="form-control no-cursor" value="' + val.RackID + '"/></td>' +
                                    '<td><input id="SOYearCode' + i + '" class="form-control no-cursor" value="' + val.SOYearCode + '"/></td>' +
                                    '<td><input id="CustorderNo' + i + '" class="form-control no-cursor" value="' + val.CustorderNo + '"/></td>' +
                                    '<td><input id="SchNo' + i + '" class="form-control no-cursor" value="' + val.SchNo + '"/></td>' +
                                    '<td><input id="SchYearCode' + i + '" class="form-control no-cursor" value="' + val.SchYearCode + '"/></td>' +
                                    '<td><input id="SOType' + i + '" class="form-control no-cursor" value="' + val.SOType + '"/></td>' +
                                    '<td><input id="SOFor' + i + '" class="form-control no-cursor" value="' + val.SOFor + '"/></td>' +
                                   
                                    '<td><input id="HSNNO' + i + '" class="form-control no-cursor" value="' + val.HSNNO + '"/></td>' +
                                    '<td><input id="TotalStock' + i + '" class="form-control no-cursor" value="' + val.TotalStock + '"/></td>' +
                                    '<td><input id="BatchNo' + i + '" class="form-control no-cursor" value="' + val.BatchNo + '"/></td>' +
                                    '<td><input id="UniqueBatchNo' + i + '" class="form-control no-cursor" value="' + val.UniqueBatchNo + '"/></td>' +
                                    '<td><input id="BatchStock' + i + '" class="form-control no-cursor" value="' + val.BatchStock + '"/></td>' +
                                    '<td><input id="DisPer' + i + '" class="form-control no-cursor" value="' + val.DisPer + '"/></td>' +
                                    '<td><input id="DisAmt' + i + '" class="form-control no-cursor" value="' + val.DisAmt + '"/></td>' +
                                    '<td><input id="ItemAmount' + i + '" class="form-control no-cursor" value="' + val.ItemAmount + '"/></td>' +
                                    '<td><input id="AltQty' + i + '" class="form-control no-cursor" value="' + val.AltQty + '"/></td>' +
                                    '<td><input id="Storeid' + i + '" class="form-control no-cursor" value="' + val.Storeid + '"/></td>' +
                                    '<td><input id="Store_Name' + i + '" class="form-control no-cursor" value="' + val.Store_Name + '"/></td>' +
                                    '<td><input id="CustomerName' + i + '" class="form-control no-cursor" value="' + val.CustomerName + '"/></td>' +
                                    '<td><input id="Accountcode' + i + '" class="form-control no-cursor" value="' + val.Accountcode + '"/></td>' +
                                    '<td><input id="ItemCode' + i + '" type="hidden" value="' + val.ItemCode + '"/>' +
                                    '<input class="form-control no-cursor" value="' + val.ItemCode + '"/></td>' +
                                    '</tr>';

                                $('#divPendMRNGrid').append(html);
                                $('#TransertoMIRBtn').prop("disabled", false);

                                var count = $('#divPendMRNGrid tr').length;
                                $('#totalRows').text(count);
                                i++;
                            });

                        }
                        else {
                            $('#divPendMRNGrid').empty();
                            var count = $('#divPendMRNGrid tr').length;
                            $('#totalRows').text(count);
                            $('#divPendMRNGrid').append('<tr class="text-center"><td colspan="26" class="text-black-50"><strong>NO DATA FOUND</strong></td></tr>')

                        }
                    }
                },
                error: function (response) {
                    alert(response.responseText);
                },
                failure: function (response) {
                    alert(response.responseText);
                }
            });
        }
        function getCheckedRowData() {
            var selectedData = [];

            $('#GateDataTable tbody tr').each(function (rowIndex) {
                var $row = $(this);
                var checkbox = $row.find('input[type="checkbox"]');

                if (checkbox.is(':checked')) {
                    var i = rowIndex + 1;
                    var rowData = {

                        AccountName: $("#CustomerName" + i).val(),   // we created CustomerNameX
                        AccountCode: $("#Accountcode" + i).val(),
                        SONO: $("#SONo" + i).val(),
                        SOYearCode: $("#SOYearCode" + i).val(),
                        CustOrderNo: $("#CustorderNo" + i).val(),
                        SchNo: $("#SchNo" + i).val(),
                        SaleSchYearCode: $("#SchYearCode" + i).val(),
                        ItemCode: $("#ItemCode" + i).val(),
                        PartCode: $("#PartCode" + i).val(),
                        ItemName: $("#ItemName" + i).val(),
                        Unit: $("#Unit" + i).val(),
                        HSNNo: $("#HSNNO" + i).val(),
                        Qty: $("#SaleBillQty" + i).val(),
                        SOPendQty: $("#OrderPendQty" + i).val(),
                        Rate: $("#SOItemRate" + i).val(),
                        SOType: $("#SOType" + i).val(),
                        Batchno: $("#BatchNo" + i).val(),
                        Uniquebatchno: $("#UniqueBatchNo" + i).val(),
                        DiscountPer: $("#DisPer" + i).val(),
                        DiscountAmt: $("#DisAmt" + i).val(),
                        Amount: $("#ItemAmount" + i).val(),
                        AltQty: $("#AltQty" + i).val(),
                        StoreId: $("#Storeid" + i).val(),
                        StoreName: $("#Store_Name" + i).val(),
                        RackID: $("#RackID" + i).val()


                    };
                    selectedData.push(rowData);
                }
            });
            if (selectedData.length === 0) {
                notify("Please check at least one checkbox before proceeding.","error");
                return;
            }

            // AJAX call to send to session
            $.ajax({
                url: "@Url.Action("StoreCheckedRowsToSession")",
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(selectedData),
                success: function (response) {
                    var redirectUrl = '';
                    if ($('#Companytype').val() == 'Retailer') {
                        redirectUrl = '@Url.Action("SaleBillOnCounter", "SaleInvoice")';
                    }
                    else {
                        redirectUrl = '@Url.Action("SaleInvoice", "SaleInvoice")';
                    }
                    
                    window.location.href = redirectUrl;
                },
                error: function (xhr, status, error) {
                    console.error("Failed to store in session:", error);
                }
            });
        }

        function CheckacceptedQtySHA(i) {

            var checkedtruevalues = [];
            var rowCount = $('#divPendMRNGrid tr').length;
            for (let i = 1; i <= rowCount; i++) {
                checkedtruevalues.push({
                    "checked": $('#AcceptedQtySHA' + i).is(':checked')
                })
            }

            var checkedonlytrue = checkedtruevalues.filter(function (item) {
                return item.checked;
            }).length;
            if (rowCount == checkedonlytrue) {
                $('#checkuncheck').prop('checked', true)
            } else {
                $('#checkuncheck').prop('checked', false)
            }
        }

        $('#checkuncheck').change(function () {

            var rowCount = $('#divPendMRNGrid tr').length;
            if ($('#checkuncheck').is(':checked') == true) {
                for (let i = 1; i <= rowCount; i++) {
                    $('#AcceptedQtySHA' + i).prop('checked', true)
                }
            }
            else {
                for (let i = 1; i <= rowCount; i++) {
                    $('#AcceptedQtySHA' + i).prop('checked', false)
                }
            }
        })

        

        $(document).on("click", ".sortCol", function () {
            var $column = $(this).parent().closest("th");
            var colno = $(this).data('columnno');
            var currentOrder = $(this).data('sortorder');

            $('.sortCol').css('color', 'white');
            if (currentOrder === 'asc') {
                sortTable('divPendMRNGrid', colno, false);
                $(this).data('sortorder', 'desc');
                $(this).css('color', 'yellow');
                //$(this).css('font-size', 'larger');
                $(this).find('i:first').removeClass('fa-arrow-up');
                $(this).find('i:first').addClass('fa-arrow-down');
            } else {
                sortTable('divPendMRNGrid', colno, true);
                $(this).data('sortorder', 'asc');
                $(this).css('color', 'yellow');
                // $(this).css('font-size', 'larger');
                $(this).find('i:first').removeClass('fa-arrow-down');
                $(this).find('i:first').addClass('fa-arrow-up');
            }
        });

        var currentSearchColumn = null;

        $("#search-box").on("keyup", function () {

            var value = $(this).val().toLowerCase();
            $("#divPendMRNGrid tr").filter(function () {
                if (currentSearchColumn !== null) {
                    var columnText = $(this).find('td').eq(currentSearchColumn).text().toLowerCase();
                    $(this).toggle(columnText.indexOf(value) > -1);
                } else {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
                }
            });
        });


        $(document).on("click", "th[data-columnno]", function () {
            currentSearchColumn = $(this).data('columnno');
            $("#search-box").val('').trigger('keyup'); // Reset search box and trigger the search
        });

    </script>
}