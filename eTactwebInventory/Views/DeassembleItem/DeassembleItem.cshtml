@model eTactWeb.DOM.Models.DeassembleItemModel

@{
    ViewData["Title"] = "Deassemble Item";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<style>
    .disabled-link {
        pointer-events: none; /* Disables clicking */
        color: gray; /* Makes it look disabled */
        text-decoration: none; /* Removes underline */
        cursor: not-allowed; /* Changes cursor */
    }

    .custom-input {
        width: 120%; /* Adjust the width as needed */
        max-width: 500px; /* Adjust the max-width as needed */
    }


    .select2-container--default .select2-selection--single {
        background-color: #e0f2f1;
        border: 1.5px solid #0a0a0a !important;
        border-radius: 4px;
    }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            /* border-bottom: 1.5px solid #000 !important; */
            border-bottom: none !important;
        }

    .select2-container--default .select2-results > .select2-results__options {
        background-color: #e0f2f1; /* Dropdown background color */
        color: #000;
</style>

<div class="card bg-gradient mb-3 border-light shadow-lg">
    <form asp-action="DeassembleItem" autocomplete="off" class="form-horizontal">
        <div class="card-header card-headerBG text-light bg-gradient">
            <h5>
                <strong>Deassemble Item</strong>
                <span class="d-flex float-end" style="margin-top:-2px;">
                    @*<a asp-action="Dashboard" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">*@
                    <a asp-action="DeassembleDashBoard" asp-route-ID="0" class="btn btn-secondary btn-sm DashBoard">
                        <i class="fa-duotone fa-grid-horizontal fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>
                        Dashboard
                    </a>
                    <div class="row justify-content-between g-2">
                        <div class="col-auto">
                            <input asp-for="FromDateBack" type="hidden" value="@Model.FromDateBack" />
                            <input asp-for="ToDateBack" type="hidden" value="@Model.ToDateBack" />
                            <input asp-for="SlipNoBack" type="hidden" value="@Model.SlipNoBack" />
                            <input asp-for="PartCodeBack" type="hidden" value="@Model.PartCodeBack" />
                            <input asp-for="ItemNameBack" type="hidden" value="@Model.ItemNameBack" />
                            <input asp-for="BatchNoback" type="hidden" value="@Model.BatchNoback" />
                            <input asp-for="GlobalSearchBack" type="hidden" value="@Model.GlobalSearchBack" />
                            <input asp-for="DashboardTypeBack" type="hidden" value="@Model.DashboardTypeBack" />
                            @*<a href="#" class="btn offer-listbtn hvr-sweep-to-right btn-sm btn-secondary" onclick="back();">*@
                            <a href="#" class=" btn btn-primary btn-sm" onclick="PressBack();">
                                <i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>
                                BACK
                            </a>
                        </div>
                        @if (Model.Mode != "V" && Model.Mode != "SOC" && Model.Mode != "POC")
                        {
                            <div class="col-auto">
                                @*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
                                <a class="btn btn-secondary btn-sm" onclick="location.href=$('form')[0].action">
                                    @* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
                                    <i class="fa fa-refresh fa-fw fa-lg" aria-hidden="true"></i>
                                    REFRESH
                                </a>
                            </div>
                            @if (Model.Mode == "U")
                            {
                                @*Model.Mode = "U";*@
                                <div class="col-auto">
                                    @* <button type="submit" class="btn btn-sm btn-outline-warning">*@
                                    <button type="submit" class="btn btn-sm btn-outline-light bg-gradient" id="UpdateButton">
                                        <i class="fa fa-pencil-square fa-fw fa-lg" aria-hidden="true"></i>
                                        UPDATE
                                    </button>
                                </div>
                            }

                            else
                            {
                                <div class="col-auto">
                                    @*   <button type="submit" class="btn btn-sm btn-outline-primary">*@
                                    <button type="submit" class="btn btn-primary btn-sm" id="submitBTN">
                                        <i class="fa-solid fa-chevron-circle-right"></i>
                                        SUBMIT
                                    </button>
                                </div>
                            }
                        }
                    </div>
                    @* <partial name="_FormsButton" />*@
                </span>
            </h5>
        </div>
        <div>
        </div>
        <div class="card-body bg-light pt-0">
            <div class="accordion shadow-lg">
                <div class="accordion-item" id="GI_Grid">
                    <h2 class="accordion-header" id="H_RParameter">
                        <button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_RParameter" aria-expanded="true" aria-controls="B_RParameter">
                            <i class="fa-brands fa-wpforms fa-lg fa-fw pr35"></i>
                            Required Parameter
                        </button>
                    </h2>
                    <div id="B_RParameter" class="accordion-collapse collapse show pnl1 bg-gradient" aria-labelledby="H_RParameter">
                        <div class="accordion-body">
                            <div class="row g-2 gx-3 align-items-center">
                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12" style="width = 50%">
                                    <input type="hidden" value="@Model.FinFromDate" asp-for="FinFromDate" />
                                    <input type="hidden" value="@Model.FinToDate" asp-for="FinToDate" />
                                    <input type="hidden" value="@Model.Mode" asp-for="Mode" />
                                    <input type="hidden" asp-for="SeqNo" id="hiddenSeqNo" />
                                    @* <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12"> *@
                                    @* class="col-xl-2 col-lg-3 col-md-3 col-sm-3 col-xs-12" *@
                                    <label asp-for="DeassEntryID" class="form-label" style="color: blue;">Entry ID</label>
                                    <input asp-for="DeassEntryID" class="form-control" readonly />
                                </div>
                                @* <div class="col-lg"> *@
                                <div class="col-xl-1 col-lg-4 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="DeassEntryDate" class="form-label" style="color: blue;">Entry Date</label>
                                    <input asp-for="DeassEntryDate" class="form-control" readonly />
                                </div>
                                <div class="col-xl-1 col-lg-4 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="DeassYearcode" class="form-label" style="color: blue;">Year Code</label>
                                    <input asp-for="DeassYearcode" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="DeassSlipNo" class="form-label" style="color: blue;">Slip No*</label>
                                    <input asp-for="DeassSlipNo" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>

                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <input type="hidden" asp-for="FinishItemCode" value="@Model.FinishItemCode" id="FinishItemCode" />

                                @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="FinishPartCode" class="form-label">FG PartCode</label>

                                        <input asp-for="FinishPartCode" value="@Model.FinishPartCode" class="form-control" readonly />

                                        <input type="hidden" id="GateEntry" />
                                    }
                                    else
                                    {
                                        <label asp-for="FinishItemCode" class="control-label" style="color: red;"> FG PartCode </label>


                                        <select class="form-select" asp-for="FinishPartCode">
                                            <option value="">-Select-</option>
                                        </select>
                                    }
                                </div>

                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12 ">
                                    @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="FinishItemName" class="form-label">FG ItemName</label>

                                        <input asp-for="FinishItemName" value="@Model.FinishItemName" class="form-control" readonly />

                                        
                                    }
                                    else
                                    {
                                        <label asp-for="FinishItemCode" class="control-label" style="color: red;"> FG ItemName</label>

                                        <select class="form-select" asp-for="FinishItemName">
                                            <option value="">-Select-</option>
                                        </select>
                                    }
                                </div>

                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="FGStoreId" class="form-label">FG StoreName</label>

                                        <input type="hidden" asp-for="FGStoreId" value="@Model.FGStoreId" class="form-control" readonly />
                                        <input  asp-for="FGStoreName" value="@Model.FGStoreName" class="form-control" readonly />



                                    }

                                    else
                                    {
                                        <label asp-for="FGStoreId" class="control-label" style="color: red;">Store Name</label>

                                        <select class="form-select" asp-for="FGStoreId">
                                            <option value="">-Select-</option>
                                        </select>
                                    }
                                </div>

                                <div class="col-xl-1 col-lg-4 col-md-3 col-sm-6 col-xs-12">
                                    @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="BomNo" class="form-label">BomNo</label>

                                        <input asp-for="BomNo" value="@Model.BomNo" class="form-control" readonly />



                                    }

                                    else
                                    {
                                        <label asp-for="BomNo" class="control-label" style="color: red;"> BomNo</label>

                                        <select class="form-select" asp-for="BomNo">
                                            <option value="">-Select-</option>
                                        </select>
                                    }
                                </div>


                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 ToWc">
                                @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="MaterialRecFrom" class="form-label">MaterialRecFrom</label>

                                        <input asp-for="MaterialRecFrom" value="@Model.MaterialRecFrom" class="form-control" readonly />



                                    }

                                    else
                                    {
                                        <label asp-for="MaterialRecFrom" class="control-label" style="color: red;"> MaterialRecFrom</label>

                                        <select class="form-select" asp-for="MaterialRecFrom">
                                            <option value="">-Select-</option>
                                            <option value="Production">Production</option>
                                            <option value="MRN">MRN</option>
                                            <option value="None">None</option>
                                        </select>
                                    }
                                </div>



                                @if (Model.Mode != "U" || Model.Mode != "V")
                                {
                                    <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12 MRN " style="display:none">
                                        <label asp-for="MRNO" class="control-label" style="color: red;"> MRNO</label>

                                        <select class="form-select" asp-for="MRNO">
                                            <option value="">-Select-</option>
                                        </select>
                                    </div>



                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 MRN " style="display:none">
                                        <label asp-for="MRNYearCode" class="control-label" style="color: red;"> MRNYearCode</label>

                                        <select class="form-select" asp-for="MRNYearCode">
                                            <option value="">-Select-</option>
                                        </select>
                                    </div>

                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 MRN" style="display:none">
                                        <label asp-for="MRNDate" class="form-label" style="color: blue;">MRNDate</label>
                                        <input asp-for="MRNDate" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>

                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 MRN" style="display:none">
                                        <label asp-for="MRNEntryID" class="form-label" style="color: blue;">MRNEntryID</label>
                                        <input asp-for="MRNEntryID" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>
                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                        <label asp-for="ProdSlipNO" class="form-label" style="color: blue;">ProdSlipNO</label>
                                        <input asp-for="ProdSlipNO" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>
                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                        <label asp-for="ProdDate" class="form-label" style="color: blue;">ProdDate</label>
                                        <input asp-for="ProdDate" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>
                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                        <label asp-for="ProdYearCode" class="form-label" style="color: blue;">ProdYearCode</label>
                                        <input asp-for="ProdYearCode" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>
                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                        <label asp-for="ProdYearCode" class="form-label" style="color: blue;">ProdYearCode</label>
                                        <input asp-for="ProdYearCode" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>

                                    <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                        <label asp-for="ProdEntryId" class="form-label" style="color: blue;">ProdEntryId</label>
                                        <input asp-for="ProdEntryId" class="form-control" readonly style="background-color: lightblue !important;" />
                                    </div>
                                }
                                else
                                {
                                    
                                        <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                        <label asp-for="MRNO" class="form-label">MRNO</label>

                                        <input asp-for="MRNO" value="@Model.MRNO" class="form-control" readonly />
                                        </div>
                                        <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                            <label asp-for="MRNYearCode" class="form-label">MRNYearCode</label>

                                            <input asp-for="MRNYearCode" value="@Model.MRNYearCode" class="form-control" readonly />
                                        </div>
                                        <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                            <label asp-for="MRNDate" class="form-label">MRNDate</label>

                                            <input asp-for="MRNDate" value="@Model.MRNDate" class="form-control" readonly />
                                        </div>
                                        <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                            <label asp-for="MRNEntryID" class="form-label">MRNEntryID</label>

                                            <input asp-for="MRNEntryID" value="@Model.MRNEntryID" class="form-control" readonly />
                                        </div>


                                    
                                        <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                            <label asp-for="ProdSlipNO" class="form-label" style="color: blue;">ProdSlipNO</label>
                                            <input asp-for="ProdSlipNO" class="form-control" readonly style="background-color: lightblue !important;" />
                                        </div>
                                        <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                            <label asp-for="ProdDate" class="form-label" style="color: blue;">ProdDate</label>
                                            <input asp-for="ProdDate" class="form-control" readonly style="background-color: lightblue !important;" />
                                        </div>
                                        <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                            <label asp-for="ProdYearCode" class="form-label" style="color: blue;">ProdYearCode</label>
                                            <input asp-for="ProdYearCode" class="form-control" readonly style="background-color: lightblue !important;" />
                                        </div>
                                        <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                            <label asp-for="ProdYearCode" class="form-label" style="color: blue;">ProdYearCode</label>
                                            <input asp-for="ProdYearCode" class="form-control" readonly style="background-color: lightblue !important;" />
                                        </div>

                                        <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12 Production" style="display:none">
                                            <label asp-for="ProdEntryId" class="form-label" style="color: blue;">ProdEntryId</label>
                                            <input asp-for="ProdEntryId" class="form-control" readonly style="background-color: lightblue !important;" />
                                        </div>


                                    
                                }

                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12 ">
                                @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="FGBatchNo" class="form-label">FGBatchNo</label>

                                        <input asp-for="FGBatchNo" value="@Model.FGBatchNo" class="form-control" readonly />



                                    }
                                    else
                                    {
                                        <label asp-for="FGBatchNo" class="control-label" style="color: red;"> FGBatchNo</label>

                                        <select class="form-select" asp-for="FGBatchNo">
                                            <option value="">-Select-</option>
                                        </select>
                                    }
                                </div>

                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12 ">
                                @if (Model.Mode == "U" || Model.Mode == "V")
                                    {
                                        <label asp-for="FGUniqueBatchNo" class="form-label">FGUniqueBatchNo</label>

                                        <input asp-for="FGUniqueBatchNo" value="@Model.FGUniqueBatchNo" class="form-control" readonly />



                                    }
                                    else
                                    {
                                        <label asp-for="FGUniqueBatchNo" class="control-label" style="color: red;"> FGUniqueBatchNo</label>

                                        <select class="form-select" asp-for="FGUniqueBatchNo">
                                            <option value="">-Select-</option>
                                        </select>
                                    }
                                </div>

                                <div class="col-xl-1 col-lg-4 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="TotalStock" class="form-label" style="color: blue;">TotalStock</label>
                                    <input asp-for="TotalStock" value="@Model.TotalStock" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>
                                  <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="FGQty" class="form-label" style="color: blue;">FGQty</label>
                                    <input asp-for="FGQty" class="form-control number"  />
                                </div>

                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="FGConvQty" class="form-label" style="color: blue;">FGConvQty</label>
                                    <input asp-for="FGConvQty" class="form-control number"   />
                                </div>

                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="Unit" class="form-label" style="color: blue;">Unit</label>
                                    <input asp-for="Unit" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>

                               
                            </div>

                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="H_SAGrid">
                        <button class="accordion-button collapsed text-light pnl4BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_SAGrid" aria-expanded="true" aria-controls="B_SAGrid">
                            <strong style="text-transform:uppercase"><i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;"></i>Item Detail Grid</strong>
                        </button>
                    </h2>

                    <div id="B_SAGrid" class="accordion-collapse collapse pnl4 bg-gradient" aria-labelledby="H_SAGrid">
                        <div class="accordion-body">
                            <div class="row g-2 gx-3" id="_ItemGrid">
                            </div>
                            <div class="progress my-2 mb-3" style="height: 4px;">
                                <div class="progress-bar progress-bar-striped bg-secondary progress-bar-animated" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="card">
                                <div class="card-body overflow-auto pb-0">
                                    <table class="table table-hover table-bordered table-striped" id="TableGrid">
                                        <thead class="bg-gradient card-headerBG text-light small" style="white-space:nowrap" id="GridLabels">
                                            <tr>
                                               
                                                <th>RM StoreName</th>
                                                <th style="align-items:left;">RM PartCode</th>
                                                <th style="align-items:left;">RM ItemName</th>
                                                <th>BomQty</th>
                                                <th>DeassQty</th>
                                                <th>IdealDeassQty</th>
                                                <th>Unit</th>
                                                <th>Remark</th>
                                                <th>RMBatchNo</th>
                                                <th>RmUniqueBatchNo</th>
                                               
                                                
                                            </tr>
                                        </thead>
                                        <tbody id="GridControls">
                                            <tr>
                                               
                                                <td>
                                                    <select class="form-select" asp-for="RMStoreId" style="width:100px;" >
                                                        <option value="" disabled selected>-Select-</option>
                                                    </select>
                                                </td>
                                                <td>
                                                    <select class="form-select" asp-for="RmPartCode" style="width:160px;">
                                                        <option value="0">-Select-</option>
                                                    </select>
                                                </td>
                                                <td>
                                                    <select class="form-select" asp-for="RMItemName" style="width:250px;">
                                                        <option value="0">-Select-</option>
                                                    </select>
                                                </td>
                                                <td><input asp-for="BomQty" class="form-control" style="width:80px;" readonly /></td>
                                                <td><input asp-for="DeassQty" style="width:70px !important" class="form-control number"/></td>
                                                <td><input asp-for="IdealDeassQty" style="width:70px !important" readonly class="form-control number" /></td>
                                                <td><input asp-for="RMUnit" style="width:70px !important" readonly /></td>
                                                <td><input asp-for="Remark" style="width:100px !important"  /></td>

                                                <td>
                                                    <input asp-for="RMBatchNo" style="width:100px !important" readonly />
                                                </td>
                                                <td>
                                                    <input asp-for="RmUniqueBatchNo" style="width:100px !important" readonly />
                                                </td>
                                                
                                              

                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="progress my-3 mb-3" style="height: 4px;">
                                <div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>

                            <div class="d-flex justify-content-between">
                                <div class="col-md-2">
                                    <input type="text" class="form-control" id="search-box" placeholder="Search..." style="background-color:#FFFACD;">
                                </div>
                                <div class="col-md-2">
                                    <button type="button" class="GridButton btn btn-sm btn-outline-danger mt-1 mb-1">
                                        <i class="fa-duotone fa-angle-double-down fa-fw fa-lg"></i> ADD TO GRID
                                    </button>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-body overflow-auto pb-0">
                                    <table class="table table-hover table-bordered table-striped IssueNRGPTb">
                                        <thead class="bg-gradient card-headerBG text-light small" style="white-space:nowrap">
                                            <tr>
                                                <th>Action</th>
                                                <th>SR#</th>
                                                <th data-columnno="4" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Store</th>

                                                <th data-columnno="1" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Part Code</th>
                                                <th data-columnno="2" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Item Name</th>
                                                <th data-columnno="9" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>BomQty</th>
                                                <th data-columnno="10" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>DeassQty</th>
                                                <th data-columnno="11" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>IdealDeassQty</th>
                                                <th data-columnno="7" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Unit</th>
                                                <th data-columnno="8" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Remark </th>

                                                <th data-columnno="5" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Batch NO</th>
                                                <th data-columnno="6" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Unique Batch No</th>
                                                
                                            </tr>
                                        </thead>
                                        <tbody id="divISTGrid">
                                            <partial name="_DeassembleItemGrid" />
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>


                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="HPanel2">
                        <button class="accordion-button collapsed text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#ODGrid" aria-expanded="false" aria-controls="ODGrid">
                            <strong style="text-transform:uppercase"><i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;"></i>Other Detail</strong>
                        </button>
                    </h2>
                    <div id="ODGrid" class="accordion-collapse collapse pnl4 bg-gradient" aria-labelledby="H_SAGrid">
                        <div class="accordion-body">
                            <div class="row g-2 gx-3">
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="CreatedByEmpName" class="form-label">CreatedByEmpName</label>
                                    <input asp-for="CreatedByEmpName" class="form-control" readonly />
                                    <input type="hidden" asp-for="CreatedByEmp" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="CreatedOn" class="form-label" style="color: blue;">CreatedOn</label>
                                    <input asp-for="CreatedOn" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="UpdatedByName" class="form-label" style="color: blue;">UpdatedBy</label>
                                    <input asp-for="UpdatedByName" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2  col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="UpdatedOn" class="form-label">UpdatedOn</label>
                                    <input asp-for="UpdatedOn" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2  col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="UpdatedOn" class="form-label">Updated Date</label>
                                    <input asp-for="UpdatedOn " class="form-control" readonly />
                                </div>
                                <div class="col-xl-2  col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="EntryByMachine" class="form-label" style="color: blue;">EntryByMachine</label>
                                    <input asp-for="EntryByMachine " class="form-control" value="@Environment.MachineName" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="CC" class="form-label">CC</label>
                                    <input asp-for="CC" class="form-control" />
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </form>


</div>

@section Scripts
{
    <script>
        $(document).on('input', '.number', function () {
            // Replace anything that's not a digit or a single decimal point
            this.value = this.value.replace(/[^0-9.]/g, '')         // Remove invalid chars
                .replace(/(\..*)\./g, '$1');     // Allow only one decimal
        });
        $(document).ready(function () {
            /* GetFormRights(); */

            if ($('#Mode').val() != 'U' && $('#Mode').val() != 'V') {
                $('#FinishItemName').select2();
                $('#FinishPartCode').select2();
                $('#BomNo').select2();
                $('#FGStoreId').select2();

                $('#FGBatchNo').select2();
                $('#FGUniqueBatchNo').select2();
            }
            $('#RMItemName').select2();
            $('#RmPartCode').select2();

            $('#FGQty').on('input', function () {
                $('#FGConvQty').val($(this).val());
            });
            $('#FGConvQty').on('input', function () {
                 calculateDeassQty();
            });

            var FGConvQty = parseFloat($('#FGConvQty').val());
            var BomQty = parseFloat($('#BomQty').val());
            var DeassQty = parseFloat($('#DeassQty').val());
            var IdealDeassQty = parseFloat($('#IdealDeassQty').val());

            DeassQty = FGConvQty * BomQty;
            parseFloat($('#DeassQty').val(DeassQty));
            parseFloat($('#IdealDeassQty').val(DeassQty));

            $('#Remark').rules("remove", "required");
            $('#ToWCID').prop("disabled", true);
            FillStore();
            FillRMStore();
                   FillBomNo();
            FillFGPartCode();
            FillFGItemName();
                    FillFGStockBatchNo();
                    FillFGStockUniqueBatchNo();
                    FillMRNNO();
                    FillRecStoreStock();
            
;         

            if ($('#Mode').val() != "U" && $('#Mode').val() != "V") {
                NewEntryId();
                //$('#Remark').val("");
                //$('#StoreWorkCenter').val("");
            }
            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {

                /*  var EntryDate = parseDateToFormat($('#EntryDate').val().split(" ")[0]);
                 var SlipDate = parseDateToFormat($('#SlipDate').val().split(" ")[0]);
                 var ActualEntryDate = parseDateToFormat($('#ActualEntryDate').val().split(" ")[0]);
                 //var GateDt = parseDateToFormat($('#ChallanDate').val().split(" ")[0]);
                 $('#EntryDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", EntryDate);
                 $('#SlipDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", SlipDate);
                 $('#ActualEntryDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", ActualEntryDate);
                 //$('#GateDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", GateDt); */


                console.log($('#EntryDate').val());



                var EntryDate = parseDateToFormat($('#EntryDate').val().split(" ")[0]);
                var SlipDate = parseDateToFormat($('#SlipDate').val().split(" ")[0]);
                var ActualEntryDate = parseDateToFormat($('#ActualEntryDate').val().split(" ")[0]);
                console.log(EntryDate);
                console.log(SlipDate);

                /* var EntryDate = parseDateToFormat($('#EntryDate').val().split(" ").join("/"));
                var InvoiceDt = parseDateToFormat($('#InvoiceDate').val().split(" ").join("/")); */
                $('#EntryDate').datepicker("setDate", EntryDate);
                $('#SlipDate').datepicker("setDate", SlipDate);
                $('#ActualEntryDate').datepicker("setDate", ActualEntryDate);
            }
            else {
                GetServerDate();
                

                if ($('#IssueToStoreWC').val() == 'S') {
                    $('#FromStoreId').val($('#hiddenFromStoreId').val());
                    $('#ToStoreId').val($('#hiddenToStoreId').val());
                } else {
                    $('#TossWCID').val($('#hiddenToWCID').val());
                }

                var rowCount = $('#divISTGrid tr').length;
                for (var i = 1; i <= rowCount; i++) {
                    var itemCodee = parseInt($('#GridItemCode-' + i).val());
                    var batchNoo = $('#GridBatchNo-' + i).text();
                    var uniquebatchnoo = $('#GridUniqueBatchno-' + i).text();
                    var Seqno = $('#SeqNo-' + i).val();
                    itemBatchArray.push({
                        "SeqNo": parseInt(Seqno),
                        "itemcode": itemCodee,
                        "batchno": batchNoo,
                        "uniquebatchno": uniquebatchnoo
                    });
                }
            }

            $('#IssueToStoreWC').rules("remove", "required");
            $('#ToStoreId').rules("remove", "required");
            $('#RecStoreStock').rules("remove", "required");
            $('#Unit').rules("remove", "required");
            $('#AltUnit').rules("remove", "required");
            $('#ReasonOfTransfer').rules("remove", "required");
            $('#LastUpdatedByName').rules("remove", "required");
            $('#FromStoreId').rules("remove", "required");
            $('#BatchNo').rules("remove", "required");
            $('#UniqueBatchNo').rules("remove", "required");
            $('#PartCode').rules("remove", "required");
            $('#ItemCode').rules("remove", "required");
            $('#ActualEntryByName').rules("remove", "required");
            $('#TotalStockQty').rules("remove", "required");
            $('#LotStockQty').rules("remove", "required");
            $('#Qty').rules("remove", "required");
            $('#AltQty').rules("remove", "required");
            $('#AltUnit').rules("remove", "required");
            $('#Rate').rules("remove", "required");
            $('#RecStoreStock').rules("remove", "required");

        });


        $('#MaterialRecFrom').change(function () {
            var selectedValue = $(this).val();

            if (selectedValue === 'Production') {
                $('.Production').css('display', 'block');
            } else {
                $('.Production').css('display', 'none');
            }

            if (selectedValue === 'MRN') {
                $('.MRN').css('display', 'block');
            } else {
                $('.MRN').css('display', 'none');
            }

            if (selectedValue === 'None') {
                $('.MRN').css('display', 'none');
                $('.Production').css('display', 'none');
            }
        });

        $(document).on('select2:select', '#FinishItemName,#FinishPartCode', function (e) {

            var cntId = e.target.id;
            console.log(cntId);
            if (cntId == 'FinishItemName') {
                ItemNameChange(cntId);
               /*  $('#FinishItemCode').val($('#FinishItemName').val()); */
            }
            else if (cntId == 'FinishPartCode') {
                PartCodeChange(cntId);
                /* $('#FinishItemCode').val($('#FinishPartCode').val()); */
            }
            $('#FinishItemCode').val(parseInt($('#FinishItemName').val()));
            FillBomNo();
        });

        function ItemNameChange(ID) {

            $('#RmPartCode,#RMItemName,#RMStoreId,#Wcid').val("").trigger("change");
            $('#RMBatchNo,#RmUniqueBatchNo,#AdjType,#reasonOfAdjustment').val("");
            $('#RMUnit,#Remark').val("");
            $('#DeassQty,#BomQty,#IdealDeassQty,#ActualStockQty,#AdjQty,#Rate,#Amount,#Qty').val(0);
            $('#BomQty,#UniqueBatchNo,#ReasonOfTransfer').val('');
            SetPartCodeItemName(ID);
            FillFGStockBatchNo();
            FillFGStockUniqueBatchNo();
            GetItemPartCode(ID);
            FillMRNNO();
            FillRecStoreStock();
        }

        function PartCodeChange(ID) {
            $('#RmPartCode,#RMItemName,#RMStoreId,#Wcid').val("").trigger("change");
            $('#RMBatchNo,#RmUniqueBatchNo,#AdjType,#reasonOfAdjustment').val("");
            $('#RMUnit,#Remark').val("");
            $('#DeassQty,#BomQty,#IdealDeassQty,#ActualStockQty,#AdjQty,#Rate,#Amount,#Qty').val(0);
            $('#BomQty,#UniqueBatchNo,#ReasonOfTransfer').val('');
            $.when(SetPartCodeItemName(ID)).done(function () {
                GetItemPartCode(ID);
            });
            FillFGStockBatchNo();
            FillFGStockUniqueBatchNo();
            FillMRNNO();
            FillRecStoreStock();
        }

        function SetPartCodeItemName(ID) {
            if (!ID) return;
            else {
                var v = $('#' + ID).select2('val');
                if (ID == "FinishPartCode") {
                    $("#FinishItemName").val(v).trigger("change");
                }

                if (ID == "FinishItemName") {
                    $("#FinishPartCode").val(v).trigger("change");
                }
            }
        }
/* 
                        $('#FinishItemName').change(function () {
                                     $('#FinishItemCode').val($('#FinishItemName').val())
                });
 */
        $('#FGQty').on('input', function () {
            var FGQty = parseFloat($(this).val());
            var TotalStock = parseFloat($("#TotalStock").val());

            if (FGQty > TotalStock) {
                $.notify('Quantity must be less then TotalStock ', 'error');
                $(this).val('');
            }
        });

        $('#FGConvQty').on('input', function () {
            var FGConvQty = parseFloat($(this).val());
            var TotalStock = parseFloat($("#TotalStock").val());

            if (FGConvQty > TotalStock) {
                $.notify('FGConvQty must be less then TotalStock ', 'error');
                $(this).val('');
            }
        });

        function calculateDeassQty() {
            var FGConvQty = parseFloat(document.getElementById('FGConvQty').value) || 0;
            var BomQty = parseFloat(document.getElementById('BomQty').value) || 0;
            var DeassQty = FGConvQty * BomQty;
            document.getElementById('DeassQty').value = DeassQty.toFixed(2);
            document.getElementById('IdealDeassQty').value = DeassQty.toFixed(2);
        }



        $(document).on('select2:select', '#RMItemName,#RmPartCode', function (e) {

            var cntId = e.target.id;
            console.log(cntId);
            if (cntId == 'RMItemName') {
                RMItemNameChange(cntId);
               /*  $('#RMItemCode').val($('#RMItemName').val()); */
            }
            else if (cntId == 'RmPartCode') {
                RMPartCodeChange(cntId);
                /* $('#RMItemCode').val($('#RmPartCode').val()); */
            }
            $('#RMItemCode').val($('#RMItemName').val());
            /* FillBomNo(); */
        });

        function RMItemNameChange(ID) {
            SetRMPartCodeItemName(ID);
            
                GetRMItemPartCode(ID);
           
           /*  FillRMStockBatchNo();
            FillRMStockUniqueBatchNo(); */
            BomQty();
            calculateDeassQty();
        }

        function RMPartCodeChange(ID) {

            $.when(SetRMPartCodeItemName(ID)).done(function () {
                GetRMItemPartCode(ID);
            });
           /*  FillRMStockBatchNo();
            FillRMStockUniqueBatchNo(); */
            BomQty();
            calculateDeassQty();
        }

        function SetRMPartCodeItemName(ID) {
            if (!ID) return;
            else {
                var v = $('#' + ID).select2('val');
                if (ID == "RmPartCode") {
                    $("#RMItemName").val(v).trigger("change");
                }

                if (ID == "RMItemName") {
                    $("#RmPartCode").val(v).trigger("change");
                }
            }
        }

        async function GetItemPartCode(ID) {
            $.getJSON({
                url: '@Url.Action("GetItemPartCode", "SaleOrder")',
                data: { Code: $('#' + ID).val() },
                success: function (result, status, xhr) {
                    if (result) {
                        var obj = JSON.parse(result);
                        if (!obj) {
                            $('#Unit').val('0'), $('#HSNNo').val('0'), $('#AltUnit').val('NA');
                        }
                        else if (obj.StatusCode == 200 && obj.StatusText == "Success") {
                            $('#Unit').val(obj.Result[0].Unit);
                           
                        }
                    }
                },
                error: function (result, status, xhr) {
                    $.notify(result.responseText, "error");
                }
            });
        }

        async function GetRMItemPartCode(ID) {
            $.getJSON({
                url: '@Url.Action("GetItemPartCode", "SaleOrder")',
                data: { Code: $('#' + ID).val() },
                success: function (result, status, xhr) {
                    if (result) {
                        var obj = JSON.parse(result);
                        if (!obj) {
                            $('#RMUnit').val('0'), $('#HSNNo').val('0'), $('#AltUnit').val('NA');
                        }
                        else if (obj.StatusCode == 200 && obj.StatusText == "Success") {
                            $('#RMUnit').val(obj.Result[0].Unit);

                        }
                    }
                },
                error: function (result, status, xhr) {
                    $.notify(result.responseText, "error");
                }
            });
        }
       /*  $('#RMBatchNo').change(function () {
            FillRMStockUniqueBatchNo();
            
        }); */

        function ClearGridAjax() {
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("ClearGridAjax")",
                
                dataType: "json",
                async: false,
                success: function (data, status, error) {
                    console.log("Grid cleared");
                    $('#divISTGrid').empty();
                },
                error: function (req, status, error) {
                    alert(error);
                }
            });
        }
        $('#FGBatchNo').change(function () {
            ClearGridAjax();
            FillFGStockUniqueBatchNo();
            var selectedValue = $(this).val();
            $('#RMBatchNo').val(selectedValue);

        });

        $('#FGUniqueBatchNo').change(function () {
            ClearGridAjax();
            var selectedValue = $(this).val();
            $('#RmUniqueBatchNo').val(selectedValue);

        });


        $('#BomNo').change(function () {
            FillRMItemName();
            FillRMPartCode();
        });

        $('#MRNO').change(function () {
            FillMRNYearCode();
        });
        $('#MRNYearCode').change(function () {
            FillMRNDetail();
        });



        $('#submitBTN').click(function (event) {
            event.preventDefault();
           
                $("form").submit();
           
        });

        

        function GetAltQty() {
            var ItemCode = parseInt($('#ItemCode').val());
            var UnitQty = parseInt($('#Qty').val());
            var ALtQty = parseInt($('#AltQty').val());
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetAltQty", "SaleOrder")",
                async: false,
                data: { "ItemCode": ItemCode, "UnitQty": UnitQty, "ALtQty": ALtQty },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#AltQty').val("");
                            $('#AltQty').val(obj.Result[0].AltUnitValue);
                        }
                    }
                }
            });
        }

       

/*         function GetFormRights() {
            $.ajax({
                url: "@Url.Action("GetFormRights")",
                type: "POST",
                success: function (data) {
                    if (data != null) {
                        var obj = $.parseJSON(data);
                        if (obj.Result.Table.length == 0) {
                            $("#submitBTN").prop("disabled", true);
                            $('.card-footer #submitBTN').prop("disabled", true);
                            $(".DashBoard")
                                .addClass("disabled-link")
                                .on("click", function (e) {
                                    e.preventDefault(); // Prevents clicking the link
                                });
                        }
                        else {
                            // console.log(obj);
                            var optAll = obj.Result.Table[0].OptAll;
                            var optSave = obj.Result.Table[0].OptSave;
                            var optUpdate = obj.Result.Table[0].OptUpdate;
                            var optDelete = obj.Result.Table[0].OptDelete;
                            var optView = obj.Result.Table[0].OptView;
                            if (!optAll) {
                                if (!optSave) {
                                    $("#submitBTN").prop("disabled", true);
                                    $('.card-footer #submitBTN').prop("disabled", true);
                                }
                                if (!(optUpdate || optDelete || optView)) {
                                    $(".DashBoard")
                                        .addClass("disabled-link")
                                        .on("click", function (e) {
                                            e.preventDefault(); // Prevents clicking the link
                                        });
                                }
                            }
                        }
                    }
                },
                error: function (errMsg) {
                    $.notify(errMsg, { position: "top center", className: "error" });
                }
            });
        }
 */

        

        function GetUnitAltUnit(ItemCode) {
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetUnitAltUnit")",
                async: false,
                data: { "ItemCode": ItemCode },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#Unit').val("");
                            $('#Unit').val(obj.Result[0].unit);
                            $('#AltUnit').val("");
                            $('#AltUnit').val(obj.Result[0].AlternateUnit);
                        }
                    }
                }
            });
        }

        function FillRate() {
            var ItemCode = $('#ItemCode').val();
            var YearCode = $('#YearCode').val();
            var UniqueBatchNo = "";
            var BatchNo = "";
            if ($('#UniqueBatchNo').prop('selectedIndex') != 0) {
                UniqueBatchNo = $('#UniqueBatchNo').val();
            }
            if ($('#BatchNo').prop('selectedIndex') != 0) {
                BatchNo = $('#BatchNo').val();
            }
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillRateAmount", "StockAdjustment")",
                async: false,
                data: { "ItemCode": ItemCode, "YearCode": YearCode, "UniqueBatchNo": UniqueBatchNo, "BatchNo": BatchNo },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#Rate').val("");
                            $('#Rate').val(obj.Result[0].Rate);
                        }
                    }
                }
            });
        }

        function ValidateGrid() {

            GetPrevQty();
            var TotalStock = parseFloat($('#TotalStockQty').val());
            var LotStock = parseFloat($('#LotStockQty').val());
            var MinValue = Math.min(TotalStock, LotStock);
            //      var batchStock = parseFloat($('#LotStockQty').val());

            var Err = 0;
            if ($('#PartCode').prop('selectedIndex') == 0 || $('#ItemCode').prop('selectedIndex') == 0) {
                AddErrorCls('PartCode'), AddErrorCls('ItemCode');
                $.notify('Please select PartCode and ItemName.', 'error');
                Err = 1;
            }
            else {
                RemoveErrorCls('PartCode'), RemoveErrorCls('ItemCode');
            }

            if ($('#IssueToStoreWC').val() == 'S') {
                if ($('#FromStoreId').prop('selectedIndex') == 0) {
                    AddErrorCls('FromStoreId');
                    $.notify('Please select FromStore.', 'error');
                    Err = 1;
                }
                else {
                    RemoveErrorCls('FromStoreId');
                }
            } else {
                if ($('#ToWCID').prop('selectedIndex') == 0) {
                    $.notify('Please select To WorkCenter.', 'error');
                    AddErrorCls('ToWCID');
                    Err = 1;
                }
                else {
                    RemoveErrorCls('ToWCID');
                }
            }

            if ($('#BatchNo').prop('selectedIndex') == 0) {
                AddErrorCls('BatchNo');
                $.notify('Please select BatchNo.', 'error');
                Err = 1;
            }
            else {
                RemoveErrorCls('BatchNo');
            }

            if ($('#UniqueBatchNo').prop('selectedIndex') == 0) {
                AddErrorCls('UniqueBatchNo');
                $.notify('Please select UniqueBatchNo.', 'error');
                Err = 1;
            }
            else {
                RemoveErrorCls('UniqueBatchNo');
            }

            if (parseFloat($('#Qty').val()) == 0 || $('#Qty').val() == '') {
                AddErrorCls('Qty');
                $.notify('Qty cannot be 0.', 'error');
                Err = 1;
            }
            else {
                RemoveErrorCls('Qty');
            }


            if (parseFloat($('#Qty').val()) > MinValue) {
                AddErrorCls('Qty');
                $.notify('Qty cannot be less than Stock.', 'error');
                Err = 1;
            }
            else {
                RemoveErrorCls('Qty');
            }

            Err == 1 ? ShowErrorFld('H_Panel2') : HideErrorFld('H_Panel2');
            if (Err == 1) return false;

            return true;
        }

        $('#Qty').keyup(function () {
            var TotalStock = parseFloat($('#TotalStockQty').val());
            var LotStock = parseFloat($('#LotStockQty').val());
            var MinValue = Math.min(TotalStock, LotStock);
            if (parseFloat($('#Qty').val()) > MinValue) {
                AddErrorCls('Qty');
                Err = 1;
            }
            else {
                RemoveErrorCls('Qty');
            }
        });

        var EditEachItem = false;
        var EditDeleteBatchValidation = false;
        function EditItemRows(SeqNo) {
            var RowCount = $('#divISTGrid tr').length;
            if (EditEachItem) {
                $.notify('Cannot Edit item while AddtoGrid  Existing Item!!!', "error");
                $('#editButton-' + RowCount).prop("disabled", true);
            }
            else {
                $.ajax({
                    url: '@Url.Action("EditItemRows")',
                    type: "POST",
                    data: { SeqNo: SeqNo },
                    async: false,
                    success: function (data) {
                        var obj = $.parseJSON(data);
                        if (obj != null) {
                            EditEachItem = true;
                            EditDeleteBatchValidation = true;

                            $('#RmPartCode').val(obj[0].RMItemCode).trigger("change");
                            /* $('#RmPartCode').text(obj[0].RmPartCode).trigger("change"); */
                            $('#RMItemName').val(obj[0].RMItemCode).trigger("change");
                            /* $('#RMItemName').text(obj[0].RMItemName).trigger("change"); */
                            $('#RMItemCode').val(obj[0].RMItemCode);
                            $('#RMUnit').val(obj[0].RMUnit);
                            $('#RMStoreId').val(obj[0].RMStoreId).trigger("change");
                            /* $('#RMStoreId').text(obj[0].RMStoreName).trigger("change"); */

                            $('#Remark').val(obj[0].Remark);
                            if ($('#RMBatchNo').val() == obj[0].RMBatchNo) {
                                $('#RMBatchNo').val(obj[0].RMBatchNo);
                                $('#RmUniqueBatchNo').val(obj[0].UniqueBatchNo);
                            } else {
                                $('#RMBatchNo').append("<option value='" + obj[0].RMBatchNo + "' selected>" + obj[0].RMBatchNo + "</option>")
                                $('#RmUniqueBatchNo').append("<option value='" + obj[0].RmUniqueBatchNo + "' selected>" + obj[0].RmUniqueBatchNo + "</option>")

                            }

                            $('#BomQty').val(obj[0].BomQty);
                            $('#DeassQty').val(obj[0].DeassQty);
                            $('#IdealDeassQty').val(obj[0].IdealDeassQty);
                           
                            var rowCount = $('#divISTGrid tr').length;
                            for (var i = 1; i <= rowCount + 1; i++) {
                                $('#editItemGrid-' + i).css("pointer-events", "none");
                                $('#editItemGrid-' + i).css("cursor", "not-allowed");
                            }

                           /*  GetPrevQty(); */
                            DeleteItemRow(SeqNo);
                            
                        }
                    },
                    error: function (response) {
                        $.notify(response.responseText, "error");
                    },
                    failure: function (response) {
                        $.notify(response.responseText, "error");
                    }
                });
            }
        }

        function DeleteItemRow(SeqNo) {
            var IC = $('#GridItemCode-' + SeqNo).val();
            var BatchNo = $('#GridBatchNo-' + SeqNo).text();

            var allowDeletion = true;
            if (!EditDeleteBatchValidation) {
                for (var j = 0; j < itemBatchArray.length; j++) {
                    if (itemBatchArray[j].SeqNo > SeqNo && itemBatchArray[j].itemcode == IC) {
                        $.notify('Cannot delete this row before deleting other BatchNo of this Item.', "error");
                        allowDeletion = false;
                        break;
                    }
                }
            }

            if (allowDeletion) {
                $.ajax({
                    url: '@Url.Action("DeleteItemRow")',
                    type: "POST",
                    async: false,
                    data: { "SeqNo": SeqNo, "Mode": $('#Mode').val() },
                    success: function (data, status, xhr) {
                        $('#divISTGrid').html(data);
                        //TotalNoOfRows();
                        var itemArrayLength = itemBatchArray.length;

                        for (var i = 0; i < itemArrayLength; i++) {
                            if (itemBatchArray[i].itemcode == IC && itemBatchArray[i].batchno == BatchNo) {
                                itemBatchArray.splice(i, 1);
                            }
                        }
                    },
                    error: function (response, status, xhr) {
                        alert(response.responseText);
                        $.notify(response.responseText, "error");
                    },
                    failure: function (response, status, xhr) {
                        alert(response.responseText);
                        $.notify(response.responseText, "error");
                    }
                });
            }

            EditDeleteBatchValidation = false;
        }


        var itemBatchArray = [];
        $('.GridButton').click(function (e) {

            e.preventDefault();
            EditEachItem = false;

            var rowCount = $('#divISTGrid  tr').length; // assuming you append one more row
            var Seqno = rowCount;
            
            if (!ValidateGrid()) return;
            var itemCodee = parseInt($('#RMItemCode').val());
            var batchNoo = $('#RMBatchNo').val();
            var uniquebatchnoo = $('#RmUniqueBatchNo').val();
            var SchData = {
                "RMStoreId": parseInt($('#RMStoreId').val()),
                "RMStoreName": $('#RMStoreId :selected').text(),
                "RMItemCode": parseInt($('#RmPartCode').val()),
                "RmPartCode": $('#RmPartCode :selected').text(),
                "RMItemName": $('#RMItemName :selected').text(),
                "RMUnit": $('#RMUnit').val(),
                "Remark": $('#Remark').val(),
                "RMBatchNo": $('#RMBatchNo').find(':selected').text(),
                "RmUniqueBatchNo": $('#RmUniqueBatchNo').find(':selected').text(),
                "BomQty": $('#BomQty').val(),
                "DeassQty": $('#DeassQty').val(),
                "IdealDeassQty": $('#IdealDeassQty').val(),



                "SeqNo": Seqno
            }
            $.ajax({
                type: "POST",
                url: '@Url.Action("AddDeassembleDetail")',
                data: SchData,
                statusCode: {
                    207: function () {
                        $.notify('Duplicate Item...!', "info");
                    }
                },
                success: function (result, status, xhr) {
                    if (xhr.status == 200 && xhr.responseText == result) {
                        $('#divISTGrid').html(result);
                        $('#RmPartCode,#RMItemName,#RMStoreId,#Wcid').val("").trigger("change");
                        $('#RMBatchNo,#RmUniqueBatchNo,#AdjType,#reasonOfAdjustment').val("");
                        $('#RMUnit,#Remark').val("");
                        $('#DeassQty,#BomQty,#IdealDeassQty,#ActualStockQty,#AdjQty,#Rate,#Amount,#Qty').val(0);
                        $('#BomQty,#UniqueBatchNo,#ReasonOfTransfer').val('');
                       
                        $('#PartCode').focus();
                        var rowCount = $('#divISTGrid tr').length;
                        var Seqno = $('#SeqNo-' + rowCount).val();
                        itemBatchArray.push({
                            "SeqNo": parseInt(Seqno),
                            "itemcode": itemCodee,
                            "batchno": batchNoo,
                            "uniquebatchno": uniquebatchnoo
                        });
                        
                    }
                },
                error: function (result, status, xhr) {
                    $.notify('Something Went Wrong, Please Try Again.', "error");
                }
            });
        });

        


        $('#SlipDate').change(function () {
            ClearGrid();
        });
      

        $('#FGStoreId').change(function () {
            FillFGStockBatchNo();
            FillRecStoreStock();
        });



        $('#FGUniqueBatchNo').change(function () {
            FillLotStock();
            
                FillRecStoreStock();
            
        });

        var QtyVal = 0;
        var AltQtyVal = 0;
        function GetPrevQty() {
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetPrevQty")",
                data: { "EntryId": $('#EntryId').val(), "YearCode": $('#YearCode').val(), "ItemCode": $('#ItemCode').val(), "uniqueBatchno": $('#UniqueBatchNo').val() },
                dataType: "json",
                async: false,
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        QtyVal = obj.Result[0].qty;
                        AltQtyVal = obj.Result[0].AltQty;
                    }
                }
            });
        }

       

        function GetBatchInventory() {
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetBatchInventory", "NRGP")",
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        //$('#EntryId').val(obj.Result[0].EntryId);
                        if (obj.Result[0].FIFOBasedBatchInventory == 'Y') {
                            $("#BatchNo option:not(:eq(1))").prop("disabled", true);
                            $('#BatchNo').css('background-color', 'rgb(248 255 178)');
                        }
                    }
                }
            });
        }

        function FillTotalStock() {

            var ItemCode = $('#ItemCode').val();
            var Storeid = $('#FromStoreId').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillTotalStock", "StockAdjustment")",
                async: false,
                data: { "ItemCode": ItemCode, "Storeid": Storeid },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#TotalStockQty').val(0);
                            $('#TotalStockQty').val(obj.Result[0].STOCK);
                        }
                        //  ChangeAltQty();
                    }
                }
            });
        }


        function FillRecStoreStock() {
            var ItemCode = $('#FinishPartCode').val();
            var Storeid = $('#FGStoreId').val();
            var UniqueBatchNo = $('#FGUniqueBatchNo').val();
            var BatchNo = $('#FGBatchNo').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillTotalStock", "StockAdjustment")",
                data: { "ItemCode": ItemCode, "Storeid": Storeid },
                async: false,
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#TotalStock').val("");
                            $('#TotalStock').val(obj.Result[0].STOCK);
                        }
                    }
                }
            });
        }



        var RMUniqueBatchNo = [];
        function FillRMStockBatchNo() {

            var ItemCode = $('#RmPartCode').val();
            var YearCode = $('#DeassYearcode').val();
            var StoreName = $('#RMStoreId').find(':selected').text();
            var batchno = "";
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStockBatchNo")",
                async: false,
                data: { "ItemCode": ItemCode, "StoreName": StoreName, "YearCode": YearCode, "batchno": batchno },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            FGUniqueBatchNo = [];
                            $('#RMBatchNo').empty();
                            $('#RMBatchNo').append('<option value="" selected>-Select-</option>');
                            $('#RmUniqueBatchNo').empty();
                            $('#RmUniqueBatchNo').append('<option value="" selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#RMBatchNo').append('<option value="' + val.batchno + '">' + val.batchno + '</option>');

                            });
                            GetBatchInventory();


                            var itemArrayLength = itemBatchArray.length;
                            if (itemArrayLength > 0) {
                                var itemsWithCode16 = itemBatchArray.filter(function (item) {
                                    return item.itemcode === parseInt(ItemCode);
                                });
                                var selectList = $('#RMBatchNo');
                                var SelectUBList = $('#FGUniqueBatchNo');
                                selectList.find('option').each(function () {
                                    var optionValue = $(this).val();

                                    var existsInItemsWithCode16 = itemsWithCode16.some(function (item) {
                                        return item.batchno === optionValue;
                                    });

                                    if (existsInItemsWithCode16) {
                                        $(this).remove();
                                    }
                                });

                                SelectUBList.find('option').each(function () {

                                    var optionValue = $(this).val();

                                    var existsInItemsWithCode16 = itemsWithCode16.some(function (item) {
                                        return item.uniquebatchno === optionValue;
                                    });

                                    if (existsInItemsWithCode16) {
                                        $(this).remove();
                                    }
                                });
                            }



                        } else {
                            $('#RMBatchNo').empty();
                            $('#RMBatchNo').append('<option value="" selected>-Select-</option>');
                            $('#FGUniqueBatchNo').empty();
                            $('#FGUniqueBatchNo').append('<option value="" selected>-Select-</option>');
                        }
                    }
                }
            });
        }

        function FillRMStockUniqueBatchNo() {
            var ItemCode = $('#RmPartCode').val();
            var YearCode = $('#DeassYearcode').val();
            var StoreName = $('#RMStoreId').find(':selected').text();
            var batchno = $('#RMBatchNo').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStockBatchNo")",
                async: false,
                data: { "ItemCode": ItemCode, "StoreName": StoreName, "YearCode": YearCode, "batchno": batchno },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {

                            $('#RmUniqueBatchNo').empty();
                            $('#RmUniqueBatchNo').append('<option value="" selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#RmUniqueBatchNo').append('<option value="' + val.UniqueBatchNo + '" selected>' + val.UniqueBatchNo + '</option>');
                            });
                            //    GetBatchInventory();

                        } else {
                            $('#RmUniqueBatchNo').empty();
                            $('#RmUniqueBatchNo').append('<option value="" selected>-Select-</option>');
                        }
                    }
                }
            });
        }


        var FGUniqueBatchNo = [];
        function FillFGStockBatchNo() {

            var ItemCode = $('#FinishPartCode').val();
            var YearCode = $('#DeassYearcode').val();
            var StoreName = $('#FGStoreId').find(':selected').text();
            var batchno = "";
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStockBatchNo")",
                async: false,
                data: { "ItemCode": ItemCode, "StoreName": StoreName, "YearCode": YearCode, "batchno": batchno },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            FGUniqueBatchNo = [];
                            $('#FGBatchNo').empty();
                            $('#FGBatchNo').append('<option value="" selected>-Select-</option>');
                            $('#FGUniqueBatchNo').empty();
                            $('#FGUniqueBatchNo').append('<option value="" selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#FGBatchNo').append('<option value="' + val.batchno + '">' + val.batchno + '</option>');
                                
                            });
                            GetBatchInventory();


                            var itemArrayLength = itemBatchArray.length;
                            if (itemArrayLength > 0) {
                                var itemsWithCode16 = itemBatchArray.filter(function (item) {
                                    return item.itemcode === parseInt(ItemCode);
                                });
                                var selectList = $('#FGBatchNo');
                                var SelectUBList = $('#FGUniqueBatchNo');
                                selectList.find('option').each(function () {
                                    var optionValue = $(this).val();

                                    var existsInItemsWithCode16 = itemsWithCode16.some(function (item) {
                                        return item.batchno === optionValue;
                                    });

                                    if (existsInItemsWithCode16) {
                                        $(this).remove();
                                    }
                                });

                                SelectUBList.find('option').each(function () {

                                    var optionValue = $(this).val();

                                    var existsInItemsWithCode16 = itemsWithCode16.some(function (item) {
                                        return item.uniquebatchno === optionValue;
                                    });

                                    if (existsInItemsWithCode16) {
                                        $(this).remove();
                                    }
                                });
                            }



                        } else {
                            $('#FGBatchNo').empty();
                            $('#FGBatchNo').append('<option value="" selected>-Select-</option>');
                            $('#FGUniqueBatchNo').empty();
                            $('#FGUniqueBatchNo').append('<option value="" selected>-Select-</option>');
                        }
                    }
                }
            });
        }

        function FillFGStockUniqueBatchNo() {
            var ItemCode = $('#FinishPartCode').val();
            var YearCode = $('#DeassYearcode').val();
            var StoreName = $('#FGStoreId').find(':selected').text();
            var batchno = $('#FGBatchNo').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStockBatchNo")",
                async: false,
                data: { "ItemCode": ItemCode, "StoreName": StoreName, "YearCode": YearCode, "batchno": batchno },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {

                            $('#FGUniqueBatchNo').empty();
                            $('#FGUniqueBatchNo').append('<option value="" selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#FGUniqueBatchNo').append('<option value="' + val.UniqueBatchNo + '" selected>' + val.UniqueBatchNo + '</option>');
                            });
                            //    GetBatchInventory();

                        } else {
                            $('#FGUniqueBatchNo').empty();
                            $('#FGUniqueBatchNo').append('<option value="" selected>-Select-</option>');
                        }
                    }
                }
            });
        }

        function FillCurrentWIPBatchINStore() {
            var ItemCode = $('#ItemCode').val();
            var YearCode = $('#YearCode').val();
            var Wcid = $('#ToWCID').val();
            var batchno = "";
            var TransDate = $('#SlipDate').val();
            if ($('#BatchNo').prop('selectedIndex') != 0) {
                batchno = $('#BatchNo').val();
            }
            $.ajax({
                type: "GET",
                data: { "ItemCode": ItemCode, "YearCode": YearCode, "WCid": Wcid, "TransDate": TransDate, "BatchNo": batchno },
                url: "@Url.Action("FillCurrentBatchINWIP", "StockAdjustment")",
                dataType: "json",
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#BatchNo').empty();
                            $('#BatchNo').append('<option value="" disabled selected>-Select-</option>');
                            //$('#UniqueBatchNo').empty();
                            //$('#UniqueBatchNo').append('<option value="" selected>-Select-</option>');
                            $.each(obj.Result, function (index, val) {
                                $('#BatchNo').append('<option value="' + val.batchno + '">' + val.batchno + '</option>');
                                //$('#UniqueBatchNo').append('<option value="' + val.UniqueBatchNo + '">' + val.UniqueBatchNo + '</option>');
                            });
                            GetBatchInventory();
                        } else {
                            $('#BatchNo').empty();
                            $('#BatchNo').append('<option value="" disabled selected>-Select-</option>');
                        }

                    }
                }
            });
        }

        function FillCurrentWIPUniqueBatchINStore() {
            var ItemCode = $('#ItemCode').val();
            var YearCode = $('#YearCode').val();
            var Wcid = $('#ToWCID').val();
            var batchno = "";
            var TransDate = $('#SlipDate').val();
            if ($('#BatchNo').prop('selectedIndex') != 0) {
                batchno = $('#BatchNo').val();
            }
            $.ajax({
                type: "GET",
                data: { "ItemCode": ItemCode, "YearCode": YearCode, "WCid": Wcid, "TransDate": TransDate, "BatchNo": batchno },
                url: "@Url.Action("FillCurrentBatchINWIP", "StockAdjustment")",
                dataType: "json",
                async: false,
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#UniqueBatchNo').empty();
                            $('#UniqueBatchNo').append('<option value="" selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                //  $('#BatchNo').append('<option value="' + val.batchno + '">' + val.batchno + '</option>');
                                $('#UniqueBatchNo').append('<option value="' + val.UniqueBatchNo + '" selected>' + val.UniqueBatchNo + '</option>');
                            });
                            GetBatchInventory();
                        } else {
                            $('#UniqueBatchNo').empty();
                            $('#UniqueBatchNo').append('<option value="" selected>-Select-</option>');
                        }

                    }
                }
            });
        }

        $('#SHA').change(function () {
            $('#SHAItems').prop("checked", true);
           /*  FillPartCode();
            FillItem(); */
        });

        $('#SHAItems').change(function () {
            $('#SHA').prop("checked", true);
           /*  FillPartCode();
            FillItem(); */
        });

        var BatchStock = 0;
        function FillLotStock() {
            var ItemCode = $('#ItemCode').val();
            var Storeid = $('#FromStoreId').val();
            var UniqueBatchNo = $('#UniqueBatchNo').val();
            var BatchNo = $('#BatchNo').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillLotStock", "StockAdjustment")",
                data: { "ItemCode": ItemCode, "Storeid": Storeid, "UniqueBatchNo": UniqueBatchNo, "BatchNo": BatchNo },
                async: false,
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#LotStockQty').val("");
                            $('#LotStockQty').val(obj.Result[0].STOCK);
                            BatchStock = obj.Result[0].STOCK;
                        }
                    }
                }
            });
        }

       

        function ClearGrid() {
            $.ajax({
                type: "POST",
                url: "@Url.Action("ClearGrid")",
                success: function (result, status, xhr) {
                    $('#divISTGrid').html(result.trim());
                    if (result == "") {
                        $('#divISTGrid').append("<tr class='text-center'><td colspan='17' class='text-black-50'><strong class='text-danger'>NO DATA ADDED</strong></td></tr>");
                    }
                    

                },
                error: function (result, status, xhr) {
                    $.notify(result.responseText, "error");
                }
            });
        }

        function FillFGItemName() {

            $.ajax({
                type: "POST",
                url: "@Url.Action("FillFGItemName")",
               
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#FinishItemName').empty();
                            $('#FinishItemName').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#FinishItemName').append('<option value="' + val.Item_Code + '">' + val.Item_Name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var FinishItemCode = "@Model.FinishItemCode";
                                $('#FinishItemName').val(FinishItemCode).trigger("change");
                            }
                        }

                    }
                }
            });
        }

        function FillFGPartCode() {

            $.ajax({
                type: "POST",
                url: "@Url.Action("FillFGPartCode")",

                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#FinishPartCode').empty();
                            $('#FinishPartCode').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#FinishPartCode').append('<option value="' + val.Item_Code + '">' + val.PartCode + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var FinishItemCode = "@Model.FinishItemCode";
                                $('#FinishPartCode').val(FinishItemCode).trigger("change");
                            }
                        }

                    }
                }
            });
        }

        function FillBomNo() {
            var FinishItemCode = $("#FinishItemCode").val();
            console.log(FinishItemCode);
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillBomNo")",
                data: { FinishItemCode: FinishItemCode },
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#BomNo').empty();
                            $('#BomNo').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#BomNo').append('<option value="' + val.BOMNO + '">' + val.BOMNO + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var BomNo = "@Model.BomNo";
                                $('#BomNo').val(BomNo).trigger("change");
                            }
                        }

                    }
                }
            });
        }

        function FillRMItemName() {
            var FinishItemCode = $("#FinishItemCode").val();
            var BomNo = $("#BomNo").val();
            console.log(FinishItemCode);
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillRMItemName")",
                data: { FinishItemCode: FinishItemCode, BomNo: BomNo },
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#RMItemName').empty();
                            $('#RMItemName').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#RMItemName').append('<option value="' + val.Item_Code + '">' + val.Item_Name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var RMItemCode = "@Model.RMItemCode";
                                $('#RMItemName').val(RMItemCode).trigger("change");
                            }
                        }

                    }
                }
            });
        }

        function FillRMPartCode() {
            var FinishItemCode = $("#FinishItemCode").val();
            var BomNo = $("#BomNo").val();
            console.log(FinishItemCode);
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillRMPartCode")",
                data: { FinishItemCode: FinishItemCode, BomNo: BomNo },
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#RmPartCode').empty();
                            $('#RmPartCode').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#RmPartCode').append('<option value="' + val.Item_Code + '">' + val.PartCode + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var RMItemCode = "@Model.RMItemCode";
                                $('#RmPartCode').val(RMItemCode).trigger("change");
                            }
                        }

                    }
                }
            });
        }

        function FillStore() {
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStore")",
                dataType: "json",
                async: false,
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#FGStoreId').empty();
                            $('#FGStoreId').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#FGStoreId').append('<option value="' + val.storeid + '">' + val.store_name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var FGStoreId = "@Model.FGStoreId";
                                $('#FGStoreId').val(FGStoreId).trigger("change");
                            }
                        }
                    }
                }
            });
        }


        function FillMRNNO() {
            var FGItemCode = $('#FinishPartCode').val();
            var yearcode = $('#DeassYearcode').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillMRNNO")",
                dataType: "json",
                async: false,
                data: { FGItemCode: FGItemCode, yearcode: yearcode },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#MRNO').empty();
                            $('#MRNO').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#MRNO').append('<option value="' + val.MRNno + '">' + val.MRNno + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var MRNO = "@Model.MRNO";
                                $('#MRNO').val(MRNO).trigger("change");
                            }
                        }
                    }
                }
            });
        }


        function FillMRNYearCode() {
            var FGItemCode = $('#FinishItemCode').val();
            var yearcode = $('#DeassYearcode').val();
            var MRNNO = $('#MRNO').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillMRNYearCode")",
                dataType: "json",
                async: false,
                data: { FGItemCode: FGItemCode, yearcode: yearcode, MRNNO: MRNNO },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#MRNYearCode').empty();
                            $('#MRNYearCode').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#MRNYearCode').append('<option value="' + val.MRNYearCode + '">' + val.MRNYearCode + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var MRNYearCode = "@Model.MRNYearCode";
                                $('#MRNYearCode').val(MRNYearCode).trigger("change");
                            }
                        }
                    }
                }
            });
        }

        function FillMRNDetail() {
            var yearcode = $('#DeassYearcode').val();
            var MRNNO = $('#MRNO').val();
            var mrnyearcode = $('#MRNYearCode').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillMRNDetail")",
                dataType: "json",
                async: false,
                data: { yearcode: yearcode, MRNNO: MRNNO, mrnyearcode: mrnyearcode },
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            var date = new Date(obj.Result[0].MRNEntryDate);
                            var formattedDate = ("0" + date.getDate()).slice(-2) + "/" + ("0" + (date.getMonth() + 1)).slice(-2) + "/" + date.getFullYear();

                            $('#MRNDate').val(formattedDate);
                            /* $('#MRNDate').val(obj.Result[0].MRNEntryDate); */
                            $('#MRNEntryID').val(obj.Result[0].MRNEntryId);
                        }
                    }
                }
            });
        }





        function FillRMStore() {
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillStore")",
                dataType: "json",
                async: false,
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#RMStoreId').empty();
                            $('#RMStoreId').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#RMStoreId').append('<option value="' + val.storeid + '">' + val.store_name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var RMStoreId = "@Model.RMStoreId";
                                $('#RMStoreId').val(RMStoreId).trigger("change");
                            }
                        }
                    }
                }
            });
        }


       

       

        function GetServerDate() {
            $.ajax({
                type: "GET",
                url: "@Url.Action("GetServerDate", "Routing")",
                async: false,
                success: function (result, status, error) {

                    $('#DeassEntryDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", parseDateToFormat(result));
                    $('#CreatedOn').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", parseDateToFormat(result));



                    $('#DeassEntryDate').datepicker("option", "minDate", parseDateToFormat($('#FinFromDate').val().split(" ")[0]));


                    $('#DeassEntryDate').datepicker("option", "maxDate", parseDateToFormat($('#FinToDate').val().split(" ")[0]));
                }
            });
        }

        function NewEntryId() {

            $.ajax({
                type: "POST",
                url: "@Url.Action("NewEntryId")",
                dataType: "json",
                
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        $('#DeassEntryID').val("");
                        $('#DeassEntryID').val(obj.Result[0].EntryID);
                        $('#DeassSlipNo').val("");
                        $('#DeassSlipNo').val(obj.Result[0].SlipNo);
                    }
                }
            });
        }

        function BomQty() {
            var RMItemCode = $('#RmPartCode').val();
           
            $.ajax({
                type: "POST",
                url: "@Url.Action("BomQty")",
                dataType: "json",
                data: { RMItemCode: RMItemCode },
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        $('#BomQty').val("");
                        $('#BomQty').val(obj.Result[0].bomqty);
                       
                    }
                    calculateDeassQty();
                }
            });
        }

        function PressBack() {

            sessionStorage.setItem('FromDateBack', $('#FromDateBack').val());
            sessionStorage.setItem('ToDateBack', $('#ToDateBack').val());
            sessionStorage.setItem('PartCodeBack', $('#PartCodeBack').val());
            sessionStorage.setItem('ItemNameBack', $('#ItemNameBack').val());
            sessionStorage.setItem('SlipNoBack', $('#SlipNoBack').val());
            sessionStorage.setItem('BatchNoBack', $('#BatchNoBack').val());
            sessionStorage.setItem('GlobalSearchBack', $('#GlobalSearchBack').val());
            sessionStorage.setItem('DashboardTypeBack', $('#DashboardTypeBack').val());

            window.history.back();
        }

    </script>
}
