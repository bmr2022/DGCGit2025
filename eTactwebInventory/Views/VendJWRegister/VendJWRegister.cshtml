@model eTactWeb.DOM.Models.VendJWRegisterModel
@{
    ViewData["Title"] = "vendor JW Register";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<style>

    .select2-container--default .select2-selection--single {
        background-color: #e0f2f1;
        border: 1.5px solid #0a0a0a !important;
        border-radius: 4px;
    }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            /* border-bottom: 1.5px solid #000 !important; */
            border-bottom: none !important;
        }

    .select2-container--default .select2-results > .select2-results__options {
        background-color: #e0f2f1; /* Dropdown background color */
        color: #000;
</style>

<div class="card bg-gradient mb-3 border-light shadow-lg">

    <div class="card-header card-headerBG text-light bg-gradient">
        <h5>
            <strong>Vendor JW Register</strong>
            <span class="d-flex float-end" style="margin-top:-2px;">
            </span>
        </h5>
    </div>
    <div>
    </div>
    <div class="card-body bg-light pt-0">
        <div class="accordion shadow-lg">
            <div class="card-body">
                <div class="card overflow-auto">
                    <div class="card-body">
                        <form id="SParam">
                            <div class="row">
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-12 col-xs-12">
                                    <div class="row">
                                        <div class="col">
                                            <label class="form-label">From Date</label>
                                            <input asp-for="FromDate" class="form-control" />
                                        </div>
                                        <div class="col">
                                            <label class="form-label">To Date</label>
                                            <input asp-for="ToDate" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                @* <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                <label asp-for="RGPNRGP" class="form-label">RGP/NRGP</label>
                                <select class="form-select" asp-for="RGPNRGP">
                                <option value="">-Select-</option>
                                <option value="RGP">RGP</option>
                                <option value="NRGP">NRGP</option>
                                </select>
                                </div>*@
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="IssueChallanType" class="form-label">Challan Type</label>
                                    <select class="form-select" asp-for="IssueChallanType">
                                        <option disabled value="">-Select-</option>
                                        <option selected value="REC">Receive</option>
                                        <option value="ISSUE">Issue</option>
                                        <option value="RECO">Reco</option>
                                    </select>
                                </div>
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="ReportMode" class="form-label">Report Type</label>
                                    <select asp-for="ReportMode" class="form-select" onchange="GetRCRegisterData()">
                                        @*@if (Model.IssueChallanType=="REC")
                                        {
                                        <option disabled value="">-Select-</option>
                                        <option id="optionselect" data-info="JWRecDe" selected value="JOBWORKReceiveDETAIL">JobWork Receive Detail</option>
                                        <option data-info="JWRecSum" value="JOBWORKReceiveSUMMARY">Jobwork Receive Summary</option>
                                        <option data-info="JWRecDeadj" value="JOBWORKReceiveWithAdjustemntDETAIL">Jobwork Receive with Adjustment Detail   </option>
                                        <option data-info="JWRecItem" value="JOBWORKReceiveItemWiseSUMM">Jobwork Receive Item Wise Sum</option>
                                        }
                                        else
                                        {
                                        <option data-info="JWIssSum" value="JOBWORKISSUESUMMARY">JobWork Issue Summary</option>
                                        <option data-info="JWIssDe" value="JOBWORKISSUEITEMDETAIL">JobWork Issue Detail</option>
                                        <option data-info="JWIssChaSum" value="JOBWORKISSUECHALLANSUMMARY">JobWork Issue Challan Summary</option>
                                        <option data-info="JWIssChaDe" value="JOBWORKISSUECHALLANITEMDETAIL">JobWork Issue Challan Detail</option>
                                        <option data-info="JWIssParty" value="JOBWORKISSUEPatyITEMDETAIL">JobWorkIssue Partywise Detail</option>
                                        <option data-info="JWIssRec" value="JWReconcillation">JW ReCo</option>
                                        <option data-info="JWReco" value="RECO">ReCo</option>
                                        }*@
                                    </select>
                                </div>
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12" id="IssNo">
                                    <label asp-for="IssueChallanNo" class="form-label">Issue ChallanNo</label>
                                    <input asp-for="IssueChallanNo" class="form-control" />
                                </div>
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12" id="RecNo">
                                    <label asp-for="RecChallanNo" class="form-label">Rec ChallanNo</label>
                                    <input asp-for="RecChallanNo" class="form-control" />
                                </div>

                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="PartyName" class="form-label">Party Name</label>
                                    <input asp-for="PartyName" class="form-control" />
                                </div>
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="PartCode" class="form-label">PartCode</label>
                                    <input asp-for="PartCode" class="form-control" />
                                </div>
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="ItemName" class="form-label">Item Name</label>
                                    <input asp-for="ItemName" class="form-control" />
                                </div>
                                <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <label class="form-label">Global search</label>
                                    <input id="search-box" class="form-control" style="background-color: #FFFACD;" placeholder="Search..." />
                                </div>
                                <div class="col-sm-3 col-md-6 col-lg-2 col-xl-3 justify-content-center mt-4" style="margin-left:50px;margin-top:10px;">
                                    <label class="color-box mt-3" style="background-color: #f3dea1;"></label><label style="margin-left:5px;margin-top:-5px;">Closed Challan</label>
                                    <label class="color-box mt-3" style="background-color: rgb(158 225 149);margin-left:25px;"></label><label style="margin-left:5px;margin-top:-5px;">Pending Challan</label>
                                </div>
                                <div class="col-xl-4 col-lg-3 col-md-6 col-sm-6 col-xs-12 d-flex justify-content-center mt-3">
                                    <button class="btn btn-sm btn-outline-info" type="button" style="padding:0px;height:30px;width:100px;" onclick="GetRCRegisterData();">
                                        <i class="fa-solid fa-magnifying-glass fa-fw fa-lg"></i>SEARCH
                                    </button>
                                    <button class="btn btn-sm btn-outline-success" style="padding:3px;height:30px;width:100px;margin-left:20px;" type="button" id="sendToExcel">
                                        <i class="fa-solid fa-upload fa-fw fa-lg "></i>EXCEL
                                    </button>
                                    <a class="btn btn-sm btn-outline-danger" style="padding:3px;height:30px;width:100px;margin-left:20px;" asp-controller="RCRegister" asp-action="RCRegister">
                                        <i class="fa-solid fa-rotate fa-fw fa-lg"></i>RESET
                                    </a>
                                </div>
                            </div>
                            <div class="progress my-2 mb-3" style="height: 4px;">
                                <div class="progress-bar progress-bar-striped bg-secondary progress-bar-animated" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="H_SAGrid">
                                    <button class="accordion-button text-light pnl4BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_SAGrid" aria-expanded="true" aria-controls="B_SAGrid">
                                        <strong style="text-transform:uppercase" id="ItemHeading"><i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;"></i>Issue Challan Grid</strong>
                                    </button>
                                </h2>
                                <div id="B_SAGrid" class="accordion-collapse collapse pnl4 bg-gradient show" aria-labelledby="H_SAGrid">
                                    <div class="accordion-body">
                                        <div class="card-body" id="divPendingMRP">
                                            <div class="row">
                                                <div class="col-md-12" id="divRCRegister">
                                                    <partial name="_VenderJWReceiveGrid" />
                                                    <partial name="_VenderJWIssueChallanGrid" />
                                                    <partial name="_VendorRecoIssueReceiveGrid" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" id="TOTALRecDetail">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Bill Qty</label>
                                                <input id="TotalBillQtyforRec" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Rec Qty</label>
                                                <input id="TotalRecQtyforRec" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Amount</label>
                                                <input id="TotalAmountForRec" class="form-control" readonly />
                                            </div>
                                        </div>
                                        <div class="row" id="TOTALRecSummary">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Amount</label>
                                                <input id="TotalAmountForRecSummary" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Net Amount</label>
                                                <input id="NetAmountForRecSummary" class="form-control" readonly />
                                            </div>                                          
                                        </div>
                                        <div class="row" id="TOTALIssueChallanSummary">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Amount</label>
                                                <input id="TotalIssueAmount" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Net Amount</label>
                                                <input id="NetIssueAmount" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Weight Amount</label>
                                                <input id="WeighIssueAmount" class="form-control" readonly />
                                            </div>
                                        </div>
                                        <div class="row" id="TOTALIssueChallanDetail">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Issue Qty</label>
                                                <input id="TotalIssueQtyDetail" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Pend Qty</label>
                                                <input id="TotalPendQtyDetail" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Amount</label>
                                                <input id="TotalIssueDetailAmount" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Weight Amount</label>
                                                <input id="WeightDetailAmount" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Net Amount</label>
                                                <input id="NetIssueDetailAmount" class="form-control" readonly />
                                            </div>
                                        </div>
                                        <div class="row" id="TOTALIssueChallanItemParty">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Issue Qty</label>
                                                <input id="TotalIssueQtyItemParty" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Pend Qty</label>
                                                <input id="TotalPendQtyItemParty" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Amount</label>
                                                <input id="TotalIssueItemPartyAmount" class="form-control" readonly />
                                            </div>
                                        </div>
                                        <div class="row" id="TOTALRecoDetail">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Issue Qty</label>
                                                <input id="TotalRecoIssueQty" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Pend Qty</label>
                                                <input id="TotalRecoPendQty" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Rec Qty</label>
                                                <input id="TotalRecorecQty" class="form-control" readonly />
                                            </div>
                                        </div>
                                        <div class="row" id="TOTALRecoSummary">
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Issue Qty</label>
                                                <input id="TotalIssueRecoQty" class="form-control" readonly />
                                            </div>
                                            <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                                <label class="form-label">Total Rec Qty</label>
                                                <input id="TotalRecRecoQty" class="form-control" readonly />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<style>
    .color-box {
        width: 10px;
        height: 10px;
    }
</style>
@section Scripts{
    <script>
        

        $(document).ready(function () {
            GetServerDate();
            $('#ReportMode').select2();
            AutoComplete('Account_Head_Master', 'PartyName', 'Account_Name', null);
            AutoComplete('VJobworkIssueMainDetail', 'IssueChallanNo', 'JWChallanNo', null);
            AutoComplete('VItemMaster', 'PartCode', 'PartCode', null);
            AutoComplete('VItemMaster', 'ItemName', 'Item_Name', null);

            document.getElementById('IssNo').style.display = 'none';
        $('#ReportMode').append('<option data-info="JWRecDe" selected value="JOBWORKReceiveDETAIL">JobWork Receive Detail</option>\
                                                                           <option data-info="JWRecSum" value="JOBWORKReceiveSUMMARY">Jobwork Receive Summary</option>\
                                                                          <option data-info="JWRecDeadj" value="JOBWORKReceiveWithAdjustemntDETAIL">Jobwork Receive with Adjustment Detail   </option>\
                                                                          <option data-info="JWRecItem" value="JOBWORKReceiveItemWiseSUMM">Jobwork Receive Item Wise Sum</option>\
                                                        ');
        $('#TOTALRecDetail').show();
        $('#TOTALRecSummary').hide();
        $('#TOTALIssueChallanSummary').hide();
        $('#TOTALIssueChallanDetail').hide();
        $('#TOTALIssueChallanItemParty').hide();
        $('#TOTALRecoDetail').hide();
        $('#TOTALRecoSummary').hide();
        $('#ItemHeading').text('');
        $('#ItemHeading').text('JobWork Receive Detail Grid');
            GetRCRegisterData();

            $('#ReportMode').change(function () {
                var selectedValue = $(this).val();
                if (selectedValue === 'JOBWORKReceiveDETAIL') {
                    $('#TOTALRecDetail').show();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Receive Detail Grid');
                }
                else if (selectedValue === 'JOBWORKReceiveItemWiseSUMM') {
                    $('#TOTALRecDetail').show();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Receive Item Wise Sum Grid');
                }
                else if (selectedValue === 'JOBWORKReceiveSUMMARY') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').show();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Receive Summary Grid');
                }
                else if (selectedValue === 'JOBWORKReceiveWithAdjustemntDETAIL') {
                    $('#TOTALRecDetail').show();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Receive Adjustment Detail Grid');
                }
                else if (selectedValue === 'JOBWORKISSUECHALLANSUMMARY') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').show();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Issue Challan Summary Grid');
                }
                else if (selectedValue === 'JOBWORKISSUECHALLANITEMDETAIL') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').show();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Issue Challan Detail Grid');
                }
                else if (selectedValue === 'JOBWORKISSUEITEMDETAIL') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').show();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Issue Item Detail Grid');
                }
                else if (selectedValue === 'JOBWORKISSUEPatyITEMDETAIL') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').show();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Issue Party Detail Grid');
                }
                else if (selectedValue === 'JOBWORKRecoDETAIL') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').show();
                    $('#TOTALRecoSummary').hide();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Reco Detail Grid');
                }
                else if (selectedValue === 'JOBWORKRecoSummary') {
                    $('#TOTALRecDetail').hide();
                    $('#TOTALRecSummary').hide();
                    $('#TOTALIssueChallanSummary').hide();
                    $('#TOTALIssueChallanDetail').hide();
                    $('#TOTALIssueChallanItemParty').hide();
                    $('#TOTALRecoDetail').hide();
                    $('#TOTALRecoSummary').show();
                    $('#ItemHeading').text('');
                    $('#ItemHeading').text('JobWork Reco Summary Grid');
                } 
            });
        });

        function DeleteRow(i) {
            var indexToRemove = i - 1;
            $('#SAGridRow-' + i).remove();
            $('#ReportTable tbody tr').each(function (index) {
                $(this).attr('id', 'SAGridRow-' + (index + 1));
                $(this).find('td:first-child a:first-child').each(function (tdIndex) {
                    $(this).attr('id', (index + 1));
                });
            });
            //$('#ReportTable tr:eq(' + indexToRemove + ')').remove();
            $('#totalRows').text($('#divStockRegisterBody tr').length - 1);
            countAllTotal();
        }

        function FreezeSelection(Currentrow) {

            FillColorAccordingPendQty();
            $(Currentrow).css({ 'background-color': '#00bcd4' });
        }

        function countAllTotal() {
            var Rowcount = 0;
            if ($('#divStockRegisterBody tr td').length > 1) {
                Rowcount = $('#divStockRegisterBody tr').length;
            } else {
                Rowcount = 0;
            }
            $('#TotalBillQtyforRec').val(0);
            $('#TotalRecQtyforRec').val(0);
            $('#TotalAmountForRec').val(0);
            $('#NetAmountForRecSummary').val(0);
            $('#TotalAmountForRecSummary').val(0);
            $('#TotalIssueAmount').val(0);
            $('#NetIssueAmount').val(0);
            $('#WeighIssueAmount').val(0);
            $('#TotalIssueQtyDetail').val(0);
            $('#TotalPendQtyDetail').val(0);
            $('#TotalIssueDetailAmount').val(0);
            $('#WeightDetailAmount').val(0);
            $('#NetIssueDetailAmount').val(0);
            $('#TotalIssueQtyItemParty').val(0);
            $('#TotalPendQtyItemParty').val(0);
            $('#TotalIssueItemPartyAmount').val(0);
            $('#TotalRecoIssueQty').val(0);
            $('#TotalRecoPendQty').val(0);
            $('#TotalRecorecQty').val(0);
            $('#TotalIssueRecoQty').val(0);
            $('#TotalRecRecoQty').val(0);
            var BillQty = 0;
            var RecQty = 0;
            var TotalAmountForrecSummary=0;
            var TotalAmount=0;
            var NetAmountForRecSummary=0;
            var TotalAmountForRecSummary
           var TotalIssueAmount = 0;
           var NetIssueAmount = 0;
           var WeighIssueAmount=0;
           var TotalIssueQtyDetail= 0;
           var TotalPendQtyDetail= 0;
           var TotalIssueDetailAmount= 0;
           var WeightDetailAmount =0;
           var NetIssueDetailAmount= 0;
           var TotalIssueQtyItemParty= 0;
           var TotalPendQtyItemParty= 0;
           var TotalIssueItemPartyAmount= 0;
           var TotalRecoIssueQty= 0;
           var TotalRecoPendQty= 0;
           var TotalRecorecQty= 0;
           var TotalIssueRecoQty= 0;
           var TotalRecRecoQty= 0;
            
            for (i = 1; i <= Rowcount; i++) {
                BillQty += $('#SAGridRow-' + i).find('#GridBillQty').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridBillQty').text());
                RecQty += $('#SAGridRow-' + i).find('#GridRecQty').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridRecQty').text());
                TotalAmount += $('#SAGridRow-' + i).find('#GridTotalAmount').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridTotalAmount').text());
                TotalAmountForrecSummary += $('#SAGridRow-' + i).find('#GridTotalAmountForSummary').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridTotalAmountForSummary').text());
                NetAmountForRecSummary += $('#SAGridRow-' + i).find('#GridNetAmount').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridNetAmount').text());
                TotalIssueAmount += $('#SAGridRow-' + i).find('#GridTotalAmountIssSum').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridTotalAmountIssSum').text());
                NetIssueAmount += $('#SAGridRow-' + i).find('#GridNetAmountIssSum').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridNetAmountIssSum').text());
                WeighIssueAmount += $('#SAGridRow-' + i).find('#GridTotalWeightIssSum').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#GridTotalWeightIssSum').text());
                TotalIssueQtyDetail += $('#SAGridRow-' + i).find('#TotalIssueQtyChallan').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalIssueQtyChallan').text());
                TotalPendQtyDetail += $('#SAGridRow-' + i).find('#TotalPendQtyChallan').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalPendQtyChallan').text());
                TotalIssueDetailAmount += $('#SAGridRow-' + i).find('#TotalAmountChallan').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalAmountChallan').text());
                WeightDetailAmount += $('#SAGridRow-' + i).find('#TotalWeightAmountChallan').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalWeightAmountChallan').text());
                NetIssueDetailAmount += $('#SAGridRow-' + i).find('#TotalNetamountChallan').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalNetamountChallan').text());
                TotalIssueQtyItemParty += $('#SAGridRow-' + i).find('#TotalIssQtyItem').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalIssQtyItem').text());
                TotalPendQtyItemParty += $('#SAGridRow-' + i).find('#TotalPendQtyItem').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalPendQtyItem').text());
                TotalIssueItemPartyAmount += $('#SAGridRow-' + i).find('#TotalAmountItem').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalAmountItem').text());
                TotalRecoIssueQty += $('#SAGridRow-' + i).find('#TotalIssQtyReco').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalIssQtyReco').text());
                TotalRecoPendQty += $('#SAGridRow-' + i).find('#TotalPendQtyReco').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalPendQtyReco').text());
                TotalRecorecQty += $('#SAGridRow-' + i).find('#TotalRecQtyReco').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#TotalRecQtyReco').text());
                TotalIssueRecoQty += $('#SAGridRow-' + i).find('#IssQtyrecoTotal').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#IssQtyrecoTotal').text());
                TotalRecRecoQty += $('#SAGridRow-' + i).find('#PenQtyrecototal').text() == '' ? 0 : parseFloat($('#SAGridRow-' + i).find('#PenQtyrecototal').text());
            }
            $('#TotalBillQtyforRec').val(BillQty);
            $('#TotalRecQtyforRec').val(RecQty);
            $('#TotalAmountForRec').val(TotalAmount.toFixed(2));
            $('#NetAmountForRecSummary').val(NetAmountForRecSummary);
            $('#TotalAmountForRecSummary').val(TotalAmountForrecSummary);
            $('#TotalIssueAmount').val(TotalIssueAmount);
            $('#NetIssueAmount').val(NetIssueAmount);
            $('#WeighIssueAmount').val(WeighIssueAmount);
            $('#TotalIssueQtyDetail').val(TotalIssueQtyDetail);
            $('#TotalPendQtyDetail').val(TotalPendQtyDetail);
            $('#TotalIssueDetailAmount').val(TotalIssueDetailAmount);
            $('#WeightDetailAmount').val(WeightDetailAmount);
            $('#NetIssueDetailAmount').val(NetIssueDetailAmount);
            $('#TotalIssueQtyItemParty').val(TotalIssueQtyItemParty);
            $('#TotalPendQtyItemParty').val(TotalPendQtyItemParty);
            $('#TotalIssueItemPartyAmount').val(TotalIssueItemPartyAmount);
            $('#TotalRecoIssueQty').val(TotalRecoIssueQty);
            $('#TotalRecoPendQty').val(TotalRecoPendQty);
            $('#TotalRecorecQty').val(TotalRecorecQty);
            $('#TotalIssueRecoQty').val(TotalIssueRecoQty);
            $('#TotalRecRecoQty').val(TotalRecRecoQty);
        }

        //$('#RGPNRGP').change(function () {
        //    FillChallanType();
        //});

        //function FillChallanType() {
        //    var RGPNRGP = $('#RGPNRGP').val();
        //    $.ajax({
        //        type: "GET",
        //        url: "@Url.Action("FillChallanType","NRGP")",
        //        data: { "RGPNRGP": RGPNRGP },
        //        dataType: "json",
        //        ayns: false,
        //        success: function (result, status, error) {
        //            if (result != null) {
        //                var obj = $.parseJSON(result);
        //                if (obj.StatusCode == 200 && obj.StatusText == 'Success') {

        //                    $('#IssueChallanType').empty();
        //                    $('#IssueChallanType').append('<option value="">-Select-</option>');
        //                    $(obj.Result).each(function (index, val) {
        //                        $('#IssueChallanType').append('<option value="' + val.ChallanType + '">' + val.ChallanType + '</option>');
        //                    });

        //                } else {

        //                }

        //            }
        //        }
        //    });
        //}

        function FillColorAccordingPendQty() {
            var Rowcount = $('#divStockRegisterBody tr').length;
            for (i = 1; i <= Rowcount; i++) {
                if (parseFloat($('#GridPendQty-' + i).text()) == 0) {
                    $('#SAGridRow-' + i).css({ 'background-color': '#f3dea1' });
                    $('#StickyHearder-' + i).css({ 'background-color': '#f3dea1' });
                } else {
                    $('#SAGridRow-' + i).css({
                        'background-color': 'rgb(158 225 149)'
                    });
                    $('#StickyHearder-' + i).css({
                        'background-color': 'rgb(158 225 149)'
                    });
                }
            }
        }

        $('#IssueChallanType').change(function () {
             
            if ($('#IssueChallanType').val() == 'ISSUE') 
            {
                document.getElementById('RecNo').style.display = 'none';
                document.getElementById('IssNo').style.display = 'block';
                $('#ReportMode').empty();
                $('#ReportMode').append('<option data-info="JWIssSum" value="JOBWORKISSUECHALLANSUMMARY">JobWork Issue Challan Summary</option>\
                                                  <option data-info="JWIssDe" value="JOBWORKISSUECHALLANITEMDETAIL">JobWork Issue Challan Detail</option>\
                                                  <option data-info="JWIssChaSum" value="JOBWORKISSUEITEMDETAIL">JobWork Issue Item Detail</option>\
                                                  <option data-info="JWIssChaDe" value="JOBWORKISSUEPatyITEMDETAIL">JobWork Issue Party Detail</option>\
                                        ');
                $('#TOTALRecDetail').hide();
                $('#TOTALRecSummary').hide();
                $('#TOTALIssueChallanSummary').show();
                $('#TOTALIssueChallanDetail').hide();
                $('#TOTALIssueChallanItemParty').hide();
                $('#TOTALRecoDetail').hide();
                $('#TOTALRecoSummary').hide();
                $('#ItemHeading').text('');
                $('#ItemHeading').text('JobWork Issue Challan Summary Grid');

            } 
            else if ($('#IssueChallanType').val() == 'REC') 
            {
                document.getElementById('IssNo').style.display = 'none';
                document.getElementById('RecNo').style.display = 'block';
                $('#ReportMode').empty();
                $('#ReportMode').append('<option data-info="JWRecDe" selected value="JOBWORKReceiveDETAIL">JobWork Receive Detail</option>\
                                                                   <option data-info="JWRecSum" value="JOBWORKReceiveSUMMARY">Jobwork Receive Summary</option>\
                                                                  <option data-info="JWRecDeadj" value="JOBWORKReceiveWithAdjustemntDETAIL">Jobwork Receive with Adjustment Detail   </option>\
                                                                  <option data-info="JWRecItem" value="JOBWORKReceiveItemWiseSUMM">Jobwork Receive Item Wise Sum</option>\
                                                ');
                $('#TOTALRecDetail').show();
                $('#TOTALRecSummary').hide();
                $('#TOTALIssueChallanSummary').hide();
                $('#TOTALIssueChallanDetail').hide();
                $('#TOTALIssueChallanItemParty').hide();
                $('#TOTALRecoDetail').hide();
                $('#TOTALRecoSummary').hide();
                $('#ItemHeading').text('');
                $('#ItemHeading').text('JobWork Receive Detail Grid');

            } 
            else if ($('#IssueChallanType').val() == 'RECO') 
            {
                document.getElementById('IssNo').style.display = 'block';
                document.getElementById('RecNo').style.display = 'block';
                $('#ReportMode').empty();
                $('#ReportMode').append('<option data-info="JWRecoDetail" selected value="JOBWORKRecoDETAIL">JobWork Reco Detail</option>\
                                                 <option data-info="JWRecoIssue" value="JOBWORKRecoSummary">JobWork Reco Issue</option>\
                ');
                $('#TOTALRecDetail').hide();
                $('#TOTALRecSummary').hide();
                $('#TOTALIssueChallanSummary').hide();
                $('#TOTALIssueChallanDetail').hide();
                $('#TOTALIssueChallanItemParty').hide();
                $('#TOTALRecoDetail').show();
                $('#TOTALRecoSummary').hide();
                $('#ItemHeading').text('');
                $('#ItemHeading').text('JobWork Reco Detail Grid');
            }
            GetRCRegisterData();
        });

        function GetRCRegisterData() {
              
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetJWRegisterData")",
                async: false,
                data: { FromDate: $('#FromDate').val(), ToDate: $('#ToDate').val(), PartyName: $('#PartyName').val(), PartCode: $('#PartCode').val(), ItemName: $('#ItemName').val(), IssueChallanType: $('#IssueChallanType').val(), ReportMode: $('#ReportMode').val(), IssChallanNo: $('#IssueChallanNo').val(), RecChallanNo: $('#RecChallanNo').val() },
                success: function (result, status, error) {
                     
                    $('#divRCRegister').empty();
                    $('#divRCRegister').html(result);
                    $('#totalRows').text($('#divRCRegister tr').length - 1);
                    countAllTotal();
                }
            });
        }

        $('#sendToExcel').click(function () {
            let table = $("#ReportTable");
             (table);
            TableToExcel.convert(table[0], {
                name: `ReportTable.xlsx`,
                sheet: {
                    name: 'ReportTable'
                }
            });
        });

        function GetServerDate() {
            $.ajax({
                type: "GET",
                url: "@Url.Action("GetServerDate","SaleOrder")",
                async: false,
                success: function (result, status, error) {
                     (result);
                    if (result != null) {

                        var firstDayOfMonth = getFirstDayOfMonth(result);
                        $('#FromDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", firstDayOfMonth);
                        $('#ToDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", result);

                    }
                }
            });
        }

        function getFirstDayOfMonth(dateString) {
            const [day, month, year] = dateString.split('/');

            const currentDate = new Date(year, month - 1, day);

            currentDate.setDate(1);

            const firstDayOfMonth = `${currentDate.getDate().toString().padStart(2, '0')}/${(currentDate.getMonth() + 1).toString().padStart(2, '0')}/${currentDate.getFullYear()}`;

            return firstDayOfMonth;
        }


        var currentSearchColumn = null;
        $(document).on("click", "th[data-columnno]", function () {
            currentSearchColumn = $(this).data('columnno');
            $("#search-box").val('').trigger('keyup');
        });

        $("#search-box").on("keyup", function () {

            var value = $(this).val().toLowerCase();
            $("#divStockRegisterBody tr").filter(function () {
                if (currentSearchColumn !== null) {
                    var columnText = $(this).find('td').eq(currentSearchColumn).text().toLowerCase();
                    $(this).toggle(columnText.indexOf(value) > -1);
                } else {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
                }
            });
            countAllTotal();
            $('#totalRows').text($('#divStockRegisterBody tr').length - 1);
        });


        $(document).on("click", ".sortCol", function () {
            var $column = $(this).parent().closest("th");
            var colno = $(this).data('columnno');
            var currentOrder = $(this).data('sortorder');

            $('.sortCol').css('color', 'white');

            if (currentOrder === 'asc') {
                sortTable('ReportTable', colno, false);
                $(this).data('sortorder', 'desc');
                $(this).css('color', 'yellow'); // Visual indication of descending order
                //$(this).css('font-size', 'larger'); // Visual indication of descending order
                $(this).find('i:first').removeClass('fa-arrow-up');
                $(this).find('i:first').addClass('fa-arrow-down');
            } else {
                sortTable('ReportTable', colno, true);
                $(this).data('sortorder', 'asc');
                $(this).css('color', 'yellow');
                // $(this).css('font-size', 'larger'); // Visual indication of ascending order
                $(this).find('i:first').removeClass('fa-arrow-down');
                $(this).find('i:first').addClass('fa-arrow-up');
            }
        });



    </script>
    <script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>

}
