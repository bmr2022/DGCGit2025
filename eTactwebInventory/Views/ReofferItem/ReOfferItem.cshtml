@model eTactWeb.DOM.Models.ReOfferItemModel

@{
    ViewData["Title"] = "Reoffer Item";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

<style>
    .disabled-link {
        pointer-events: none; /* Disables clicking */
        color: gray; /* Makes it look disabled */
        text-decoration: none; /* Removes underline */
        cursor: not-allowed; /* Changes cursor */
    }

    .custom-input {
        width: 120%; /* Adjust the width as needed */
        max-width: 500px; /* Adjust the max-width as needed */
    }


    .select2-container--default .select2-selection--single {
        background-color: #e0f2f1;
        border: 1.5px solid #0a0a0a !important;
        border-radius: 4px;
    }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            /* border-bottom: 1.5px solid #000 !important; */
            border-bottom: none !important;
        }

    .select2-container--default .select2-results > .select2-results__options {
        background-color: #e0f2f1; /* Dropdown background color */
        color: #000;
</style>

<div class="card bg-gradient mb-3 border-light shadow-lg">
    <form asp-action="ReOfferItem" autocomplete="off" class="form-horizontal">
        <div class="card-header card-headerBG text-light bg-gradient">
            <h5>
                <strong>Reoffer Item</strong>
                <span class="d-flex float-end" style="margin-top:-2px;">
                    @*<a asp-action="Dashboard" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">*@
                    <a asp-action="ReOfferItemDashBoard" asp-route-ID="0" class="btn btn-secondary btn-sm DashBoard">
                        <i class="fa-duotone fa-grid-horizontal fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>
                        Dashboard
                    </a>
                    <div class="row justify-content-between g-2">
                        <div class="col-auto">
                            <input asp-for="FromDateBack" type="hidden" value="@Model.FromDateBack" />
                            <input asp-for="ToDateBack" type="hidden" value="@Model.ToDateBack" />
                            <input asp-for="SlipNoBack" type="hidden" value="@Model.SlipNoBack" />
                            <input asp-for="PartCodeBack" type="hidden" value="@Model.PartCodeBack" />
                            <input asp-for="ItemNameBack" type="hidden" value="@Model.ItemNameBack" />
                            <input asp-for="BatchNoback" type="hidden" value="@Model.BatchNoback" />
                            <input asp-for="GlobalSearchBack" type="hidden" value="@Model.GlobalSearchBack" />
                            <input asp-for="DashboardTypeBack" type="hidden" value="@Model.DashboardTypeBack" />
                            @*<a href="#" class="btn offer-listbtn hvr-sweep-to-right btn-sm btn-secondary" onclick="back();">*@
                            <a href="#" class=" btn btn-primary btn-sm" onclick="PressBack();">
                                <i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>
                                BACK
                            </a>
                        </div>
                        @if (Model.Mode != "V" && Model.Mode != "SOC" && Model.Mode != "POC")
                        {
                            <div class="col-auto">
                                @*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
                                <a class="btn btn-secondary btn-sm" onclick="location.href=$('form')[0].action">
                                    @* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
                                    <i class="fa fa-refresh fa-fw fa-lg" aria-hidden="true"></i>
                                    REFRESH
                                </a>
                            </div>
                            @if (Model.Mode == "U")
                            {
                                @*Model.Mode = "U";*@
                                <div class="col-auto">
                                    @* <button type="submit" class="btn btn-sm btn-outline-warning">*@
                                    <button type="submit" class="btn btn-sm btn-outline-light bg-gradient" id="UpdateButton">
                                        <i class="fa fa-pencil-square fa-fw fa-lg" aria-hidden="true"></i>
                                        UPDATE
                                    </button>
                                </div>
                            }

                            else
                            {
                                <div class="col-auto">
                                    @*   <button type="submit" class="btn btn-sm btn-outline-primary">*@
                                    <button type="submit" class="btn btn-primary btn-sm" id="submitBTN">
                                        <i class="fa-solid fa-chevron-circle-right"></i>
                                        SUBMIT
                                    </button>
                                </div>
                            }
                        }
                    </div>
                    @* <partial name="_FormsButton" />*@
                </span>
            </h5>
        </div>
        <div>
        </div>
        <div class="card-body bg-light pt-0">
            <div class="accordion shadow-lg">
                <div class="accordion-item" id="GI_Grid">
                    <h2 class="accordion-header" id="H_RParameter">
                        <button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_RParameter" aria-expanded="true" aria-controls="B_RParameter">
                            <i class="fa-brands fa-wpforms fa-lg fa-fw pr35"></i>
                            Required Parameter
                        </button>
                    </h2>
                    <div id="B_RParameter" class="accordion-collapse collapse show pnl1 bg-gradient" aria-labelledby="H_RParameter">
                        <div class="accordion-body">
                            <div class="row g-2 gx-3 align-items-center">
                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12" style="width = 50%">
                                    <input type="hidden" value="@Model.FinFromDate" asp-for="FinFromDate" />
                                    <input type="hidden" value="@Model.FinToDate" asp-for="FinToDate" />
                                    <input type="hidden" value="@Model.Mode" asp-for="Mode" />
                                    <input type="hidden" asp-for="SeqNo" id="hiddenSeqNo" />
                                    <input type="hidden" id="AddPassWord" />
                                    <input type="hidden" id="ShowAllStore" />
                                    @* <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12"> *@
                                    @* class="col-xl-2 col-lg-3 col-md-3 col-sm-3 col-xs-12" *@
                                    <label asp-for="ReofferEntryId" class="form-label" style="color: blue;">Entry ID</label>
                                    <input asp-for="ReofferEntryId" class="form-control" readonly />
                                </div>
                                @* <div class="col-lg"> *@
                                <div class="col-xl-1 col-lg-4 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="ReofferEntrydate" class="form-label" style="color: blue;">Entry Date</label>
                                    <input asp-for="ReofferEntrydate" class="form-control" readonly />
                                </div>
                                <div class="col-xl-1 col-lg-4 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="ReofferYearcode" class="form-label" style="color: blue;">Year Code</label>
                                    <input asp-for="ReofferYearcode" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="ReofferNo" class="form-label" style="color: blue;">ReofferNo</label>
                                    <input asp-for="ReofferNo" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>

                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                    <label asp-for="QcType" class="control-label" style="color: red;"> QcType </label>
                                    <select class="form-select" asp-for="QcType">
                                            <option value="">-Select-</option>
                                        </select>
                                    
                                </div>
                                 <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                    <label asp-for="MRNNO" class="control-label" style="color: red;"> MRN No </label>
                                    <select class="form-select" asp-for="MRNNO">
                                            <option value="">-Select-</option>
                                        </select>
                                    
                                </div>
                                
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                    <label asp-for="MIRNo" class="control-label" style="color: red;"> MIR No </label>
                                    <select class="form-select" asp-for="MIRNo">
                                            <option value="">-Select-</option>
                                        </select>
                                    
                                </div>

                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">

                                    <label asp-for="MIRYearCode" class="control-label" style="color: red;"> MIRYearCode </label>
                                    <select class="form-select" asp-for="MIRYearCode">
                                        <option value="">-Select-</option>
                                    </select>
                                    
                                </div>

                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="MirEntryid" class="form-label" style="color: blue;">MirEntryid</label>
                                    <input asp-for="MirEntryid" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>

                                 <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="MIRDate" class="form-label" style="color: blue;">MIRDate</label>
                                    <input asp-for="MIRDate" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>
                                
                                
                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="MrnYearCode" class="form-label" style="color: blue;">MrnYearCode</label>
                                    <input asp-for="MrnYearCode" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>
                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="MRNDate" class="form-label" style="color: blue;">MRNDate</label>
                                    <input asp-for="MRNDate" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="BillNo" class="form-label" style="color: blue;">BillNo</label>
                                    <input asp-for="BillNo" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>
                                <div class="col-xl-1 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="BillDate" class="form-label" style="color: blue;">BillDate</label>
                                    <input asp-for="BillDate" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="AccountCode" class="form-label" style="color: blue;">AccountName</label>
                                    <input asp-for="AccountName" class="form-control" readonly style="background-color: lightblue !important;" />

                                    <input asp-for="AccountCode" type="hidden" class="form-control" readonly style="background-color: lightblue !important;" />
                                </div>

                               

                            </div>

                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="H_SAGrid">
                        <button class="accordion-button collapsed text-light pnl4BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_SAGrid" aria-expanded="true" aria-controls="B_SAGrid">
                            <strong style="text-transform:uppercase"><i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;"></i>Item Detail Grid</strong>
                        </button>
                    </h2>

                    <div id="B_SAGrid" class="accordion-collapse collapse pnl4 bg-gradient" aria-labelledby="H_SAGrid">
                        <div class="accordion-body">
                            <div class="row g-2 gx-3" id="_ItemGrid">
                            </div>
                            <div class="progress my-2 mb-3" style="height: 4px;">
                                <div class="progress-bar progress-bar-striped bg-secondary progress-bar-animated" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                          
                                                        <div class="card" id="firstGrid">
                                <div class="card-body overflow-auto pb-0">
                                    <table class="table table-hover table-bordered table-striped" id="TableGrid">
                                        <thead class="bg-gradient card-headerBG text-light small" style="white-space:nowrap" id="GridLabels">
                                            <tr>
                                               <th>Sr No</th>
                                               <th>Action</th>
                                                <th>PartCode</th>
                                                <th>ItemName</th>
                                                
                                                
                                                <th>BillQty</th>
                                                <th>RecQty</th>
                                                <th>AltRecQty</th>
                                                <th>PrevAccQty</th>
                                                <th>AccQty</th>
                                                <th>AltAccQty</th>
                                               
                                                <th>OkRecStore &nbsp;<input id="SHA1" class="form-check-input me-1 mt-2" type="checkbox" role="switch" />
                                                            
                                                                <button type="button" class="btn btn-sm  BtnPassword" style="margin-top:10px;background-color:beige">
                                                                    
                                                                    <i class="bi bi-lock"></i>
                                                                </button>
                                                            
                                                        </th>
                                                         <th>PrevRejQty</th>
                                                <th>RejQty</th>
                                                <th>AltRejQty</th>
                                               

                                                <th>RejRecStore<input id="SHA2" class="form-check-input me-1 mt-2" type="checkbox" role="switch" /></th>
                                                <th>PrevHoldQty</th>
                                                <th>HoldQty </th>
                                                

                                              
                                                <th>HoldStore<input id="SHA3" class="form-check-input me-1 mt-2" type="checkbox" role="switch" /></th>
                                              
                                                <th>PrevReworkqty</th>
                                                <th>Reworkqty</th>
                                               
                                               
                                                <th>RewokStore<input id="SHA4" class="form-check-input me-1 mt-2" type="checkbox" role="switch" /></th>
                                                <th>PrevDeviationQty</th>
                                                <th>DeviationQty</th>
                                                <th>ResponsibleEmpForDeviation</th>
                                               <th>ApprovedByEmp<input id="SHA5" class="form-check-input me-1 mt-2" type="checkbox" role="switch" /></th>
                                                  <th>Process</th>
                                                <th>BatchNo</th>
                                                <th>uniqueBatchno</th>
                                                <th>Rate</th>
                                                <th>rateinother</th>
                                                <th>Remarks</th>
                                                <th>Unit</th>
                                                <th>AltUnit</th>
                                                <th>Defaulttype</th>
                                                
                                                <th>Color</th>
                                                <th>ItemSize</th>
                                                <th>ResponsibleFactor</th>
                                                <th>SupplierBatchno</th>
                                                <th>shelfLife</th>
                                               
                                                <th>AllowDebitNote</th>
                                                 <th>PrevOkRecStore</th>
                                                  <th>PrevRejRecStore</th>
                                                  <th>PrevHoldStore </th>
                                                   <th>PrevRewokStore</th>
                                                   
                                                <th>AccLotStock</th>
                                                <th>RejLotStock</th>
                                                <th>HoldLotStock</th>
                                                <th>ReworkLotStock</th>
                                                
                                                <th>PONo</th>
                                                <th>POYearCode</th>
                                                <th>PODate</th>
                                                <th>SchNo</th>
                                                <th>SchYearCode</th>
                                                <th>schdate</th>
                                                <th>FilePath</th>
                
                                            </tr>
                                        </thead>
                                         <tbody id="DivDetailGrid">
                                        </tbody>
                                    </table>
                                </div>
                            </div>





                            <div class="progress my-3 mb-3" style="height: 4px;">
                                <div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>

                            <div class="d-flex justify-content-between">
                                <div class="col-md-2">
                                    <input type="text" class="form-control" id="search-box" placeholder="Search..." style="background-color:#FFFACD;">
                                </div>
                                <div class="col-md-2" id="firstButton">
                                    <button type="button" style="display:none" class="GridButton btn btn-sm btn-outline-danger mt-1 mb-1" >
                                        <i class="fa-duotone fa-angle-double-down fa-fw fa-lg"></i> ADD TO GRID
                                    </button>
                                    <button type="button" class="GridButton1 btn btn-sm btn-outline-danger mt-1 mb-1" >
                                        <i class="fa-duotone fa-angle-double-down fa-fw fa-lg"></i> ADD TO GRID
                                    </button>
                                </div>
                                
                            </div>
                                                        <div class="card">
                                <div class="card-body overflow-auto pb-0">
                                    <table class="table table-hover table-bordered table-striped IssueNRGPTb">
                                        <thead class="bg-gradient card-headerBG text-light small" style="white-space:nowrap">
                                            <tr>
                                                <th>Action</th>
                                                <th>SR#</th>
                                                <th data-columnno="1" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PartCode</th>
<th data-columnno="2" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ItemName</th>


<th data-columnno="11" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>BillQty</th>
<th data-columnno="12" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>RecQty</th>
<th data-columnno="13" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AltRecQty</th>
<th data-columnno="14" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PrevAcceptedQty</th>
<th data-columnno="15" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AcceptedQty</th>
<th data-columnno="16" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AltAcceptedQty</th>
<th data-columnno="17" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>OkRecStore</th>
<th data-columnno="20" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PreviousRejectedQty</th>
<th data-columnno="21" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>RejectedQty</th>
<th data-columnno="22" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AltRejectedQty</th>
<th data-columnno="23" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>RejRecStore</th>
<th data-columnno="27" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PreviousHoldQty</th>
<th data-columnno="28" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>HoldQty</th>
<th data-columnno="29" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>HoldStore</th>
<th data-columnno="31" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PreviousReworkqty</th>
<th data-columnno="32" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Reworkqty</th>
<th data-columnno="33" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>RewokStore</th>
<th data-columnno="33" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PrevDeviationQty</th>
<th data-columnno="18" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>DeviationQty</th>
<th data-columnno="19" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ResponsibleEmpForDeviation</th>
<th data-columnno="30" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ProcessId</th>
<th data-columnno="39" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>BatchNo</th>
<th data-columnno="40" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>uniqueBatchno</th>
<th data-columnno="42" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Rate</th>
<th data-columnno="43" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>rateinother</th>
<th data-columnno="24" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Remarks</th>
<th data-columnno="9" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Unit</th>
<th data-columnno="10" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AltUnit</th>
<th data-columnno="25" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Defaulttype</th>
<th data-columnno="26" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ApprovedByEmp</th>

<th data-columnno="34" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>Color</th>
<th data-columnno="35" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ItemSize</th>
<th data-columnno="36" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ResponsibleFactor</th>
<th data-columnno="37" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>SupplierBatchno</th>
<th data-columnno="38" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>shelfLife</th>

<th data-columnno="41" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AllowDebitNote</th>
<th data-columnno="16" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PrevOkRecStore</th>
<th data-columnno="22" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PrevRejRecStore</th>
<th data-columnno="28" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PrevHoldStore</th>
<th data-columnno="32" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PrevRewokStore</th>
<th data-columnno="32" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>AccLotStock</th>
<th data-columnno="32" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>RejLotStock</th>
<th data-columnno="32" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>HoldLotStock</th>
<th data-columnno="32" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>ReworkLotStock</th>

<th data-columnno="3" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PONo</th>
<th data-columnno="4" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>POYearCode</th>
<th data-columnno="5" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>PODate</th>
<th data-columnno="6" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>SchNo</th>
<th data-columnno="7" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>SchYearCode</th>
<th data-columnno="8" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>schdate</th>
<th data-columnno="44" data-sortorder="asc" class="sortCol"><span style="padding:5px;margin:5px" class="sort-icon"><i class="fa" aria-hidden="true"></i></span>FilePath</th>

                                            </tr>
                                        </thead>
                                        <tbody id="divISTGrid">
                                            <partial name="_ReOfferItemGrid" />
                                        </tbody>
                                    </table>
                                </div>
                            </div>


                           
                        </div>


                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="HPanel2">
                        <button class="accordion-button collapsed text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#ODGrid" aria-expanded="false" aria-controls="ODGrid">
                            <strong style="text-transform:uppercase"><i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;"></i>Other Detail</strong>
                        </button>
                    </h2>
                    <div id="ODGrid" class="accordion-collapse collapse pnl4 bg-gradient" aria-labelledby="H_SAGrid">
                        <div class="accordion-body">
                            <div class="row g-2 gx-3">
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="EnteredByEmpName" class="form-label">EnteredByEmpName</label>
                                    <input asp-for="EnteredByEmpName" class="form-control" readonly />
                                    <input type="hidden" asp-for="EnteredByEmpId" class="form-control" readonly />
                                    <input type="hidden" asp-for="ActualEnteredBy" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="ActualEntryDate" class="form-label" style="color: blue;">ActualEntryDate</label>
                                    <input asp-for="ActualEntryDate" class="form-control" readonly />
                                </div>
                                <div class="col-xl-2 col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="UpdatedByName" class="form-label" style="color: blue;">UpdatedBy</label>
                                    <input asp-for="UpdatedByName" class="form-control" readonly />
                                    <input type="hidden" asp-for="UpdatedBy" class="form-control" readonly />
                                </div


                                <div class="col-xl-2  col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <label asp-for="UpdatedOn" class="form-label">UpdatedOn</label>
                                    <input asp-for="UpdatedOn" class="form-control" readonly />
                                </div>
                               
                                 <div class="col-xl-2  col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="CC" class="form-label">CC</label>
                                    <input asp-for="CC " class="form-control" readonly />
                                </div>
                                <div class="col-xl-2  col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                    <label asp-for="EntryByMachineName" class="form-label" style="color: blue;">EntryByMachineName</label>
                                    <input asp-for="EntryByMachineName " class="form-control" value="@Environment.MachineName" readonly />
                                </div>
                               

                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </form>


</div>
<div class="modal fade" id="PasswordAllowPopup" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="staticBackdropLabel">Enter Password</h3>
                <button type="button" class="btn-close" data-bs-dismiss="modal" onclick="" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <div class="row g-2 gx-3">
                            <div class="card">
                                <div class="card-body overflow-auto pb-0">
                                    <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-xs-12">
                                        <div class="d-flex align-items-center">
                                            <h6 class="mb-0 me-2">Enter Password:</h6>
                                            <input type="password" class="form-control" id="BackDatePassword" placeholder="Enter Password" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="progress my-2" style="height: 4px;">
                        <div class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-success" onclick="PasswordCheck();">Done</button>
                    <button type="button" class="btn btn-sm btn-danger" data-bs-dismiss="modal" onclick="RefreshSchedule('');">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts
{
    <script>
        $(document).on('input', '.number', function () {
            // Replace anything that's not a digit or a single decimal point
            this.value = this.value.replace(/[^0-9.]/g, '')         // Remove invalid chars
                .replace(/(\..*)\./g, '$1');     // Allow only one decimal
        });
        $(document).ready(function () {
             $('#QcType').select2();
             $('#MIRNo').select2();
             $('#MRNNO').select2();
             $('#MIRYearCode').select2();
             $('#QCStore').select2();
             $('#ItemName').select2();
             $('#PartCode').select2();
             $('#OkRecStore').select2();
             $('#RejRecStore').select2();
             $('#RewokStoreId').select2();
             $('#HoldStoreId').select2();
             $('#ApprovedByEmp').select2();

             
            FILLQCTYPE();
            /* FILLMIRNO(); */
            FILLMIRYearCode();
            BINDSTORE();
            AddPassWord();
            RejSTORE();
            RewSTORE();
            HoldSTORE();
            BINDEMP();

            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {

                
                var EntryDate = parseDateToFormat($('#ReofferEntrydate').val().split(" ")[0]);
                
                var ActualEntryDate = parseDateToFormat($('#ActualEntryDate').val().split(" ")[0]);
              
                $('#ReofferEntrydate').datepicker("setDate", EntryDate);
               
                $('#ActualEntryDate').datepicker("setDate", ActualEntryDate);
            }
            else {
                GetServerDate();
                GETNEWENTRY();
                
            }

        });
        $('#QcType').change(function () { 
            /* ClearGridAjax(); */
            FILLMIRNO();
            FILLMRNNO();
        });
         $('#MRNNO').change(function () { 
            /* ClearGridAjax(); */
            FILLMIRNO();
            /* FILLMRNNO(); */
        });
        $('#MIRNo').change(function () { 
            /* ClearGridAjax(); */
            FILLMIRYearCode();
            FILLMIRData();
        });
        $('#MIRYearCode').change(function () { 
            /* ClearGridAjax(); */
            FILLMIRData();
            GetItemName();
            GetPartCode();
            GetItemData();
        });
         $(document).on('select2:select', '#ItemName,#PartCode', function (e) {

            var cntId = e.target.id;
            console.log(cntId);
            if (cntId == 'ItemName') {
                ItemNameChange(cntId);
               
            }
            else if (cntId == 'PartCode') {
                PartCodeChange(cntId);
               
            }
            $('#Itemcode').val($('#ItemName').val());
             GetItemQty();
             FillOkRecStore();
             FillPODetail();
            
        });
        function ItemNameChange(ID) {
            SetPartCodeItemName(ID);
            
                /* GetPartCode(ID); */
           
           
        }

        function PartCodeChange(ID) {

            $.when(SetPartCodeItemName(ID)).done(function () {
                /* GetPartCode(ID); */
            });
           
           
        }

        function SetPartCodeItemName(ID) {
            if (!ID) return;
            else {
                var v = $('#' + ID).select2('val');
                if (ID == "PartCode") {
                    $("#ItemName").val(v).trigger("change");
                }

                if (ID == "ItemName") {
                    $("#PartCode").val(v).trigger("change");
                }
            }
        }
         $('.BtnPassword').click(function () {
            // if(isAllowTaxPass == "Y"){
            $('#PasswordAllowPopup').modal("show");
            // }
        });
        function PasswordCheck() {
            var AddPassWord = $('#AddPassWord').val();
            if ($('#BackDatePassword').val() != AddPassWord) {
                $.notify('please enter correct password...!', "error");
            } else {
                $('#ShowAllStore').val("Y");
                FillOkRecStore();


                $('#PasswordAllowPopup').modal('hide');
            }
            $('#BackDatePassword').val("");
        }
        function AddPassWord() {

            $.ajax({
                type: "POST",
                url: "@Url.Action("ALLOWSHOWALLSTORE")",
               
                async: false,
                dataType: "json",
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                           
                            $.each(obj.Result, function (index, val) {

                                $('#AddPassWord').val(val.passforshowallstoreinqc);
                                console.log($('#AddPassWord').val());
                               
                                
                            });
                        }
                    }
                }
            });
        }
        function GetServerDate() {
            $.ajax({
                type: "GET",
                url: "@Url.Action("GetServerDate", "Routing")",
                async: false,
                success: function (result, status, error) {

                    $('#ReofferEntrydate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", (result));
                    $('#ActualEntryDate').datepicker({ dateFormat: 'dd/mm/yy' }).datepicker("setDate", (result));



                    $('#ReofferEntrydate').datepicker("option", "minDate", parseDateToFormat($('#FinFromDate').val().split(" ")[0]));


                    $('#ReofferEntrydate').datepicker("option", "maxDate", parseDateToFormat($('#FinToDate').val().split(" ")[0]));
                }
            });
        }
         function GETNEWENTRY() {
             var ReofferYearcode = $('#ReofferYearcode').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("GETNEWENTRY")",
                dataType: "json",
                data : { ReofferYearcode: ReofferYearcode },
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        $('#ReofferEntryId').val("");
                        $('#ReofferEntryId').val(obj.Result[0].EntryId);
                        $('#ReofferNo').val("");
                        $('#ReofferNo').val(obj.Result[0].ReoffeNo);
                    }
                }
            });
        }

        function FILLQCTYPE() {
           
            $.ajax({
                type: "POST",
                url: "@Url.Action("FILLQCTYPE")",
                dataType: "json",
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#QcType').empty();
                            $('#QcType').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#QcType').append('<option value="' + val.QC + '">' + val.QC + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var QcType = "@Model.QcType";
                                $('#QcType').val(QcType).trigger("change");
                            }
                        }
                    }
                }
            });
        }

        function FILLMIRNO() {
            var ReofferMir = $('#QcType').val();
            var MRNNO = $('#MRNNO').val();
             $('#MIRNo').empty();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FILLMIRNO")",
                dataType: "json",
                data: { ReofferMir: ReofferMir, MRNNO:MRNNO  },
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#MIRNo').empty();
                            $('#MIRNo').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#MIRNo').append('<option value="' + val.MIRNO + '">' + val.MIRNO + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var MIRNo = "@Model.MIRNo";
                                $('#MIRNo').val(MIRNo).trigger("change");
                            }
                        }
                    }
                }
            });
        }

        function FILLMRNNO() {
            var ReofferMir = $('#QcType').val();
             $('#MRNNO').empty();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FILLMRNNO")",
                dataType: "json",
                data: { ReofferMir: ReofferMir },
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#MRNNO').empty();
                            $('#MRNNO').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#MRNNO').append('<option value="' + val.MRNNo + '">' + val.MRNNo + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var MRNNO = "@Model.MRNNO";
                                $('#MRNNO').val(MRNNO).trigger("change");
                            }
                        }
                    }
                }
            });
        }

         function FILLMIRYearCode() {
             var MIRNO = $('#MIRNo').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FILLMIRYearCode")",
                dataType: "json",
                data: { MIRNO: MIRNO },
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#MIRYearCode').empty();
                            $('#MIRYearCode').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#MIRYearCode').append('<option value="' + val.MIRYearCode + '">' + val.MIRYearCode + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var MIRYearCode = "@Model.MIRYearCode";
                                $('#MIRYearCode').val(MIRYearCode).trigger("change");
                            }
                        }
                    }
                }
            });
        }

        function BINDSTORE() {
             
            $.ajax({
                type: "POST",
                url: "@Url.Action("BINDSTORE")",
                dataType: "json",
               
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#QCStore').empty();
                            $('#QCStore').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#QCStore').append('<option value="' + val.entryid + '">' + val.store_name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var QCStore = "@Model.QCStore";
                                $('#QCStore').val(QCStore).trigger("change");
                            }
                        }
                    }
                }
            });
        }

        function GetItemName() {
             var MIRNO=$('#MIRNo').val();
             var MIRYearCode=$('#MIRYearCode').val();
            var accountcode = $('#AccountCode').val();
            var ReofferMir = $('#QcType').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetItemDeatil")",
                dataType: "json",
               data: { MIRNO: MIRNO, MIRYearCode: MIRYearCode, accountcode: accountcode, ReofferMir: ReofferMir },
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#ItemName').empty();
                            $('#ItemName').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#ItemName').append('<option value="' + val.itemCode + '">' + val.Item_Name + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var ItemName = "@Model.ItemName";
                                $('#ItemName').val(ItemName).trigger("change");
                            }
                        }
                    }
                }
            });
        }

         function GetPartCode() {
             var MIRNO=$('#MIRNo').val();
             var MIRYearCode=$('#MIRYearCode').val();
            var accountcode = $('#AccountCode').val();
            var ReofferMir = $('#QcType').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetItemDeatil")",
                dataType: "json",
               data: { MIRNO: MIRNO, MIRYearCode: MIRYearCode, accountcode: accountcode, ReofferMir: ReofferMir },
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#PartCode').empty();
                            $('#PartCode').append('<option value="" disabled selected>-Select-</option>');

                            $.each(obj.Result, function (index, val) {
                                $('#PartCode').append('<option value="' + val.itemCode + '">' + val.PartCode + '</option>');
                            });
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var PartCode = "@Model.PartCode";
                                $('#PartCode').val(PartCode).trigger("change");
                            }
                        }
                    }
                }
            });
        }
    function handleInput(input) {
        const id = input.id;
    
        if (id.startsWith("AcceptedQty")) {
            const index = id.replace("AcceptedQty", "");
            const accQtyVal = input.value;
            const altAccQtyInput = document.getElementById("AltAcceptedQty" + index);
             const RecQtyInput = document.getElementById("RecQty" + index);

              const AcceptedQty = document.getElementById("AcceptedQty" + index);
                    const HoldQty = document.getElementById("HoldQty" + index);
                    const RejectedQty = document.getElementById("RejectedQty" + index);
                    const Reworkqty = document.getElementById("Reworkqty" + index);
                     const DeviationQty = document.getElementById("DeviationQty" + index);
                     const RecQtyVal = parseFloat(RecQtyInput.value) || 0;
                     const AcceptedQtyVal = parseFloat(AcceptedQty.value) || 0;
                     const HoldQtyVal = parseFloat(HoldQty.value) || 0;
                     const RejectedQtyval = parseFloat(RejectedQty.value) || 0;
                     const Reworkqtyval = parseFloat(Reworkqty.value) || 0;
                      const DeviationVal = parseFloat(DeviationQty.value) || 0;

                     
                   

        
            if (altAccQtyInput) {
                altAccQtyInput.value = accQtyVal;
            }
            if ($('#QcType').val() === 'HOLD') {
                    const holdInput = document.getElementById("HoldQty" + index);
                    const prevHoldInput = document.getElementById("PreviousHoldQty" + index);


                    if (holdInput && prevHoldInput) {
                        const prevHoldVal = parseFloat(prevHoldInput.value) || 0;

                        if (isNaN(accQtyVal) || accQtyVal === 0 || accQtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            holdInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - accQtyVal-RejectedQtyval-Reworkqtyval-DeviationVal, 0);
                            holdInput.value = newHoldVal.toFixed(2);

                        }
                    }
                }
                if ($('#QcType').val() === 'REWORK') {

                    const reworkInput = document.getElementById("Reworkqty" + index);
                    const prevReworkInput = document.getElementById("PreviousReworkqty" + index);


                    if (reworkInput && prevReworkInput) {
                        const prevReworkVal = parseFloat(prevReworkInput.value) || 0;

                        if (isNaN(accQtyVal) || accQtyVal === 0 || accQtyVal == '') {
                            // Reset to original if empty or zero
                            reworkInput.value = prevReworkVal.toFixed(2);

                        } else {
                            // Subtract rejected from original rework qty
                            const newReworkVal = Math.max(RecQtyVal - accQtyVal-RejectedQtyval-HoldQtyVal-DeviationVal, 0);
                            reworkInput.value = newReworkVal.toFixed(2);

                        }

                    }


                }
                if ($('#QcType').val() === 'Rejected') {

                    const RejectedInput = document.getElementById("RejectedQty" + index);
                    const prevRejectedInput = document.getElementById("PreviousRejectedQty" + index);
                    const AltRejecteddInput = document.getElementById("AltRejectedQty" + index);


                    if (RejectedInput && prevRejectedInput) {
                        const prevRejectedVal = parseFloat(prevRejectedInput.value) || 0;

                        if (isNaN(accQtyVal) || accQtyVal === 0 || accQtyVal == '') {
                            // Reset to original if empty or zero
                            RejectedInput.value = prevRejectedVal.toFixed(2);
                            AltRejecteddInput.value = prevRejectedVal.toFixed(2);

                        } else {
                            // Subtract rejected from original rework qty
                            const newRejectedVal = Math.max(RecQtyVal - accQtyVal-HoldQtyVal-Reworkqtyval-DeviationVal, 0);
                            RejectedInput.value = newRejectedVal.toFixed(2);
                            AltRejecteddInput.value = newRejectedVal.toFixed(2);

                        }

                    }

                    if ($('#QcType').val() === 'Deviation') {
                    const DeviationInput = document.getElementById("DeviationQty" + index);
                    const prevDeviationInput = document.getElementById("PrevDeviationQty" + index);


                    if (DeviationInput && prevDeviationInput) {
                        const prevHoldVal = parseFloat(prevDeviationInput.value) || 0;

                        if (isNaN(accQtyVal) || accQtyVal === 0 || accQtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            DeviationInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - accQtyVal-Reworkqtyval-HoldQtyVal-RejectedQtyval, 0);
                            DeviationInput.value = newHoldVal.toFixed(2);

                        }
                    }
            }


                }






        }

            if (id.startsWith("RejectedQty")) {
                const index = id.replace("RejectedQty", "");
                const rejQtyVal = input.value;
                const altRejQtyInput = document.getElementById("AltRejectedQty" + index);
                 const RecQtyInput = document.getElementById("RecQty" + index);
                 const PreviousRejectedQtyInpyt = document.getElementById("PreviousRejectedQty" + index);

                  const AcceptedQty = document.getElementById("AcceptedQty" + index);
                    const HoldQty = document.getElementById("HoldQty" + index);
                    const RejectedQty = document.getElementById("RejectedQty" + index);
                    const Reworkqty = document.getElementById("Reworkqty" + index);
                    const DeviationQty = document.getElementById("DeviationQty" + index);

                    const RecQtyVal = parseFloat(RecQtyInput.value) || 0;
                     const AcceptedQtyVal = parseFloat(AcceptedQty.value) || 0;
                     const HoldQtyVal = parseFloat(HoldQty.value) || 0;
                     const RejectedQtyval = parseFloat(RejectedQty.value) || 0;
                     const Reworkqtyval = parseFloat(Reworkqty.value) || 0;
                      const DeviationVal = parseFloat(DeviationQty.value) || 0;


                if (altRejQtyInput) {
                    altRejQtyInput.value = rejQtyVal;
                }
                if ($('#QcType').val() === 'Accepted') {
                    const acceptedInput = document.getElementById("AcceptedQty" + index);
                    const prevAcceptedInput = document.getElementById("PrevAcceptedQty" + index);
                    const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);

                    if (acceptedInput && prevAcceptedInput) {
                        const prevAcceptedVal = parseFloat(prevAcceptedInput.value) || 0;

                        if (isNaN(rejQtyVal) || rejQtyVal == '' || rejQtyVal == 0) {
                            // RejectedQty is empty → restore original
                            acceptedInput.value = prevAcceptedVal.toFixed(2);
                            if (altAcceptedInput) altAcceptedInput.value = prevAcceptedVal.toFixed(2);
                        } else {
                            
                           
                            const AcceptedVal = parseFloat(acceptedInput.value) || 0;
                            const newAcceptedVal = Math.max(RecQtyVal - rejQtyVal-HoldQtyVal-Reworkqtyval-DeviationVal, 0); // prevent negative
                            acceptedInput.value = newAcceptedVal.toFixed(2);

                            // Also sync with AltAcceptedQty
                            const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);
                            if (altAcceptedInput) {
                                altAcceptedInput.value = newAcceptedVal.toFixed(2);
                            }
                        }
                    }

                }

                if ($('#QcType').val() === 'HOLD') {
                    const holdInput = document.getElementById("HoldQty" + index);
                    const prevHoldInput = document.getElementById("PreviousHoldQty" + index);


                    if (holdInput && prevHoldInput) {
                        const prevHoldVal = parseFloat(prevHoldInput.value) || 0;

                        if (isNaN(rejQtyVal) || rejQtyVal === 0 || rejQtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            holdInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - rejQtyVal-Reworkqtyval-AcceptedQtyVal-DeviationVal, 0);
                            holdInput.value = newHoldVal.toFixed(2);

                        }
                    }
                }
                if ($('#QcType').val() === 'REWORK') {

                    const reworkInput = document.getElementById("Reworkqty" + index);
                    const prevReworkInput = document.getElementById("PreviousReworkqty" + index);


                    if (reworkInput && prevReworkInput) {
                        const prevReworkVal = parseFloat(prevReworkInput.value) || 0;

                        if (isNaN(rejQtyVal) || rejQtyVal === 0 || rejQtyVal == '') {
                            // Reset to original if empty or zero
                            reworkInput.value = prevReworkVal.toFixed(2);

                        } else {
                            // Subtract rejected from original rework qty
                            const newReworkVal = Math.max(RecQtyVal - rejQtyVal-AcceptedQtyVal-HoldQtyVal-DeviationVal, 0);
                            reworkInput.value = newReworkVal.toFixed(2);

                        }

                    }


                }
                if ($('#QcType').val() === 'Deviation') {
                    const DeviationInput = document.getElementById("DeviationQty" + index);
                    const prevDeviationInput = document.getElementById("PrevDeviationQty" + index);


                    if (DeviationInput && prevDeviationInput) {
                        const prevHoldVal = parseFloat(prevDeviationInput.value) || 0;

                        if (isNaN(rejQtyVal) || rejQtyVal === 0 || rejQtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            DeviationInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - rejQtyVal-AcceptedQtyVal-Reworkqtyval-HoldQtyVal, 0);
                            DeviationInput.value = newHoldVal.toFixed(2);

                        }
                    }
            }

            }


        if (id.startsWith("HoldQty")) {
            const index = id.replace("HoldQty", "");
            const holdQtyVal = input.value;

             const RecQtyInput = document.getElementById("RecQty" + index);
             const AcceptedQty = document.getElementById("AcceptedQty" + index);
                    const HoldQty = document.getElementById("HoldQty" + index);
                    const RejectedQty = document.getElementById("RejectedQty" + index);
                    const Reworkqty = document.getElementById("Reworkqty" + index);
                     const DeviationQty = document.getElementById("DeviationQty" + index);

                    const RecQtyVal = parseFloat(RecQtyInput.value) || 0;
                     const AcceptedQtyVal = parseFloat(AcceptedQty.value) || 0;
                     const HoldQtyVal = parseFloat(HoldQty.value) || 0;
                     const RejectedQtyval = parseFloat(RejectedQty.value) || 0;
                     const Reworkqtyval = parseFloat(Reworkqty.value) || 0;
                      const DeviationVal = parseFloat(DeviationQty.value) || 0;

            if ($('#QcType').val() === 'Accepted') {
                const acceptedInput = document.getElementById("AcceptedQty" + index);
                const prevAcceptedInput = document.getElementById("PrevAcceptedQty" + index);
                const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);


                if (acceptedInput && prevAcceptedInput) {
                    const prevAcceptedVal = parseFloat(prevAcceptedInput.value) || 0;

                    if (isNaN(holdQtyVal) || holdQtyVal == '' || holdQtyVal == 0) {
                        // RejectedQty is empty → restore original
                        acceptedInput.value = prevAcceptedVal.toFixed(2);
                        if (altAcceptedInput) altAcceptedInput.value = prevAcceptedVal.toFixed(2);
                    } else {


                        const AcceptedVal = parseFloat(acceptedInput.value) || 0;
                        const newAcceptedVal = Math.max(RecQtyVal - holdQtyVal-RejectedQtyval-Reworkqtyval-DeviationVal, 0); // prevent negative
                        acceptedInput.value = newAcceptedVal.toFixed(2);

                        // Also sync with AltAcceptedQty
                        const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);
                        if (altAcceptedInput) {
                            altAcceptedInput.value = newAcceptedVal.toFixed(2);
                        }
                    }
                }

            }

            if ($('#QcType').val() === 'REWORK') {

                const reworkInput = document.getElementById("Reworkqty" + index);
                const prevReworkInput = document.getElementById("PreviousReworkqty1" + index);


                if (reworkInput && prevReworkInput) {
                    const prevReworkVal = parseFloat(prevReworkInput.value) || 0;

                    if (isNaN(holdQtyVal) || holdQtyVal === 0 || holdQtyVal == '') {
                        // Reset to original if empty or zero
                        reworkInput.value = prevReworkVal.toFixed(2);

                    } else {
                        // Subtract rejected from original rework qty
                        const newReworkVal = Math.max(RecQtyVal - holdQtyVal-RejectedQtyval-AcceptedQtyVal-DeviationVal, 0);
                        reworkInput.value = newReworkVal.toFixed(2);

                    }

                }


            }
            if ($('#QcType').val() === 'Rejected') {

                const RejectedInput = document.getElementById("RejectedQty" + index);
                const prevRejectedInput = document.getElementById("PreviousRejectedQty" + index);
                const AltRejecteddInput = document.getElementById("AltRejectedQty" + index);


                if (RejectedInput && prevRejectedInput) {
                    const prevRejectedVal = parseFloat(prevRejectedInput.value) || 0;

                    if (isNaN(holdQtyVal) || holdQtyVal === 0 || holdQtyVal == '') {
                        // Reset to original if empty or zero
                        RejectedInput.value = prevRejectedVal.toFixed(2);
                        AltRejecteddInput.value = prevRejectedVal.toFixed(2);

                    } else {
                        // Subtract rejected from original rework qty
                        const newRejectedVal = Math.max(RecQtyVal - holdQtyVal-AcceptedQtyVal-Reworkqtyval-DeviationVal, 0);
                        RejectedInput.value = newRejectedVal.toFixed(2);
                        AltRejecteddInput.value = newRejectedVal.toFixed(2);

                    }

                }


            }

            if ($('#QcType').val() === 'Deviation') {
                    const DeviationInput = document.getElementById("DeviationQty" + index);
                    const prevDeviationInput = document.getElementById("PrevDeviationQty" + index);


                    if (DeviationInput && prevDeviationInput) {
                        const prevHoldVal = parseFloat(prevDeviationInput.value) || 0;

                        if (isNaN(holdQtyVal) || holdQtyVal === 0 || holdQtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            DeviationInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - holdQtyVal-AcceptedQtyVal-RejectedQtyval-Reworkqtyval, 0);
                            DeviationInput.value = newHoldVal.toFixed(2);

                        }
                    }
            }
        }

                if (id.startsWith("Reworkqty")) {
                    const index = id.replace("Reworkqty", "");
                    const ReworkqtyVal = input.value;

                     const RecQtyInput = document.getElementById("RecQty" + index);
             const AcceptedQty = document.getElementById("AcceptedQty" + index);
                    const HoldQty = document.getElementById("HoldQty" + index);
                    const RejectedQty = document.getElementById("RejectedQty" + index);
                    const Reworkqty = document.getElementById("Reworkqty" + index);
                     const DeviationQty = document.getElementById("DeviationQty" + index);

                    const RecQtyVal = parseFloat(RecQtyInput.value) || 0;
                     const AcceptedQtyVal = parseFloat(AcceptedQty.value) || 0;
                     const HoldQtyVal = parseFloat(HoldQty.value) || 0;
                     const RejectedQtyval = parseFloat(RejectedQty.value) || 0;
                     const Reworkqtyval = parseFloat(Reworkqty.value) || 0;
                      const DeviationVal = parseFloat(DeviationQty.value) || 0;

                    if ($('#QcType').val() === 'Accepted') {
                        const acceptedInput = document.getElementById("AcceptedQty" + index);
                        const prevAcceptedInput = document.getElementById("PrevAcceptedQty" + index);
                        const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);


                        if (acceptedInput && prevAcceptedInput) {
                            const prevAcceptedVal = parseFloat(prevAcceptedInput.value) || 0;

                            if (isNaN(ReworkqtyVal) || ReworkqtyVal == '' || ReworkqtyVal == 0) {
                                // RejectedQty is empty → restore original
                                acceptedInput.value = prevAcceptedVal.toFixed(2);
                                if (altAcceptedInput) altAcceptedInput.value = prevAcceptedVal.toFixed(2);
                            } else {


                                const AcceptedVal = parseFloat(acceptedInput.value) || 0;
                                const newAcceptedVal = Math.max(RecQtyVal - ReworkqtyVal-HoldQtyVal-RejectedQtyval-DeviationVal, 0); // prevent negative
                                acceptedInput.value = newAcceptedVal.toFixed(2);

                                // Also sync with AltAcceptedQty
                                const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);
                                if (altAcceptedInput) {
                                    altAcceptedInput.value = newAcceptedVal.toFixed(2);
                                }
                            }
                        }

                    }
                
              
               
                if ($('#QcType').val() === 'Rejected') {

                    const RejectedInput = document.getElementById("RejectedQty" + index);
                    const prevRejectedInput = document.getElementById("PreviousRejectedQty" + index);
                    const AltRejecteddInput = document.getElementById("AltRejectedQty" + index);


                    if (RejectedInput && prevRejectedInput) {
                        const prevRejectedVal = parseFloat(prevRejectedInput.value) || 0;

                        if (isNaN(ReworkqtyVal) || ReworkqtyVal === 0 || ReworkqtyVal == '') {
                            // Reset to original if empty or zero
                            RejectedInput.value = prevRejectedVal.toFixed(2);
                            AltRejecteddInput.value = prevRejectedVal.toFixed(2);

                        } else {
                            // Subtract rejected from original rework qty
                            const newRejectedVal = Math.max(RecQtyVal - ReworkqtyVal-HoldQtyVal-AcceptedQtyVal-DeviationVal, 0);
                            RejectedInput.value = newRejectedVal.toFixed(2);
                            AltRejecteddInput.value = newRejectedVal.toFixed(2);

                        }

                    }


                }
                if ($('#QcType').val() === 'HOLD') {
                    const holdInput = document.getElementById("HoldQty" + index);
                    const prevHoldInput = document.getElementById("PreviousHoldQty" + index);


                    if (holdInput && prevHoldInput) {
                        const prevHoldVal = parseFloat(prevHoldInput.value) || 0;

                        if (isNaN(ReworkqtyVal) || ReworkqtyVal === 0 || ReworkqtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            holdInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - ReworkqtyVal-AcceptedQtyVal-RejectedQtyval-DeviationVal, 0);
                            holdInput.value = newHoldVal.toFixed(2);

                        }
                    }
                }


                if ($('#QcType').val() === 'Deviation') {
                    const DeviationInput = document.getElementById("DeviationQty" + index);
                    const prevDeviationInput = document.getElementById("PrevDeviationQty" + index);


                    if (DeviationInput && prevDeviationInput) {
                        const prevHoldVal = parseFloat(prevDeviationInput.value) || 0;

                        if (isNaN(ReworkqtyVal) || ReworkqtyVal === 0 || ReworkqtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            DeviationInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - ReworkqtyVal-AcceptedQtyVal-RejectedQtyval-HoldQtyVal, 0);
                            DeviationInput.value = newHoldVal.toFixed(2);

                        }
                    }
                }

            }


                            if (id.startsWith("DeviationQty")) {
                    const index = id.replace("DeviationQty", "");
                    const DeviationqtyVal = input.value;

                     const RecQtyInput = document.getElementById("RecQty" + index);
             const AcceptedQty = document.getElementById("AcceptedQty" + index);
                    const HoldQty = document.getElementById("HoldQty" + index);
                    const RejectedQty = document.getElementById("RejectedQty" + index);
                    const Reworkqty = document.getElementById("Reworkqty" + index);
                    const DeviationQty = document.getElementById("DeviationQty" + index);

                    const RecQtyVal = parseFloat(RecQtyInput.value) || 0;
                     const AcceptedQtyVal = parseFloat(AcceptedQty.value) || 0;
                     const HoldQtyVal = parseFloat(HoldQty.value) || 0;
                     const RejectedQtyval = parseFloat(RejectedQty.value) || 0;
                     const Reworkqtyval = parseFloat(Reworkqty.value) || 0;
                     const DeviationVal = parseFloat(DeviationQty.value) || 0;

                    if ($('#QcType').val() === 'Accepted') {
                        const acceptedInput = document.getElementById("AcceptedQty" + index);
                        const prevAcceptedInput = document.getElementById("PrevAcceptedQty" + index);
                        const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);


                        if (acceptedInput && prevAcceptedInput) {
                            const prevAcceptedVal = parseFloat(prevAcceptedInput.value) || 0;

                            if (isNaN(DeviationqtyVal) || DeviationqtyVal == '' || DeviationqtyVal == 0) {
                                // RejectedQty is empty → restore original
                                acceptedInput.value = prevAcceptedVal.toFixed(2);
                                if (altAcceptedInput) altAcceptedInput.value = prevAcceptedVal.toFixed(2);
                            } else {


                                const AcceptedVal = parseFloat(acceptedInput.value) || 0;
                                const newAcceptedVal = Math.max(RecQtyVal - DeviationqtyVal-HoldQtyVal-RejectedQtyval-Reworkqtyval, 0); // prevent negative
                                acceptedInput.value = newAcceptedVal.toFixed(2);

                                // Also sync with AltAcceptedQty
                                const altAcceptedInput = document.getElementById("AltAcceptedQty" + index);
                                if (altAcceptedInput) {
                                    altAcceptedInput.value = newAcceptedVal.toFixed(2);
                                }
                            }
                        }

                    }
                
              
               
                if ($('#QcType').val() === 'Rejected') {

                    const RejectedInput = document.getElementById("RejectedQty" + index);
                    const prevRejectedInput = document.getElementById("PreviousRejectedQty" + index);
                    const AltRejecteddInput = document.getElementById("AltRejectedQty" + index);


                    if (RejectedInput && prevRejectedInput) {
                        const prevRejectedVal = parseFloat(prevRejectedInput.value) || 0;

                        if (isNaN(DeviationqtyVal) || DeviationqtyVal === 0 || DeviationqtyVal == '') {
                            // Reset to original if empty or zero
                            RejectedInput.value = prevRejectedVal.toFixed(2);
                            AltRejecteddInput.value = prevRejectedVal.toFixed(2);

                        } else {
                            // Subtract rejected from original rework qty
                            const newRejectedVal = Math.max(RecQtyVal - DeviationqtyVal-HoldQtyVal-AcceptedQtyVal-Reworkqtyval, 0);
                            RejectedInput.value = newRejectedVal.toFixed(2);
                            AltRejecteddInput.value = newRejectedVal.toFixed(2);

                        }

                    }


                }
                if ($('#QcType').val() === 'HOLD') {
                    const holdInput = document.getElementById("HoldQty" + index);
                    const prevHoldInput = document.getElementById("PreviousHoldQty" + index);


                    if (holdInput && prevHoldInput) {
                        const prevHoldVal = parseFloat(prevHoldInput.value) || 0;

                        if (isNaN(DeviationqtyVal) || DeviationqtyVal === 0 || DeviationqtyVal == '') {
                            // If RejectedQty empty or 0, restore original hold qty
                            holdInput.value = prevHoldVal.toFixed(2);

                        }
                        else {
                            // Subtract rejected from original hold qty
                            newHoldVal = Math.max(RecQtyVal - DeviationqtyVal-AcceptedQtyVal-RejectedQtyval-Reworkqtyval, 0);
                            holdInput.value = newHoldVal.toFixed(2);

                        }
                    }
                }

                if ($('#QcType').val() === 'REWORK') {

                const reworkInput = document.getElementById("Reworkqty" + index);
                const prevReworkInput = document.getElementById("PreviousReworkqty" + index);


                if (reworkInput && prevReworkInput) {
                    const prevReworkVal = parseFloat(prevReworkInput.value) || 0;

                    if (isNaN(DeviationqtyVal) || DeviationqtyVal === 0 || DeviationqtyVal == '') {
                        // Reset to original if empty or zero
                        reworkInput.value = prevReworkVal.toFixed(2);

                    } else {
                        // Subtract rejected from original rework qty
                        const newReworkVal = Math.max(RecQtyVal - DeviationqtyVal-RejectedQtyval-AcceptedQtyVal-HoldQtyVal, 0);
                        reworkInput.value = newReworkVal.toFixed(2);

                    }

                }


            }

            }












    }

    

$('#DivDetailGrid').on('click', '.deleteRowBtn', function () {
    $(this).closest('tr').remove();  // Delete row

    // Re-index all rows
    $('#DivDetailGrid .data-row').each(function (index) {
        var rowIndex = index + 1;

        // Update <td> showing row number
        $(this).find('td:first').text(rowIndex);

        // Loop through all input/select inside this row
        $(this).find('input, select').each(function () {
            var oldId = $(this).attr('id');
            if (oldId) {
                // Replace digits at the end of the id (e.g., ItemName3 -> ItemName1)
                var newId = oldId.replace(/\d+$/, rowIndex);
                $(this).attr('id', newId);
            }

            // Optional: If your onchange or onfocusout functions have index-based calls
            var onchange = $(this).attr('onchange');
            if (onchange) {
                var updated = onchange.replace(/\d+/, rowIndex);
                $(this).attr('onchange', updated);
            }

            var onfocusout = $(this).attr('onfocusout');
            if (onfocusout) {
                var updatedFocus = onfocusout.replace(/\d+/, rowIndex);
                $(this).attr('onfocusout', updatedFocus);
            }
        });
    });
});

   

        function GetItemData() {
            var MIRNO=$('#MIRNo').val();
             var MIRYearCode=$('#MIRYearCode').val();
            var accountcode = $('#AccountCode').val();
            var ReofferMir = $('#QcType').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetItemData")",
                data: { MIRNO: MIRNO, MIRYearCode: MIRYearCode, accountcode: accountcode, ReofferMir: ReofferMir },
                async: false,
                success: function (result, status, error) {
                    if (result != null) {

                        var obj = $.parseJSON(result);
                        for (var i = 0; i < obj.Result.length; i++) {
                            var resultItem = obj.Result[i];

                            for (var key in resultItem) {
                                if (resultItem[key] === null) {
                                    resultItem[key] = "";
                                }
                            }
                        }
                        var html = '';
                        $('#DivDetailGrid').empty();
                        var i = 1;
                        var qcType = $('#QcType').val();
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $.each(obj.Result, function (index, val) {
                                html += '<tr class="data-row">' +
                                '<td>'+ i + '</td>' +
                                 '<td><button type="button" class="btn btn-sm btn-danger deleteRowBtn" title="Delete Row"><i class="fa fa-trash"></i></button></td>'+


                               '<td><input id="PartCode' + i + '" value=' + JSON.stringify(val.PartCode) + ' class="textbox" readonly></td>' +
                                '<td><input id="ItemName' + i + '" value=' + JSON.stringify(val.Item_Name) + ' readonly class="textbox"><input type="hidden" id="itemCode' + i + '" value=' + val.itemCode + '></td>' +
                                
                                '<td><input id="BillQty' + i + '" value=' + val.BillQty + ' readonly style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="RecQty' + i + '" value=' + val.RecQty + ' readonly style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="AltRecQty' + i + '" value=' + val.RecQty + ' readonly style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="PrevAcceptedQty' + i + '" value=' + val.AcceptedQty + ' readonly style="width:60px;" class="textbox number"></td>' +
/*                                 '<td><input id="AcceptedQty' + i + '" value=' + val.AcceptedQty + ' style="width:60px;background-color:#ffd6dd;" class="textbox number"  onfocusout="handleInput(this)"></td>' +

 */ 
                                 '<td><input id="AcceptedQty' + i + '" value=' + val.AcceptedQty + 
                                        ' style="width:60px;background-color:#99FFFF;" class="textbox number"' +
                                        (qcType.toLowerCase() === 'accepted' ? ' disabled' : '') +
                                        ' onfocusout="handleInput(this)"></td>'+
                                    '<td><input id="AltAcceptedQty' + i + '" value=' + val.AcceptedQty + ' readonly style="width:60px;background-color:#ffd6dd;" class="textbox number"  onfocusout="handleInput(this)"></td>' +
                                     
                               
                                '<td><select id="OkRecStore' + i + '" style="background-color:#ffd6dd;width:170px" class="textbox" onchange="OkRecStoreChange(' + i + ')"><option value="" selected>-Select-</option></select></td>' +      
                               
                                '<td><input id="PreviousRejectedQty' + i + '" value=' + val.RejectedQty + ' readonly style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="RejectedQty' + i + '" value=' + val.RejectedQty +
                                        ' style="width:60px;background-color:#99FFFF;" class="textbox number"' +
                                        (qcType.toLowerCase() === 'rejected' ? ' disabled' : '') +
                                        ' onfocusout="handleInput(this)"></td>' +
                                '<td><input id="AltRejectedQty' + i + '" value=' + val.RejectedQty + ' readonly style="width:60px;background-color:#ffd6dd;" class="textbox number"  onfocusout="handleInput(this)"></td>' +
                                
                                '<td><select id="RejRecStore' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="RejRecStoreChange(' + i + ')"><option value="" selected>-Select-</option></select></td>' +    
                               
                                '<td><input id="PreviousHoldQty' + i + '" value=' + val.HoldQty + ' style="width:60px;" readonly class="textbox number"></td>' +
                                    '<td><input id="HoldQty' + i + '" value=' + val.HoldQty +
                                            ' style="width:60px;background-color:#99FFFF;" class="textbox number"' +
                                            (qcType.toLowerCase() === 'hold' ? ' disabled' : '') +
                                            ' onfocusout="handleInput(this)"></td>' +
                                            
                                 '<td><select id="HoldStoreId' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="HoldStoreIdChange(' + i + ')"><option value="" selected>-Select-</option></select></td>' +   

                                 
                                '<td><input id="PreviousReworkqty' + i + '" value=' + val.Reworkqty + ' readonly style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="Reworkqty' + i + '" value=' + val.Reworkqty +
                                        ' style="width:60px;background-color:#99FFFF;" class="textbox number"' +
                                        (qcType.toLowerCase() === 'rework' ? ' disabled' : '') +
                                        ' onfocusout="handleInput(this)"></td>' +
                                        
                                 '<td><select id="RewokStoreId' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="RewokStoreIdChange(' + i + ')"><option value="" selected>-Select-</option></select></td>' +   
                                
                                '<td><input id="PrevDeviationQty' + i + '" value=' + val.DeviationQty + ' style="width:60px;" class="textbox number" onfocusout="handleInput(this)"></td>' +
                                '<td><input id="DeviationQty' + i + '" value=' + val.DeviationQty +
                                        ' style="width:60px;background-color:#99FFFF;" class="textbox number"' +
                                        (qcType.toLowerCase() === 'deviation' ? ' disabled' : '') +
                                        ' onfocusout="handleInput(this)"></td>' +

                                '<td><input id="ResponsibleEmpForDeviation' + i + '" value="" class="textbox"></td>' +
                            '<td><select id="ApprovedByEmp' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="ApprovedByEmpChange(' + i + ')"><option value="" selected>-Select-</option></select></td>' +   

                                '<td><input id="ProcessId' + i + '"  value=""  class="textbox"></td>' +

                                 '<td><input id="BatchNo' + i + '" value=' + JSON.stringify(val.BatchNo || "") + ' class="textbox"></td>' +
'<td><input id="uniqueBatchno' + i + '" value=' + JSON.stringify(val.uniqueBatchno || "") + ' class="textbox"></td>' +
                                 '<td><input id="Rate' + i + '"  value="" style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="rateinother' + i + '"  value="" style="width:60px;" class="textbox number"></td>' +
                                '<td><input id="Remarks' + i + '"  value=""  class="textbox" style="width:120px;"></td>' +
                                '<td><input id="Unit' + i + '" value=' + val.Unit + ' readonly style="width:60px;" class="textbox"></td>' +
                                '<td><input id="AltUnit' + i + '" value=' + val.Unit + ' readonly style="width:60px;" class="textbox"></td>' +
                                '<td><input id="Defaulttype' + i + '"  value="" class="textbox"></td>' +

                                
                                '<td><input id="Color' + i + '"  value="" style="width:60px;" class="textbox"></td>' +
                                '<td><input id="ItemSize' + i + '"  value="" style="width:60px;" class="textbox"></td>' +
                                '<td><input id="ResponsibleFactor' + i + '"  value="" style="width:60px;" class="textbox"></td>' +
                                '<td><input id="SupplierBatchno' + i + '"  value="" class="textbox"></td>' +
                                '<td><input id="shelfLife' + i + '"  value="" style="width:60px;" class="textbox"></td>' +
                               
                                '<td><input id="AllowDebitNote' + i + '"  value="" style="width:60px;" class="textbox"></td>' +
                               
                                '<td>' +
                                     '<select id="PrevOkRecStore' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="OkRecStoreChange(' + i + ')">' +
                                              '<option value="">-Select-</option>' +
                                              '<option value="' + val.OkRecStoreid + '" selected>' + val.OkRecStorename + '</option>' +
                                          '</select>'
                                       + '</td>'+
                                        '<td>' +
                                    '<select id="PrevRejRecStore' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="RejRecStoreChange(' + i + ')">' +
                                              '<option value="">-Select-</option>' +
                                              '<option value="' + val.Rejstoreid + '" selected>' + val.Rejstorename + '</option>' +
                                          '</select>'
                                        +
                                '</td>'+
                                '<td>' +
                                    '<select id="PrevHoldStoreId' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="HoldStoreIdChange(' + i + ')">' +
                                              '<option value="">-Select-</option>' +
                                              '<option value="' + val.HoldStoreId + '" selected>' + val.HoldStorename + '</option>' +
                                          '</select>'
                                        +
                                '</td>'+
                                 '<td>' +
                                     '<select id="PrevRewokStoreId' + i + '" style="background-color:#ffd6dd;" class="textbox" onchange="HoldStoreIdChange(' + i + ')">' +
                                              '<option value="">-Select-</option>' +
                                              '<option value="' + val.RewokStoreId + '" selected>' + val.RewokStoreName + '</option>' +
                                          '</select>'
                                          +
                                      
                                '</td>'+
                                  '<td><input id="AccLotStock' + i + '" value="" readonly style="width:60px;" class="textbox number"></td>' +
                                  '<td><input id="RejLotStock' + i + '" value="" readonly style="width:60px;" class="textbox number"></td>' +
                                  '<td><input id="HoldLotStock' + i + '" value="" readonly style="width:60px;" class="textbox number"></td>' +
                                  '<td><input id="ReworkLotStock' + i + '" value="" readonly style="width:60px;" class="textbox number"></td>' +

                                '<td><input id="PONO' + i + '" value=' + val.PONO + ' readonly class="textbox"></td>' +
                                '<td><input id="POYearcode' + i + '" value=' + val.POYearcode + ' readonly class="textbox"></td>' +
                                '<td><input id="PODate' + i + '" value=' + val.PODate + ' readonly class="textbox"></td>' +
                                '<td><input id="schno' + i + '" value=' + val.schno + ' readonly class="textbox"></td>' +
                                '<td><input id="schYearCode' + i + '" value=' + val.schYearCode + ' readonly class="textbox"></td>' +
                                '<td><input id="schdate' + i + '" value="" readonly class="textbox"></td>' +
                                '<td>' +
                                    (val.FilePath
                                        ? '<a href="' + val.FilePath + '" target="_blank">View</a>'
                                        : '-') +
                                '</td>'
                                    '</tr>';
                                   
                                i++;
                            });
                            $('#DivDetailGrid').append(html);
                            var rowCounter = $('#DivDetailGrid tr').length;
                             for (var i = 1; i <= rowCounter; i++) {
                        FillAccLotandTotalStock(i);
                        FillRejLotandTotalStock(i);
                        FillHoldLotandTotalStock(i);
                        FillReworkLotandTotalStock(i);
                             }
                            FillOkRecStore();
                            RejSTORE();
                            RewSTORE();
                            HoldSTORE();
                            BINDEMP();
                            
                           
                           
                        }
                    }
                }
            });
        }

        function FillAccLotandTotalStock(i) {

            $.ajax({
                url: "@Url.Action("FillLotandTotalStock")",
                type: "POST",
                data: { ItemCode: $('#itemCode' + i).val(), StoreId: $('#PrevOkRecStore' + i).val(), TillDate: $('#ReofferEntrydate').val(), BatchNo: $('#BatchNo' + i).val(), UniqBatchNo: $('#uniqueBatchno' + i).val() },
                async: false,
                success: function (data) {

                    if (data != null) {
                        var obj = $.parseJSON(data);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#AccLotStock' + i).val(obj.Result[0].lotstock);
                            $('#TotalStock' + i).val(obj.Result[0].totalstock);


                        }
                        else {
                            $('#AccLotStock' + i).val(0);
                            $('#TotalStock' + i).val(0);
                        }
                    }
                    console.log("success");
                },
                error: function (errMsg) {
                    console.log(errMsg);
                }
            });
        }

        function FillRejLotandTotalStock(i) {

            $.ajax({
                url: "@Url.Action("FillLotandTotalStock")",
                type: "POST",
                data: { ItemCode: $('#itemCode' + i).val(), StoreId: $('#PrevRejRecStore' + i).val(), TillDate: $('#ReofferEntrydate').val(), BatchNo: $('#BatchNo' + i).val(), UniqBatchNo: $('#uniqueBatchno' + i).val() },
                async: false,
                success: function (data) {

                    if (data != null) {
                        var obj = $.parseJSON(data);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#RejLotStock' + i).val(obj.Result[0].lotstock);
                            $('#TotalStock' + i).val(obj.Result[0].totalstock);


                        }
                        else {
                            $('#RejLotStock' + i).val(0);
                            $('#TotalStock' + i).val(0);
                        }
                    }
                    console.log("success");
                },
                error: function (errMsg) {
                    console.log(errMsg);
                }
            });
        }
        function FillHoldLotandTotalStock(i) {
            $.ajax({
                url: "@Url.Action("FillLotandTotalStock")",
                type: "POST",
                data: { ItemCode: $('#itemCode' + i).val(), StoreId: $('#PrevHoldStoreId' + i).val(), TillDate: $('#ReofferEntrydate').val(), BatchNo: $('#BatchNo' + i).val(), UniqBatchNo: $('#uniqueBatchno' + i).val() },
                async: false,
                success: function (data) {

                    if (data != null) {
                        var obj = $.parseJSON(data);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#HoldLotStock' + i).val(obj.Result[0].lotstock);
                            $('#TotalStock' + i).val(obj.Result[0].totalstock);


                        }
                        else {
                            $('#HoldLotStock' + i).val(0);
                            $('#TotalStock' + i).val(0);
                        }
                    }
                    console.log("success");
                },
                error: function (errMsg) {
                    console.log(errMsg);
                }
            });
        }
         function FillReworkLotandTotalStock(i) {
             $.ajax({
                url: "@Url.Action("FillLotandTotalStock")",
                type: "POST",
                data: { ItemCode: $('#itemCode' + i).val(), StoreId: $('#PrevRewokStoreId' + i).val(), TillDate: $('#ReofferEntrydate').val(), BatchNo: $('#BatchNo' + i).val(), UniqBatchNo: $('#uniqueBatchno' + i).val() },
                async: false,
                success: function (data) {
                     
                    if (data != null) {
                        var obj = $.parseJSON(data);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            $('#ReworkLotStock' + i).val(obj.Result[0].lotstock);
                            $('#TotalStock' + i).val(obj.Result[0].totalstock);

                          
                        }
                        else {
                            $('#ReworkLotStock' + i).val(0);
                            $('#TotalStock' + i).val(0);
                        }
                    }
                    console.log("success");
                },
                error: function (errMsg) {
                    console.log(errMsg);
                }
            });
        }
               


        function FillOkRecStore() {
             var itemcode=$('#PartCode').val();
             var ShowAllStore=$('#ShowAllStore').val();
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillOkRecStore")",
                dataType: "json",
               data: { itemcode: itemcode, ShowAllStore: ShowAllStore },
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                           

                            var RowCount = $('#DivDetailGrid tr').length;
                            for (var i = 1; i <= RowCount; i++) {
                                $('#OkRecStore' + i).empty();
                                $('#OkRecStore' + i).append('<option value="" disabled selected>-Select-</option>');

                                $.each(obj.Result, function (index, val) {
                                    $('#OkRecStore' + i).append('<option value="' + val.Store + '">' + val.Store_Name + '</option>');
                                });
                            }

                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var OkRecStore = "@Model.OkRecStore";
                                $('#OkRecStore').val(OkRecStore).trigger("change");
                            }
                        }
                    }
                }
            });
        }

       

        var SameOkRecStore = false;
        $('#SHA1').change(function () {

            var RowCount = $('#DivDetailGrid tr').length;
            for (var i = 1; i <= RowCount; i++) {
                $('#OkRecStore' + i).val('');
            }
            if ($('#SHA1').prop("checked") == true) {
                SameOkRecStore = true;
            } else {
                SameOkRecStore = false;
            }
        });
        function OkRecStoreChange(i) {

            var OkRecStore = $('#OkRecStore' + i).val();
            if (SameOkRecStore) {
                var RowCount = $('#DivDetailGrid tr').length;
                for (var j = 1; j <= RowCount; j++) {
                    $('#OkRecStore' + j).val(OkRecStore);
                  
                }
            }
            
        }
        var SameRejRecStore = false;
         $('#SHA2').change(function () {

            var RowCount = $('#DivDetailGrid tr').length;
            for (var i = 1; i <= RowCount; i++) {
                $('#RejRecStore' + i).val('');
            }
            if ($('#SHA2').prop("checked") == true) {
                SameRejRecStore = true;
            } else {
                SameRejRecStore = false;
            }
        });
        function RejRecStoreChange(i) {

            var RejRecStore = $('#RejRecStore' + i).val();
            if (SameRejRecStore) {
                var RowCount = $('#DivDetailGrid tr').length;
                for (var j = 1; j <= RowCount; j++) {
                    $('#RejRecStore' + j).val(RejRecStore);
                    
                }
            }
           
        }
        var SameHoldStoreId = false;
         $('#SHA3').change(function () {

            var RowCount = $('#DivDetailGrid tr').length;
            for (var i = 1; i <= RowCount; i++) {
                $('#HoldStoreId' + i).val('');
            }
            if ($('#SHA3').prop("checked") == true) {
                SameHoldStoreId = true;
            } else {
                SameHoldStoreId = false;
            }
        });
        function HoldStoreIdChange(i) {

            var HoldStoreId = $('#HoldStoreId' + i).val();
            if (SameHoldStoreId) {
                var RowCount = $('#DivDetailGrid tr').length;
                for (var j = 1; j <= RowCount; j++) {
                    $('#HoldStoreId' + j).val(HoldStoreId);
                    
                }
            }
           
        }
        var SameRewokStoreId = false;
         $('#SHA4').change(function () {

            var RowCount = $('#DivDetailGrid tr').length;
            for (var i = 1; i <= RowCount; i++) {
                $('#RewokStoreId' + i).val('');
            }
            if ($('#SHA4').prop("checked") == true) {
                SameRewokStoreId = true;
            } else {
                SameRewokStoreId = false;
            }
        });
        function RewokStoreIdChange(i) {

            var RewokStoreId = $('#RewokStoreId' + i).val();
            if (SameRewokStoreId) {
                var RowCount = $('#DivDetailGrid tr').length;
                for (var j = 1; j <= RowCount; j++) {
                    $('#RewokStoreId' + j).val(RewokStoreId);
                    
                }

            }
            

        }
        var SameApprovedByEmp = false;
         $('#SHA5').change(function () {

            var RowCount = $('#DivDetailGrid tr').length;
            for (var i = 1; i <= RowCount; i++) {
                $('#ApprovedByEmp' + i).val('');
            }
            if ($('#SHA5').prop("checked") == true) {
                SameApprovedByEmp = true;
            } else {
                SameApprovedByEmp = false;
            }
        });
        function ApprovedByEmpChange(i) {

            var ApprovedByEmp = $('#ApprovedByEmp' + i).val();
            if (SameApprovedByEmp) {
                var RowCount = $('#DivDetailGrid tr').length;
                for (var j = 1; j <= RowCount; j++) {
                    $('#ApprovedByEmp' + j).val(ApprovedByEmp);
                }
            }
        }
        function RejSTORE() {
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("RejSTORE")",
                dataType: "json",
               
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                           
                             var RowCount = $('#DivDetailGrid tr').length;
                            for (var i = 1; i <= RowCount; i++) {
                                $('#RejRecStore' + i).empty();
                                $('#RejRecStore' + i).append('<option value="" disabled selected>-Select-</option>');

                                $.each(obj.Result, function (index, val) {
                                    $('#RejRecStore' + i).append('<option value="' + val.entryid + '">' + val.store_name + '</option>');
                                });
                            }
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var RejRecStore = "@Model.RejRecStore";
                                $('#RejRecStore').val(RejRecStore).trigger("change");
                            }
                        }
                    }
                }
            });
        }
        function RewSTORE() {
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("RewSTORE")",
                dataType: "json",
               
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                           
                            var RowCount = $('#DivDetailGrid tr').length;
                            for (var i = 1; i <= RowCount; i++) {
                                $('#RewokStoreId' + i).empty();
                                $('#RewokStoreId' + i).append('<option value="" disabled selected>-Select-</option>');

                                $.each(obj.Result, function (index, val) {
                                    $('#RewokStoreId' + i).append('<option value="' + val.entryid + '">' + val.store_name + '</option>');
                                });
                            }
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var RewokStoreId = "@Model.RewokStoreId";
                                $('#RewokStoreId').val(RewokStoreId).trigger("change");
                            }
                        }
                    }
                }
            });
        }
        function HoldSTORE() {
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("HoldSTORE")",
                dataType: "json",
               
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                           
                            var RowCount = $('#DivDetailGrid tr').length;
                            for (var i = 1; i <= RowCount; i++) {
                                $('#HoldStoreId' + i).empty();
                                $('#HoldStoreId' + i).append('<option value="" disabled selected>-Select-</option>');

                                $.each(obj.Result, function (index, val) {
                                    $('#HoldStoreId' + i).append('<option value="' + val.entryid + '">' + val.store_name + '</option>');
                                });
                            }
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var HoldStoreId = "@Model.HoldStoreId";
                                $('#HoldStoreId').val(HoldStoreId).trigger("change");
                            }
                        }
                    }
                }
            });
        }

        function BINDEMP() {
            
            $.ajax({
                type: "POST",
                url: "@Url.Action("BINDEMP")",
                dataType: "json",
               
                async: false,
                
                success: function (result, status, error) {

                    if (result != null) {
                        var obj = $.parseJSON(result);
                        if (obj.StatusCode == 200 && obj.StatusText == 'Success') {
                            
                            var RowCount = $('#DivDetailGrid tr').length;
                            for (var i = 1; i <= RowCount; i++) {
                                $('#ApprovedByEmp' + i).empty();
                                $('#ApprovedByEmp' + i).append('<option value="0" disabled selected>-Select-</option>');

                                $.each(obj.Result, function (index, val) {
                                    $('#ApprovedByEmp' + i).append('<option value="' + val.Emp_Id + '">' + val.EmpNameCode + '</option>');
                                });
                            }
                            if ($('#Mode').val() == "U" || $('#Mode').val() == "V") {
                                var ApprovedByEmp = "@Model.ApprovedByEmp";
                                $('#ApprovedByEmp').val(ApprovedByEmp).trigger("change");
                            }
                        }
                    }
                }
            });
        }
        

        function FILLMIRData() {
             var MIRNO = $('#MIRNo').val();
             var MIRYearCode = $('#MIRYearCode').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FILLMIRData")",
                dataType: "json",
                data : { MIRNO: MIRNO, MIRYearCode: MIRYearCode },
                async: false,
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        console.log("result"+result);
                        
                        $('#MirEntryid').val("");
                        $('#MirEntryid').val(obj.Result[0].MIREntryId);
                        $('#AccountName').val("");
                        $('#AccountName').val(obj.Result[0].Account_Name);
                        $('#AccountCode').val("");
                        $('#AccountCode').val(obj.Result[0].Account_Code);
                        
                       
                         var MIRDate = new Date(obj.Result[0].MIRDate);
                         var formattedDate1 = ("0" + MIRDate.getDate()).slice(-2) + "/" + ("0" + (MIRDate.getMonth() + 1)).slice(-2) + "/" + MIRDate.getFullYear();

                        $('#MIRDate').val("");
                        $('#MIRDate').val(formattedDate1);
                        $('#MRNNO').val("");
                        $('#MRNNO').val(obj.Result[0].MRNNO);
                        $('#MrnYearCode').val("");
                        $('#MrnYearCode').val(obj.Result[0].MRNYearcode);
                       
                        var MRNDate = new Date(obj.Result[0].MRNDate);
                         var formattedDate2 = ("0" + MRNDate.getDate()).slice(-2) + "/" + ("0" + (MRNDate.getMonth() + 1)).slice(-2) + "/" + MRNDate.getFullYear();

                        $('#MRNDate').val("");
                            $('#MRNDate').val(formattedDate2);
                            $('#BillNo').val("");
                            $('#BillNo').val(obj.Result[0].INVNo);

                            var BillDate = new Date(obj.Result[0].Invdate);
                         var formattedDate3 = ("0" + BillDate.getDate()).slice(-2) + "/" + ("0" + (BillDate.getMonth() + 1)).slice(-2) + "/" + BillDate.getFullYear();


                           
                            $('#BillDate').val("");
                            $('#BillDate').val(formattedDate3);
                    }
                }
            });
        }

        function GetItemQty() {
             var MIRNO=$('#MIRNo').val();
             var MIRYearCode=$('#MIRYearCode').val();
            var accountcode = $('#AccountCode').val();
            var ReofferMir = $('#QcType').val();
            var itemcode = $('#PartCode').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetItemQty")",
                dataType: "json",
                data : { MIRNO: MIRNO, MIRYearCode: MIRYearCode, accountcode: accountcode, ReofferMir: ReofferMir,itemcode:itemcode },
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        console.log("result"+result);
                        
                        $('#BillQty').val("");
                        $('#BillQty').val(obj.Result[0].BillQty);
                        $('#AcceptedQty').val("");
                        $('#AcceptedQty').val(obj.Result[0].AcceptedQty);
                        $('#AltAcceptedQty').val("");
                        $('#AltAcceptedQty').val(obj.Result[0].AcceptedQty);
                        $('#HoldQty').val("");
                        $('#HoldQty').val(obj.Result[0].HoldQty);
                         $('#Reworkqty').val("");
                        $('#Reworkqty').val(obj.Result[0].Reworkqty);
                         $('#RecQty').val("");
                        $('#RecQty').val(obj.Result[0].RecQty);
                        $('#AltRecQty').val("");
                        $('#AltRecQty').val(obj.Result[0].RecQty);
                        $('#BatchNo').val("");
                        $('#BatchNo').val(obj.Result[0].BatchNo);
                         $('#uniqueBatchno').val("");
                        $('#uniqueBatchno').val(obj.Result[0].uniqueBatchno);
                         $('#Unit').val("");
                        $('#Unit').val(obj.Result[0].Unit);
                        $('#AltUnit').val("");
                        $('#AltUnit').val(obj.Result[0].Unit);
                        $('#RejectedQty').val("");
                        $('#RejectedQty').val(obj.Result[0].RejectedQty);
                        $('#AltRejectedQty').val("");
                        $('#AltRejectedQty').val(obj.Result[0].RejectedQty);
                        
                       
                         
                    }
                }
            });
        }

        function FillPODetail() {
             var MIRNO=$('#MIRNo').val();
             var MIRYearCode=$('#MIRYearCode').val();
            var accountcode = $('#AccountCode').val();
           
            var itemcode = $('#PartCode').val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("FillPODetail")",
                dataType: "json",
                data : { MIRNO: MIRNO, MIRYearCode: MIRYearCode, accountcode: accountcode,itemcode:itemcode },
                success: function (result, status, error) {
                    if (result != null) {
                        var obj = $.parseJSON(result);
                        console.log("result"+result);
                        
                        $('#PONo').val("");
                        $('#PONo').val(obj.Result[0].PONO);
                        $('#POYearCode').val("");
                        $('#POYearCode').val(obj.Result[0].POYearcode);
                       
                        var PODate = new Date(obj.Result[0].PODate);
                         var formattedDate1 = ("0" + PODate.getDate()).slice(-2) + "/" + ("0" + (PODate.getMonth() + 1)).slice(-2) + "/" + PODate.getFullYear();

                        $('#PODate').val("");
                            $('#PODate').val(formattedDate1);
                        
                        $('#SchNo').val("");
                        $('#SchNo').val(obj.Result[0].schno);
                         $('#SchYearCode').val("");
                        $('#SchYearCode').val(obj.Result[0].schYearCode);
                         

                         var schdate = new Date(obj.Result[0].schdate);
                         var formattedDate2 = ("0" + schdate.getDate()).slice(-2) + "/" + ("0" + (schdate.getMonth() + 1)).slice(-2) + "/" + schdate.getFullYear();

                        $('#schdate').val("");
                            $('#schdate').val(formattedDate2);
                        
                        
                       
                         
                    }
                }
            });
        }
         function ClearGridAjax() {
     
     $.ajax({
         type: "POST",
         url: "@Url.Action("ClearGridAjax")",
         
         dataType: "json",
         async: false,
         success: function (data, status, error) {
             console.log("Grid cleared");
             $('#divISTGrid').empty();
         },
         error: function (req, status, error) {
             alert(error);
         }
     });
 }

         function ValidateGrid() {
              var RowCount = $('#DivDetailGrid tr').length;
              if (RowCount == 0) {
                $.notify('Please Add Item in Grid', "error");
                return false;
              }
              var Err = 0;
             for (var i = 1; i <= RowCount; i++) {
                 var partcode = $('#PartCode'+i).val();
                 var PrevAcceptedQty=parseFloat($('#PrevAcceptedQty' + i).val()) || 0;
                 var AcceptedQty = parseFloat($('#AcceptedQty' + i).val()) || 0;
                 var AccLotStock = parseFloat($('#AccLotStock' + i).val()) || 0;
                 var PreviousRejectedQty=parseFloat($('#PreviousRejectedQty' + i).val()) || 0;
                 var RejectedQty = parseFloat($('#RejectedQty' + i).val()) || 0;
                 var RejLotStock = parseFloat($('#RejLotStock' + i).val()) || 0;
                 var PreviousHoldQty = parseFloat($('#PreviousHoldQty' + i).val()) || 0;
                 var HoldQty = parseFloat($('#HoldQty' + i).val()) || 0;
                 var HoldLotStock = parseFloat($('#HoldLotStock' + i).val()) || 0;
                 var PreviousReworkqty = parseFloat($('#PreviousReworkqty' + i).val()) || 0;

                 var Reworkqty = parseFloat($('#Reworkqty' + i).val()) || 0;
                 var ReworkLotStock = parseFloat($('#ReworkLotStock' + i).val()) || 0;
                 var RecQty=parseFloat($('#RecQty' + i).val()) || 0;

                 var totalQty=AcceptedQty+RejectedQty+ HoldQty + Reworkqty;

                 if (totalQty != RecQty) {
                     
                         $.notify('sum of all qty must be same as RecQty' + partcode, "error");
                         Err = 1;
                     }

                      if($('#OkRecStore' + i).val()==$('#PrevOkRecStore' + i).val() && PrevAcceptedQty==AcceptedQty)
                     {
                            $.notify('Please Delete the raw Which is not for reoffer for PartCode ' + partcode, "error");
                            Err = 1;
                        }
                         if($('#RejRecStore' + i).val()==$('#PrevRejRecStore' + i).val() && PreviousRejectedQty==RejectedQty)
                     {
                            $.notify('Please Delete the raw Which is not for reoffer for PartCode ' + partcode, "error");
                            Err = 1;
                        }
                         if($('#HoldStoreId' + i).val()==$('#PrevHoldStoreId' + i).val() && HoldQty==PreviousHoldQty)
                     {
                            $.notify('Please Delete the raw Which is not for reoffer for PartCode ' + partcode, "error");
                            Err = 1;
                        }
                         if($('#RewokStoreId' + i).val()==$('#PrevRewokStoreId' + i).val() && Reworkqty==PreviousReworkqty)
                     {
                            $.notify('Please Delete the raw Which is not for reoffer for PartCode ' + partcode, "error");
                            Err = 1;
                        }
                 

                 if (AccLotStock < PrevAcceptedQty) {
                     if (PrevAcceptedQty > AcceptedQty) {
                         $.notify('AcceptedQty Must Be less Then Lot Stock for PartCode' + partcode, "error");
                         Err = 1;
                     }
                 }
                 if (RejLotStock < PreviousRejectedQty) {
                     if (PreviousRejectedQty > RejectedQty) {
                         $.notify('RejectedQty Must Be less Then Lot Stock for PartCode' + partcode, "error");
                         Err = 1;
                     }
                 }
                 if (HoldLotStock < PreviousHoldQty) {
                        if (PreviousHoldQty > HoldQty) {
                     $.notify('HoldQty Must Be less Then Lot Stock for PartCode' + partcode, "error");
                     Err = 1;
                        }
                 }
                 if (ReworkLotStock < PreviousRejectedQty) {
                     if (PreviousReworkqty > Reworkqty) {

                         $.notify('Reworkqty Must Be less Then Lot Stock for PartCode' + partcode, "error");
                         Err = 1;
                     }
                 }
                 if ($('#AcceptedQty' + i).val() > 0) {
                     if ($('#OkRecStore' + i).val() == '' || $('#OkRecStore' + i).val() == null) {
                         $.notify('Please Select Ok Rec Store for PartCode ' + partcode, "error");
                         Err = 1;
                     }
                    

                 }
                 if ($('#RejectedQty' + i).val() > 0) {
                     if ($('#RejRecStore' + i).val() == '' || $('#RejRecStore' + i).val() == null) {
                         $.notify('Please Select Rej Rec Store for PartCode ' + partcode, "error");
                         Err = 1;
                     }


                 }
                 if ($('#HoldQty' + i).val() > 0) {
                     if ($('#HoldStoreId' + i).val() == '' || $('#HoldStoreId' + i).val() == null) {
                         $.notify('Please Select Hold Store for PartCode ' + partcode, "error");
                         Err = 1;
                     }

                 }
                 if ($('#Reworkqty' + i).val() > 0) {
                     if ($('#RewokStoreId' + i).val() == '' || $('#RewokStoreId' + i).val() == null) {
                         $.notify('Please Select Rework Store for PartCode ' + partcode, "error");
                         Err = 1;
                     }

                 }
                 if ($('#ApprovedByEmp' + i).val() == 0||$('#ApprovedByEmp' + i).val() == ""||$('#ApprovedByEmp' + i).val() == null) {
                      $.notify('Please Select ApprovedBy Name ' + partcode, "error");
                         Err = 1;
                 }
             }
             Err == 1 ? ShowErrorFld('H_Panel2') : HideErrorFld('H_Panel2');
            if (Err == 1) return false;

            return true;

         }


                $('.GridButton1').click(function (e) {
            e.preventDefault();
            EditEachItem = false;

            var ItemData = [];
            var seqnoarray = [];
            $('#DivDetailGrid tr').each(function (index, element) {

                var currentRow = $(element);
                var seqnoText = currentRow.find('th').data('seqno') == undefined ? 0 : currentRow.find('th').data('seqno');
                if (seqnoText != 0) {
                    seqnoarray.push(parseInt(seqnoText));
                }
            });

            var highestValue = 0;
            if (seqnoarray.length == 0) {
                highestValue = 0;
            }
            else {
                highestValue = Math.max(...seqnoarray);
            }

            if (!ValidateGrid()) return;
            var RowCount = $('#DivDetailGrid tr').length;

            if (RowCount == 0) {
                $.notify('Please Add Item in Grid', "error");
                return;
            }
            /* if (RowCount > 0) {
                for (var i = 1; i <= RowCount; i++) {
                    if ($('#Deassembleqty' + i).val() == '' || $('#Deassembleqty' + i).val() == '0') {
                        $.notify('Please Enter Deassemble Qty', "error");
                        return;
                    }
                }
            }
            if (RowCount > 0) {
                for (var i = 1; i <= RowCount; i++) {
                    if ($('#StoreName' + i).val() == '' || $('#StoreName' + i).val() == null) {
                        $.notify('Please Select Store', "error");
                        return;
                    }
                }
            } */

            for (var i = 1; i <= RowCount; i++) {
                ItemData.push({


  PartCode: $('#PartCode' + i).val(),
  ItemName: $('#ItemName' + i).val(),
  itemCode: $('#itemCode' + i).val(),
  PONO: $('#PONO' + i).val(),
  POYearcode: $('#POYearcode' + i).val(),
  PODate: $('#PODate' + i).val(),
  schno: $('#schno' + i).val(),
  schYearCode: $('#schYearCode' + i).val(),
  schdate: $('#schdate' + i).val(),
  Unit: $('#Unit' + i).val(),
  AltUnit: $('#AltUnit' + i).val(),
  BillQty: $('#BillQty' + i).val(),
  RecQty: $('#RecQty' + i).val(),
  AltRecQty: $('#AltRecQty' + i).val(),
  PrevAcceptedQty: $('#PrevAcceptedQty' + i).val(),
  AcceptedQty: $('#AcceptedQty' + i).val(),
  AltAcceptedQty: $('#AltAcceptedQty' + i).val(),
  PrevOkRecStore: $('#PrevOkRecStore' + i).val(),
 PrevOkRecStoreName: $('#PrevOkRecStore' + i).find(':selected').text() == "-Select-" ? "" : $('#PrevOkRecStore' + i).find(':selected').text(),

  OkRecStore: $('#OkRecStore' + i).val(),
 OkRecStoreName: $('#OkRecStore' + i).find(':selected').text() == "-Select-" ? "" : $('#OkRecStore' + i).find(':selected').text(),
 PrevDeviationQty: $('#PrevDeviationQty' + i).val(),
  DeviationQty: $('#DeviationQty' + i).val(),
  ResponsibleEmpForDeviation: $('#ResponsibleEmpForDeviation' + i).val(),
  PreviousRejectedQty: $('#PreviousRejectedQty' + i).val(),
  RejectedQty: $('#RejectedQty' + i).val(),
  AltRejectedQty: $('#AltRejectedQty' + i).val(),
  PrevRejRecStore: $('#PrevRejRecStore' + i).val(),
   PrevRejRecStoreName: $('#PrevRejRecStore' + i).find(':selected').text() == "-Select-" ? "" : $('#PrevRejRecStore' + i).find(':selected').text(),

  RejRecStore: $('#RejRecStore' + i).val(),
   RejRecStoreName: $('#RejRecStore' + i).find(':selected').text() == "-Select-" ? "" : $('#RejRecStore' + i).find(':selected').text(),

  Remarks: $('#Remarks' + i).val(),
  Defaulttype: $('#Defaulttype' + i).val(),
  ApprovedByEmp: $('#ApprovedByEmp' + i).val(),
     ApprovedByEmpName: $('#ApprovedByEmp' + i).find(':selected').text() == "-Select-" ? "" : $('#ApprovedByEmp' + i).find(':selected').text(),

  PreviousHoldQty: $('#PreviousHoldQty' + i).val(),
  HoldQty: $('#HoldQty' + i).val(),
   PrevHoldStoreId: $('#PrevHoldStoreId' + i).val(),
  PrevHoldStoreName: $('#PrevHoldStoreId' + i).find(':selected').text() == "-Select-" ? "" : $('#PrevHoldStoreId' + i).find(':selected').text(),
  HoldStoreId: $('#HoldStoreId' + i).val(),
  HoldStoreName: $('#HoldStoreId' + i).find(':selected').text() == "-Select-" ? "" : $('#HoldStoreId' + i).find(':selected').text(),
  ProcessId: $('#ProcessId' + i).val(),
  PreviousReworkqty: $('#PreviousReworkqty' + i).val(),
  Reworkqty: $('#Reworkqty' + i).val(),

  PrevRewokStoreId: $('#PrevRewokStoreId' + i).val(),
  PrevRewokStoreName: $('#PrevRewokStoreId' + i).find(':selected').text() == "-Select-" ? "" : $('#PrevRewokStoreId' + i).find(':selected').text(),
  RewokStoreId: $('#RewokStoreId' + i).val(),
  RewokStoreName: $('#RewokStoreId' + i).find(':selected').text() == "-Select-" ? "" : $('#RewokStoreId' + i).find(':selected').text(),
  Color: $('#Color' + i).val(),
  ItemSize: $('#ItemSize' + i).val(),
  ResponsibleFactor: $('#ResponsibleFactor' + i).val(),
  SupplierBatchno: $('#SupplierBatchno' + i).val(),
  shelfLife: $('#shelfLife' + i).val(),
  BatchNo: $('#BatchNo' + i).val(),
  uniqueBatchno: $('#uniqueBatchno' + i).val(),
  AllowDebitNote: $('#AllowDebitNote' + i).val(),
  Rate: $('#Rate' + i).val(),
   rateinother: $('#rateinother' + i).val(),
  AccLotStock: $('#AccLotStock' + i).val(),
  RejLotStock: $('#RejLotStock' + i).val(),
  HoldLotStock: $('#HoldLotStock' + i).val(),
  ReworkLotStock: $('#ReworkLotStock' + i).val(),
 
  FilePath:  ''
                });
            }
            console.log(ItemData);
            $.ajax({
                type: "POST",
                url: '@Url.Action("AddReOfferDetail1")',
                data: { "model": ItemData },
                // statusCode: {
                //     207: function () {
                //         $.notify('Duplicate Item...!', "info");
                //     }
                // },
                statusCode: {
                    207: function (xhr) {
                        try {
                            var response = JSON.parse(xhr.responseText);
                            var msg = `Duplicate Item Found: itemCode ${response.itemCode}, `;
                            $.notify(msg, "info");
                        } catch (e) {
                            $.notify("Duplicate Item...!", "info");
                        }
                    }
                },
                success: function (result, status, xhr) {
                    if (xhr.status == 200 && xhr.responseText == result) {

                        $('#divISTGrid').html(result);
                        $('#DivDetailGrid').empty();
                        /* TotalNetAmount(); */
                        //$('#Storeid,#Wcid').prop("disabled", false);
                    }
                },
                error: function (result, status, xhr) {
                    $.notify('Something Went Wrong, Please Try Again.', "error");
                }
            });
        });



        $('.GridButton').click(function (e) {

    e.preventDefault();
    EditEachItem = false;

    var rowCount = $('#divISTGrid  tr').length; // assuming you append one more row
    var Seqno = rowCount;
    
    /* if (!ValidateGrid()) return; */
   
    var SchData = {
       
            "Itemcode": $('#PartCode').val(),
    "PartCode":$('#PartCode :selected').text(),
    "ItemName": $('#ItemName :selected').text(),
    "PONo": $('#PONo').val(),
    "POYearCode": $('#POYearCode').val(),
    "PODate": $('#PODate').val(),
    "SchNo": $('#SchNo').val(),
    "SchYearCode": $('#SchYearCode').val(),
    "schdate": $('#schdate').val(),
    "Unit": $('#Unit').val(),
    "AltUnit": $('#AltUnit').val(),
    "BillQty": parseFloat($('#BillQty').val()),
    "RecQty": parseFloat($('#RecQty').val()),
    "AltRecQty": parseFloat($('#AltRecQty').val()),
    "PrevAcceptedQty": parseFloat($('#PrevAcceptedQty').val()),
    "AcceptedQty": parseFloat($('#AcceptedQty').val()),
    "AltAcceptedQty": parseFloat($('#AltAcceptedQty').val()),
    "OkRecStore": $('#OkRecStore').val(),
    "OkRecStoreName": $('#OkRecStore :selected').text(),
    "DeviationQty": parseFloat($('#DeviationQty').val()),
    "ResponsibleEmpForDeviation": $('#ResponsibleEmpForDeviation :selected').text(),
    "PreviousRejectedQty": parseFloat($('#PreviousRejectedQty').val()),
    "RejectedQty": parseFloat($('#RejectedQty').val()),
    "AltRejectedQty": parseFloat($('#AltRejectedQty').val()),
    "RejRecStore": $('#RejRecStore').val(),
    "RejRecStoreName": $('#RejRecStore :selected').text(),
    "Remarks": $('#Remarks').val(),
    "Defaulttype": $('#Defaulttype :selected').text(),
    "ApprovedByEmp": $('#ApprovedByEmp').val(),
    "ApprovedByEmpName": $('#ApprovedByEmp :selected').text(),
    "PreviousHoldQty": parseFloat($('#PreviousHoldQty').val()),
    "HoldQty": parseFloat($('#HoldQty').val()),
    "HoldStoreId": $('#HoldStoreId').val(),
    "HoldStoreName":  $('#HoldStoreId :selected').text(),
    "ProcessId": $('#ProcessId').val(),
    "PreviousReworkqty": parseFloat($('#PreviousReworkqty').val()),
    "Reworkqty": parseFloat($('#Reworkqty').val()),
    "RewokStoreId": $('#RewokStoreId').val(),
    "RewokStoreName":  $('#RewokStoreId :selected').text(),
    "Color": $('#Color :selected').text(),
    "ItemSize": $('#ItemSize :selected').text(),
    "ResponsibleFactor": $('#ResponsibleFactor :selected').text(),
    "SupplierBatchno": $('#SupplierBatchno :selected').text(),
    "shelfLife": $('#shelfLife').val(),
    "BatchNo": $('#BatchNo :selected').text(),
    "uniqueBatchno": $('#uniqueBatchno :selected').text(),
    "AllowDebitNote": $('#AllowDebitNote').is(':checked'),
    "Rate": parseFloat($('#Rate').val()),
    "rateinother": parseFloat($('#rateinother').val()),
    "FilePath": $('#FilePath').val(),

        "SeqNo": Seqno
    }
    $.ajax({
        type: "POST",
        url: '@Url.Action("AddReOfferDetail")',
        data: SchData,
        statusCode: {
            207: function () {
                $.notify('Duplicate Item...!', "info");
            }
        },
        success: function (result, status, xhr) {
            if (xhr.status == 200 && xhr.responseText == result) {
                $('#divISTGrid').html(result);
                
            }
        },
        error: function (result, status, xhr) {
            $.notify('Something Went Wrong, Please Try Again.', "error");
        }
    });
});

function DeleteItemRow(SeqNo) {
           
            var allowDeletion = true;
           
            if (allowDeletion) {
                $.ajax({
                    url: '@Url.Action("DeleteItemRow")',
                    type: "POST",
                    async: false,
                    data: { "SeqNo": SeqNo, "Mode": $('#Mode').val() },
                    success: function (data, status, xhr) {
                        $('#divISTGrid').html(data);
                        
                    },
                    error: function (response, status, xhr) {
                        alert(response.responseText);
                        $.notify(response.responseText, "error");
                    },
                    failure: function (response, status, xhr) {
                        alert(response.responseText);
                        $.notify(response.responseText, "error");
                    }
                });
            }

           
        }
         var EditEachItem = false;
         function EditItemRows(SeqNo) {
            var RowCount = $('#divISTGrid tr').length;
            if (EditEachItem) {
                $.notify('Cannot Edit item while AddtoGrid  Existing Item!!!', "error");
                $('#editButton-' + RowCount).prop("disabled", true);
            }
            else {
                $.ajax({
                    url: '@Url.Action("EditItemRows")',
                    type: "POST",
                    data: { SeqNo: SeqNo },
                    async: false,
                    success: function (data) {
                        var obj = $.parseJSON(data);
                        if (obj != null) {
                            EditEachItem = true;
                           
                           $('#PartCode').val(obj[0].itemcode).trigger("change");
                            $('#ItemName').val(obj[0].itemcode).trigger("change");
                            $('#PONo').val(obj[0].PONo);
                            $('#POYearCode').val(obj[0].POYearCode);
                            $('#PODate').val(obj[0].PODate);
                            $('#SchNo').val(obj[0].SchNo);
                            $('#SchYearCode').val(obj[0].SchYearCode);
                            $('#schdate').val(obj[0].schdate);
                            $('#Unit').val(obj[0].Unit);
                            $('#AltUnit').val(obj[0].AltUnit);
                            $('#BillQty').val(obj[0].BillQty);
                            $('#RecQty').val(obj[0].RecQty);
                            $('#AltRecQty').val(obj[0].AltRecQty);
                            $('#PrevAcceptedQty').val(obj[0].PrevAcceptedQty);
                            $('#AcceptedQty').val(obj[0].AcceptedQty);
                            $('#AltAcceptedQty').val(obj[0].AltAcceptedQty);
                            $('#OkRecStore').val(obj[0].OkRecStore).trigger("change");
                            $('#DeviationQty').val(obj[0].DeviationQty);
                            $('#ResponsibleEmpForDeviation').val(obj[0].ResponsibleEmpForDeviation);
                            $('#PreviousRejectedQty').val(obj[0].PreviousRejectedQty);
                            $('#RejectedQty').val(obj[0].RejectedQty);
                            $('#AltRejectedQty').val(obj[0].AltRejectedQty);
                            $('#RejRecStore').val(obj[0].RejRecStore).trigger("change");
                            $('#Remarks').val(obj[0].Remarks);
                            $('#Defaulttype').val(obj[0].Defaulttype);
                            $('#ApprovedByEmp').val(obj[0].ApprovedByEmp).trigger("change");
                            $('#PreviousHoldQty').val(obj[0].PreviousHoldQty);
                            $('#HoldQty').val(obj[0].HoldQty);
                            $('#HoldStoreId').val(obj[0].HoldStoreId).trigger("change");
                            $('#ProcessId').val(obj[0].ProcessId);
                            $('#PreviousReworkqty').val(obj[0].PreviousReworkqty);
                            $('#Reworkqty').val(obj[0].Reworkqty);
                            $('#RewokStoreId').val(obj[0].RewokStoreId).trigger("change");
                            $('#Color').val(obj[0].Color);
                            $('#ItemSize').val(obj[0].ItemSize);
                            $('#ResponsibleFactor').val(obj[0].ResponsibleFactor);
                            $('#SupplierBatchno').val(obj[0].SupplierBatchno);
                            $('#shelfLife').val(obj[0].shelfLife);
                            $('#BatchNo').val(obj[0].BatchNo);
                            $('#uniqueBatchno').val(obj[0].uniqueBatchno);
                            $('#AllowDebitNote').val(obj[0].AllowDebitNote);
                            $('#Rate').val(obj[0].Rate);
                            $('#rateinother').val(obj[0].rateinother);
                            $('#FilePath').val(obj[0].FilePath);

                           
                            var rowCount = $('#divISTGrid tr').length;
                            for (var i = 1; i <= rowCount + 1; i++) {
                                $('#editItemGrid-' + i).css("pointer-events", "none");
                                $('#editItemGrid-' + i).css("cursor", "not-allowed");
                            }

                           /*  GetPrevQty(); */
                            DeleteItemRow(SeqNo);
                            
                        }
                    },
                    error: function (response) {
                        $.notify(response.responseText, "error");
                    },
                    failure: function (response) {
                        $.notify(response.responseText, "error");
                    }
                });
            }
        }

       

        

        $('#submitBTN').click(function (event) {
            event.preventDefault();

           

                $("form").submit();
            

        });
                




        function PressBack() {

            sessionStorage.setItem('FromDateBack', $('#FromDateBack').val());
            sessionStorage.setItem('ToDateBack', $('#ToDateBack').val());
            sessionStorage.setItem('PartCodeBack', $('#PartCodeBack').val());
            sessionStorage.setItem('ItemNameBack', $('#ItemNameBack').val());
            sessionStorage.setItem('SlipNoBack', $('#SlipNoBack').val());
            sessionStorage.setItem('BatchNoBack', $('#BatchNoBack').val());
            sessionStorage.setItem('GlobalSearchBack', $('#GlobalSearchBack').val());
            sessionStorage.setItem('DashboardTypeBack', $('#DashboardTypeBack').val());

            window.history.back();
        }

    </script>
}
