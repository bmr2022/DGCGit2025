@model eTactWeb.DOM.Models.HRAdvanceModel

@{
	ViewData["Title"] = "Employee Advance Payment";
	Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
@*<div class="d-flex align-items-center p-3 my-2 text-white rounded shadow-sm bg-gradient" style="background-color:darkcyan;">
    <div class="lh-1">
    <h3 class="h3 mb-0 text-white lh-1">Account Master</h3>
    </div>
    </div>*@
<form asp-action="EmployeeAdvancePayment" enctype="multipart/form-data" asp-controller="EmployeeAdvancePayment" method="post" autocomplete="off" class="form-horizontal">
	<div class="card rounded shadow-lg">
		<div class="card-header card-headerBG text-light justify-content-center bg-gradient">
			<h4>
				Employee Advance Payment
				<span class="d-flex float-end" style="margin-top:-2px;">
					<a asp-action="VUDashBoard" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">
						<i class="fa-solid fa-grip fa-fw fa-lg fa-beat" aria-hidden="true"></i>
						Dashboard
					</a>
					<div class="row justify-content-between g-2">
						<div class="col-auto">
							@*<a href="#" class="btn offer-listbtn hvr-sweep-to-right btn-sm btn-secondary" onclick="back();">*@
							<a href="#" class=" btn btn-primary btn-sm" onclick="back();">
								<i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>

								BACK
							</a>
						</div>
						@if (Model.Mode != "V")
						{
							<div class="col-auto">
								@*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
								<a class="btn btn-secondary btn-sm" onclick="location.href=$('form')[0].action">
									@* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
									<i class="fa fa-refresh fa-fw fa-lg" aria-hidden="true"></i>
									REFRESH
								</a>
							</div>
							@if (Model.Mode == "U")
							{
								@*Model.Mode = "U";*@
								<div class="col-auto">
									@* <button type="submit" class="btn btn-sm btn-outline-warning">*@
									<input type="hidden" id="Mode" name="Mode" asp-for="Mode" value="U" />
									<button type="submit" class="btn btn-sm btn-outline-light bg-gradient submitBTN" id="updateBtnHeader">
										<i class="fa fa-pencil-square fa-fw fa-lg" aria-hidden="true"></i>
										UPDATE
									</button>
								</div>
							}
							else
							{
								<div class="col-auto">
									@*   <button type="submit" class="btn btn-sm btn-outline-primary">*@
									<button type="submit" class="btn btn-primary btn-sm submitBTN" id="submitBTN">
										<i class="fa-solid fa-chevron-circle-right fa-fw fa-lg"></i>
										SUBMIT
									</button>
								</div>
							}
						}
					</div>
				</span>
			</h4>
		</div>
		<div class="card-body bg-light">
			<div class="accordion shadow-lg" id="accordionAccountMaster">
				<div class="accordion-item">
					@if (TempData["422"] != null)
					{
						<div class="alert alert-danger" role="alert">
							@TempData["422"]
						</div>
					}

					<h2 class="accordion-header" id="B_ItemCategoryDetail">
						<button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_AccountDetail" aria-expanded="true" aria-controls="B_AccountDetail">
							<strong><i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Employee Advance Payment</strong>

						</button>
					</h2>
					<div id="B_AccountDetail" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H_AccountDetail">
						<div class="accordion-body">
							<input type="hidden" asp-for="FinFromDate" value="@Model.FinFromDate" />
							<input type="hidden" asp-for="FinToDate" value="@Model.FinToDate" />
							<input asp-for="Mode" type="hidden" class="form-control" value="@Model.Mode" />
							<div class="row">

								<div class="col-md-2">
									<label asp-for="AdvanceEntryId" class="form-label">Advance EntryId</label>
									<input asp-for="AdvanceEntryId" class="form-control" readonly />
								</div>

								<div class="col-md-2">
									<label asp-for="AdvanceYearCode" class="form-label">Advance YearCode</label>
									<input asp-for="AdvanceYearCode" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="AdvanceSlipNo" class="form-label">Advance SlipNo</label>
									<input asp-for="AdvanceSlipNo" class="form-control" />
								</div>

								<div class="col-md-1">fi
									<label asp-for="EmpId" class="form-label">Emp Name</label>
									<select asp-for="EmpId" class="form-select">
										<option value="">-Select-</option>
									</select>
								</div>

								<div class="col-md-1">
									<label asp-for="DesigId" class="form-label">Designation</label>
									<select asp-for="DesigId" class="form-select">
										<option value="">-Select-</option>
									</select>
								</div>

								<div class="col-md-1">
									<label asp-for="DepId" class="form-label">Department</label>
									<select asp-for="DepId" class="form-select">
										<option value="">-Select-</option>
									</select>
								</div>

								<div class="col-md-1">
									<label asp-for="DOJ" class="form-label">DOJ</label>
									<input asp-for="DOJ"  class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="BasicSalary" class="form-label">Basic Salary</label>
									<input asp-for="BasicSalary" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="NetSalary" class="form-label">Net Salary</label>
									<input asp-for="NetSalary" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="PresentDaysinCurrMonth" class="form-label">PresentDaysinCurrMonth</label>
									<input asp-for="PresentDaysinCurrMonth" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="PresentDaysInCurrYear" class="form-label">PresentDays InCurrYear</label>
									<input asp-for="PresentDaysInCurrYear" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="CategoryId" class="form-label">Category</label>
									<input asp-for="CategoryId" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="RequestDate" class="form-label">Request Date</label>
									<input asp-for="RequestDate" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="EntryDate" class="form-label">Entry Date</label>
									<input asp-for="EntryDate" class="form-control" />
								</div>

								<div class="col-md-3">
									<label asp-for="Purpose" class="form-label"></label>
									<textarea asp-for="Purpose" type="textarea" class="form-control">Purpose</textarea>
								</div>


								<div class="col-md-2">
									<label asp-for="PreviousPendAdvanceAmt" class="form-label">Previous PendAdvanceAmt</label>
									<input asp-for="PreviousPendAdvanceAmt" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="PreviousPendLoanAmt" class="form-label">Previous PendLoanAmt</label>
									<input asp-for="PreviousPendLoanAmt" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="MgrApprovaldate" class="form-label">Mgr Approvaldate</label>
									<input asp-for="MgrApprovaldate" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="MgrApprovedbyEmpid" class="form-label">Mgr ApprovedbyEmp</label>
									<select asp-for="MgrApprovedbyEmpid" class="form-select">
										<option value="">-Select-</option>
									</select>
								</div>

								<div class="col-md-2">
									<label asp-for="HRApprovedbyEmpid" class="form-label">HR ApprovedbyEmp</label>
									<select asp-for="HRApprovedbyEmpid" class="form-select">
										<option value="">-Select-</option>
									</select>
								</div>

								<div class="col-md-2">
									<label asp-for="HRApprovalDate" class="form-label">HR ApprovalDate</label>
									<input asp-for="HRApprovalDate"  class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="PaymentVoucherNo" class="form-label">Payment VoucherNo</label>
									<input asp-for="PaymentVoucherNo" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="PaymentVoucherType" class="form-label">Payment VoucherType</label>
									<input asp-for="PaymentVoucherType" class="form-control" />
								</div>

							</div>

						</div>
					</div>

					<h2 class="accordion-header" id="B_ItemCategoryDetail">
						<button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_AccountDetail" aria-expanded="true" aria-controls="B_AccountDetail">
							<strong><i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Fincial Details</strong>
						</button>
					</h2>
					<div id="B_AccountDetail" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H_AccountDetail">
						<div class="accordion-body">
							<input type="hidden" asp-for="FinFromDate" value="@Model.FinFromDate" />
							<input type="hidden" asp-for="FinToDate" value="@Model.FinToDate" />
							<input asp-for="Mode" type="hidden" class="form-control" value="@Model.Mode" />
							<div class="row">
								<div class="col-md-2">
									<label asp-for="RequestedAmount" class="form-label">Requested Amount</label>
									<input asp-for="RequestedAmount" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="ApprovedAmount" class="form-label">Approved Amount</label>
									<input asp-for="ApprovedAmount" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="FinanceApprovalEmpid" class="form-label">FinanceApproval Empid</label>
									<input asp-for="FinanceApprovalEmpid" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="FinanceApprovalDate" class="form-label">Finance ApprovalDate</label>
									<input asp-for="FinanceApprovalDate" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="ModeOfPayment" class="form-label">Mode Of Payment</label>
									<select asp-for="ModeOfPayment" class="form-select">
										<option value="">-- Select Payment Mode --</option>
										<option value="Cash">Cash</option>
										<option value="BankTransfer">Bank Transfer</option>
										<option value="Cheque">Cheque</option>
									</select>
								</div>

								<div class="col-md-2">
									<label asp-for="PaymentReferenceNo" class="form-label">Payment ReferenceNo</label>
									<input asp-for="PaymentReferenceNo" class="form-control" />
								</div>

								<div class="col-md-4">
									<label asp-for="PaymentRemark" class="form-label">Payment Remark</label>
									<textarea asp-for="PaymentRemark" class="form-control"></textarea>
								</div>
							</div>
						</div>
					</div>


					<h2 class="accordion-header" id="B_ItemCategoryDetail">
						<button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_AccountDetail" aria-expanded="true" aria-controls="B_AccountDetail">
							<strong><i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Recovery Details</strong>
						</button>
					</h2>
					<div id="B_AccountDetail" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H_AccountDetail">
						<div class="accordion-body">
							<input type="hidden" asp-for="FinFromDate" value="@Model.FinFromDate" />
							<input type="hidden" asp-for="FinToDate" value="@Model.FinToDate" />
							<input asp-for="Mode" type="hidden" class="form-control" value="@Model.Mode" />
							<div class="row">
								
								<div class="col-md-2">
									<label asp-for="RecoveryMethod" class="form-label">Recovery Method</label>
									<input asp-for="RecoveryMethod" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="NoofInstallment" class="form-label">No of Installment</label>
									<input asp-for="NoofInstallment" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="StartRecoveryFromMonth" class="form-label">StartRecovery FromMonth</label>
									<input asp-for="StartRecoveryFromMonth" class="form-control" />  @* Month picker *@
								</div>
								<div class="col-md-2">
									<label asp-for="FinalRevoveryDate" class="form-label">Final RevoveryDate</label>
									<input asp-for="FinalRevoveryDate" class="form-control" />
								</div>
								<div class="col-md-2">
									<label asp-for="AutoDeductionFromSalaryYN" class="form-label">AutoDeduction FromSalary</label>
									<select asp-for="AutoDeductionFromSalaryYN" class="form-select">
										<option value="Y">Yes</option>
										<option value="N">No</option>
									</select>
								</div>
								<div class="col-md-2">
									<label asp-for="ActualFinalRecoveryDate" class="form-label">ActualFinal RecoveryDate</label>
									<input asp-for="ActualFinalRecoveryDate" class="form-control" />
								</div>

							</div>
						</div>
					</div>

					<h2 class="accordion-header" id="B_ItemCategoryDetail">
						<button class="accordion-button text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#B_AccountDetail" aria-expanded="true" aria-controls="B_AccountDetail">
							<strong><i class="fa fa-fw pr35 fa-book fa-lg" aria-hidden="true"></i>Workflow & Audit</strong>
						</button>
					</h2>
					<div id="B_AccountDetail" class="accordion-collapse collapse pnl1 bg-gradient show" aria-labelledby="H_AccountDetail">
						<div class="accordion-body">
							<input type="hidden" asp-for="FinFromDate" value="@Model.FinFromDate" />
							<input type="hidden" asp-for="FinToDate" value="@Model.FinToDate" />
							<input asp-for="Mode" type="hidden" class="form-control" value="@Model.Mode" />
							<div class="row">
								<div class="col-md-2">
									<label asp-for="StatusHoldCancelApproved" class="form-label">StatusHold CancelApproved</label>
									<input asp-for="StatusHoldCancelApproved" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="ActualEntryBy" class="form-label">ActualEntry By</label>
									<input asp-for="ActualEntryBy" type="hidden" class="form-control" />
									<input asp-for="ActualEntryByName" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="LastUpdatedBy" class="form-label">LastUpdated By</label>
									<input type="hidden" asp-for="LastUpdatedBy" class="form-control" />
									<input asp-for="LastUpdatedByEmpName" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="LastUpdationDate" class="form-label">LastUpdation Date</label>
									<input asp-for="LastUpdationDate" class="form-control" />
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="accordion-item">
					@* <h2 class="accordion-header" id="HPanel2">
						<button class="accordion-button collapsed text-light pnl1BG bg-gradient" type="button" data-bs-toggle="collapse" data-bs-target="#ODGrid" aria-expanded="false" aria-controls="ODGrid">
							<strong style="text-transform:uppercase"><i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;"></i>Other Detail</strong>
						</button>
					</h2> *@

					<h2 class="accordion-header" id="H_SAGrid">
						<button class="accordion-button collapsed text-light pnl4BG bg-gradient prodPlanGridBtn" type="button" data-bs-toggle="collapse" data-bs-target="#B_SAGrid" aria-expanded="true" aria-controls="B_SAGrid">
							<strong style="text-transform:uppercase">
								<i class="fa-solid fa-table-list fa-lg fa-fw pr35 fa-fade" style="--fa-animation-duration: 2s; --fa-fade-opacity: 0.6;">

								</i>Other Detail
							</strong>
						</button>
					</h2>
					<div id="B_SAGrid" class="accordion-collapse collapse pnl4 bg-gradient prodPlandiv" aria-labelledby="H_SAGrid">
						<div class="accordion-body">
							<div class="row g-2 gx-3" id="_ItemGrid">

								<div class="col-md-2">
									<label asp-for="RequestEntryByMachine" class="form-label">Request EntryByMachine</label>
									<input asp-for="RequestEntryByMachine" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="ApprovedBYMachine" class="form-label">ApprovedBY Machine</label>
									<input asp-for="ApprovedBYMachine" class="form-control" />
								</div>

								<div class="col-md-2">
									<label asp-for="CancelByMachine" class="form-label">CancelBy Machine</label>
									<input asp-for="CancelByMachine" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="CC" class="form-label">Branch</label>
									<input asp-for="CC" class="form-control" />
								</div>

								<div class="col-md-1">
									<label asp-for="UID" class="form-label">UID</label>
									<input asp-for="UID" class="form-control" />
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
		<div class="card-footer p-3">
			<div class="row justify-content-between g-2">

				<div class="card border-light bg-gradient rounded shadow-lg">
					<div class="card-header card-headerBG text-light justify-content-center bg-gradient">
						<h4>
							@ViewData["Title"]
							<span class="d-flex float-end" style="margin-top:-2px;">
								<a asp-action="Dashboard" asp-route-ID="0" class="btn btn-sm btn-outline-light bg-gradient">
									<i class="fa-solid fa-grip fa-fw fa-lg fa-beat" aria-hidden="true"></i>
									Dashboard
								</a>
								<div class="row justify-content-between g-2">
									<div class="col-auto">
										@*<a href="#" class="btn offer-listbtn hvr-sweep-to-right btn-sm btn-secondary" onclick="back();">*@
										<a href="#" class=" btn btn-primary btn-sm" onclick="back();">
											<i class="fa fa-chevron-circle-left fa-fw fa-lg" aria-hidden="true"></i>

											BACK
										</a>
									</div>
									@if (Model.Mode != "V" && Model.Mode != "SOC" && Model.Mode != "POC")
									{
										<div class="col-auto">
											@*  <a class="btn btn-sm btn-outline-danger" onclick="location.href=$('form')[0].action">*@
											<a class="btn btn-secondary btn-sm" onclick="location.href=$('form')[0].action">
												@* <i class="fa-solid fa-grip fa-lg fa-fw fa-beat" style="--fa-animation-duration: 2s;"></i>*@
												<i class="fa fa-refresh fa-fw fa-lg" aria-hidden="true"></i>
												REFRESH
											</a>
										</div>
										@if (Model.Mode == "U")
										{
											@*Model.Mode = "U";*@
											<div class="col-auto">
												@* <button type="submit" class="btn btn-sm btn-outline-warning">*@
												<button type="submit" class="btn btn-sm btn-outline-light bg-gradient submitBTN" id="updateBtnFooter">
													<i class="fa fa-pencil-square fa-fw fa-lg" aria-hidden="true"></i>
													UPDATE
												</button>
											</div>
										}

										else
										{
											<div class="col-auto">
												@*   <button type="submit" class="btn btn-sm btn-outline-primary">*@
												<button type="submit" class="btn btn-primary btn-sm submitBTN" id="submitBTN">
													<i class="fa-solid fa-chevron-circle-right fa-fw fa-lg"></i>
													SUBMIT
												</button>
											</div>
										}
									}
								</div>
							</span>
						</h4>
					</div>
				</div>
			</div>
		</div>
	</div>
</form>


@section Scripts {
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/notify/0.4.2/notify.min.js"></script>

	<!-- Select2 CSS & JS -->
	<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

	<script>
		$(document).ready(function () {


			if($('#Mode').val() != "U" && $('#Mode').val() != "V"){
				FillEntryID();
			}

			// $('#LastUpdatedBy').rules("remove", "required");
		});

		function FillEntryID() {
			$.ajax({
				url: '@Url.Action("FillEntryId")',
				type: 'POST',
				success: function (data, status, xhr) {
					var obj = $.parseJSON(data);
					if (obj.StatusCode == 200 && obj.StatusText === 'Success') {
						$('#AdvanceEntryId').val(obj.Result[0].EntryId);
						$('#AdvanceSlipNo').val(obj.Result[0].AdvanceSlipNo);
					}
				},
				error: function (xhr, status, error) {
					console.log('Failed to load Entry Id.');
				}
			});
		}

	</script>
	@* 	<script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script> *@

}